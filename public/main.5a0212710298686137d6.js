(self.webpackChunkbuup=self.webpackChunkbuup||[]).push([[179],{111:(e,n,t)=>{"use strict";t.d(n,{a:()=>Ki});var i={};t.r(i),t.d(i,{x0:()=>jt,_O:()=>Rt,S1:()=>Et,Z2:()=>Ot,Qc:()=>Wt,Jz:()=>It,V8:()=>qt,KT:()=>Nt,W1:()=>Ct,IW:()=>Vt,D9:()=>Ht});var o={};t.r(o),t.d(o,{vw:()=>si,x0:()=>di,_h:()=>ri,Or:()=>ti,UI:()=>ei,Fx:()=>li,uY:()=>ci,S1:()=>Gt,Es:()=>$t,Wb:()=>ai,ae:()=>ni,yQ:()=>Kt,rr:()=>Ut});var r={};t.r(r),t.d(r,{mS:()=>Pi,n6:()=>Ri,UX:()=>Bi,bK:()=>Wi,GI:()=>Vi,pk:()=>Li,S1:()=>qi,u7:()=>Ii,b5:()=>Yi,hM:()=>_i,gw:()=>Di,SI:()=>Hi,ob:()=>Ui,j3:()=>Ni});var a=t(642);function l(e){"string"!=typeof e&&(e=e.toString(16)),e.startsWith("#")?e=e.substring(1):e.startsWith("0x")&&(e=e.substring(2));let n=0,t=0,i=0;return 3==e.length?(n="0x"+e[0]+e[0],t="0x"+e[1]+e[1],i="0x"+e[2]+e[2]):6==e.length&&(n="0x"+e[0]+e[1],t="0x"+e[2]+e[3],i="0x"+e[4]+e[5]),[parseInt(n),parseInt(t),parseInt(i)]}function s(e){var n=e.toString(16);return 1==n.length?"0"+n:n}function c(e,n,t){return function(e,n,t){return"#"+s(e)+s(n)+s(t)}(e=Math.floor(256*e),n=Math.floor(256*n),t=Math.floor(256*t))}function d(e){return.299*e[0]+.587*e[1]+.114*e[2]>186}var p,u,h,g,m=t(429),f=0,v={},x={};function w(e,n){f++,Ii(e,((e,t)=>{f--,n(e,t)}))}function y(e,n){n||(n="gltf"),w("assets/models/"+e+"."+n,(n=>{n.scale.set(2,2,2),n.castShadow=!0,n.receiveShadow=!0,function(e,n){let t=e.replace(/[0-9]/g,"");if(t!=e)if(x[t]){if(!Array.isArray(x[t])){let e=x[t];x[t]=[e]}x[t].push(n)}else x[t]=n;x[e]=n}(e,n)}))}function b(e,n,t){if(e.geometry)k(e,e.geometry,n,t);else if(e.children&&e.children.length>0)for(let i=0;i<e.children.length;i++)e.children[i].geometry&&k(e,e.children[i].geometry,n,t)}function k(e,n,t,i){if(!n)return;let o,r=t&&i,a=n.attributes.color.array,l=[];for(let e=0;e<a.length;e++)if(o=e%4,o>=3)if(r)a[e-3]==t[0]&&a[e-2]==t[1]&&a[e-1]==t[2]&&(a[e-3]=i[0],a[e-2]=i[1],a[e-1]=i[2]);else{let n=c(a[e-3],a[e-2],a[e-1]);l[n]=a[e-3]+","+a[e-2]+","+a[e-1]}r||Object.keys(l).forEach((t=>{console.log("%s %s %c %s %c %s",e.name,n.name,"background: "+t+"; color: #000",t,"background: white;",l[t])}))}function _(e,n){let t=x[e];if(t){if(Array.isArray(t))t=t[Math.floor(Math.random()*t.length)];else if(("man"==e||"gran"==e)&&n){t=m.b.clone(t);let e=l(n).map((e=>e/256));return t.userData.shirt={value:new a.Pa4(e[0],e[1],e[2])},t.userData.wind={value:new a.Pa4(0,1,0)},t.children.forEach((e=>{e&&"SkinnedMesh"==e.type&&(e.castShadow=!0,e.receiveShadow=!0,"Gran"!=e.name&&"Man"!=e.name&&"GranHead"!=e.name||(console.log("skinned ",e.name),e.material=u.clone(),e.material.skinning=!0,e.material.needsUpdate=!0,e.material.uniforms.shirt=t.userData.shirt),e.name)})),t}return t.clone()}return Li.clone()}var E=[];function S(e,n,t){n?e.scale.set(n,n,n):e.scale.set(110,110,110),t?e.position.set(0,0,t):e.position.set(0,0,-30),h.add(e);let i=Bi(h,g);return h.remove(e),i}function C(e,n,t){let i=document.createElement("img");return i.className="hexPortrait",i.setAttribute("src",S(e,n,t)),i}function L(e,n,t){let i=E[e];return i||(i=S(_(e),n,t),E[e]=i,i)}var z=t(321);let A,T,M;function q(e,n,t){let i=document.createElement("div");i.className="uiSysTop";let o=document.createElement("div"),r=" ";if("object"==typeof n&&null!==n)n.type&&(r+=n.type),n.color&&(i.style.backgroundColor=n.color);else switch(n){case"warn":r+="uiIconWarning",i.style.backgroundColor="#EFEF79";break;case"error":r+="uiIconError",i.style.backgroundColor="#D25E5E";break;case"net":r+="uiIconNet",i.style.backgroundColor="#FFC65E";break;case"person":r+="uiIconPerson",i.style.backgroundColor="#D257FF";break;case"time":r+="uiIconTime",i.style.backgroundColor="#5094D9";break;case"success":r+="uiIconSuccess",i.style.backgroundColor="#95F17F"}o.className="uiIcon"+r;let a=document.createElement("span");function l(){i.style.animation=t?"0.5s uiSysMini forwards":"0.5s uiSysFold forwards",setTimeout((function(){t?(i.style.position="absolute",i.style.left="-64px",i.addEventListener("click",(function(e){i.style.animation="0.5s uiSysMax forwards",setTimeout((function(){i.style.animation="0.5s uiSysMini forwards"}),3500)}))):i.remove()}),500)}if(a.innerText=e,a.addEventListener("click",(function(e){!function(e){M.value=e.innerText,M.style.display="block",M.select(),document.execCommand("copy"),M.blur(),M.style.display="none"}(a),function(e,n,t){let i=document.createElement("div");i.className="uiCursorMessage",i.style.left=e+"px",i.style.top=n+"px",i.innerText="Copied",A.appendChild(i),setTimeout((function(){i.style.animation="1s uiFade forwards",setTimeout((function(){i.remove()}),1e3)}),1500)}(e.clientX,e.clientY)})),i.appendChild(o),i.appendChild(a),!t){let e=document.createElement("div");e.className="uiCloseButton",i.appendChild(e),e.addEventListener("click",(function(e){l()}))}return setTimeout((function(){l()}),3500),T.appendChild(i),i}var N,I,H,F,B,P,R;function D(){return I}function O(){var e;(e=document.createElement("style")).innerHTML="\n        .list-item{\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            max-width: calc(100% - 128px);\n            transform: translate(-50%,0);// rotate3d(1,0,0,0deg);\n            margin: 32px 0 16px 0;\n            position: relative;\n            padding: 16px;\n            left: 50%;\n            font-weight: bold;\n            font-size: 2em;\n            text-shadow: 1px 1px 2px black;\n            text-align: center;\n            font-family: 'openBold', serif;\n            transition: 0.2s transform;\n\n        }\n        .list-item span{\n            margin: 32px 0 32px 0;\n        }\n        .list-item:hover{\n            transform: translate(-50%,0) scale(1.05,1.05);// rotate3d(1,0,0,0deg);\n        }\n        .list{\n            width: 100%;\n            height: 100%;\n            position: absolute;\n            overflow-y: scroll;\n        }\n        .list *{\n            user-select: none;\n        }\n        .list-portrait{\n            left: 8px;\n            top: 8px;\n            position: absolute;\n            display: inline-block;\n            width: 64px;\n            height: 64px;\n            border-radius: 32px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            overflow: hidden;\n            box-sizing: border-box;\n            border: white solid 6px;\n            transform: translate(-50%,-50%);\n            transition: left 0.4s;\n        }\n        .bigger-item .list-portrait{\n            left: 50% !important;\n            top: 0px !important;\n        }\n        .login-popin{\n            position: fixed;\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n        }\n        #login-junk{\n            max-width: 500px;\n            height: 300px;\n            transform: translate(-50%,0);\n            position: relative;\n            left: 50%;\n        }\n        .num{\n            margin-left: 0 !important;\n            border-radius: 28px;\n            font-size: 36px;\n            background-color: #0005;\n            width: 56px;\n            height: 56px;\n            display: inline-block;\n            overflow: hidden;\n            cursor: pointer;\n        }\n        .num-row{\n            width: 168px;\n            height: 168px;\n            position: absolute;\n            left: 50%;\n            transform: translate(-50%,0);\n        }\n        input{\n            text-align: center;\n            font-size: 16px;\n            outline: none;\n            border: none;\n            border-bottom: black 6px solid;\n            margin: 16px;\n            background-color: transparent;\n            color: inherit;\n        }\n        ",document.body.appendChild(e);let n=document.querySelector("#login-junk");n.style.display="none";let t=document.createElement("div");t.className="list",H=n.querySelector("input"),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&H.setAttribute("readonly","readonly"),function(e){let n=document.createElement("div");n.className="num-row";for(let e=1;e<=10;e++){let t=document.createElement("div");t.innerText=10==e?0:e,t.className="num",n.appendChild(t),t.addEventListener("click",(e=>{e.stopPropagation(),H.value.length<4&&(H.value+=e.target.innerText)}))}let t=document.createElement("div");t.className="num",t.innerText="C",t.addEventListener("click",(e=>{e.stopPropagation(),H.value=""})),n.appendChild(t);let i=document.createElement("div");i.className="num",i.innerText="Go",i.style.backgroundColor="#fff5",i.addEventListener("click",(e=>{e.stopPropagation();let n=e.target.parentElement.parentElement.parentElement.querySelector("span");var t,i;n&&(console.log("login with ",n.innerText,":",H.value),t=n.innerText,i=H.value,fetch("/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:i})}).then((function(e){return e.ok?e.json():void q(e.status+":"+e.statusText,"warn")})).then((function(e){e&&(q(e.message,"success"),function(e){if(!(I=N[e]))throw new Error("player doesn't exist")}(e.id),window.m=wn,console.log("trying auth..."),fn=q("attempting communications...","net",!0),(rn=z("/dand-dev")).on("connect",(function(){document.querySelector("#login-menu").style.display="none",console.log("connected"),rn.emit("physInit"),fn.remove(),fn=void 0})),rn.on("event",(function(e){})),rn.on("disconnect",(function(e){console.log("disconnected ",e),e.includes("disconnect")?document.querySelector("#login-menu").style.display="block":fn=q("lost connection, attempting reconnection...","net",!0)})),rn.on("message",(function(e,n){qe(e,n)})),rn.on("join",(function(e){Ie(e+" has joined!")})),rn.on("terrain",(function(e,n,t){Un(0,t)})),rn.on("sendPhys",(function(e,n){ai(e,n)})),rn.on("physUpdate",(function(e){vn?(ni(e),console.log("phys synced")):console.log("!!!phys IGNORED")})),rn.on("physInit",(function(e,n){ti(),e.forEach(((e,n)=>{$t(e[0],e[1],e[2],{x:0,y:0,z:0},{x:0,y:0,z:0,w:0},e[3],e[4])})),ni(n),vn=!0})),rn.on("physMake",(function(e,n,t,i,o,r,a){$t(e,n,t,i,o,r,a),console.log("made")})),rn.on("physDel",(function(e){o.physDel(e),console.log("deleted")})),rn.on("updateSheet",(function(e,n){mn(e,n),console.log("deleted")})),fetch("/lastChats",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&(e.array.forEach((e=>{qe(e[0],e[1])})),Ie("Last 10 messages"))})).catch((e=>{q(e,"error"),console.error("ERROR ",e)})),fetch("/grid",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&e.grid.length>0&&Un(0,e.grid)})).catch((e=>{q(e,"error"),console.error("ERROR ",e)})),fetch("/getSheets",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&function(e){Qe=e;let n,t=Be.querySelector(".sheet-nav");N.forEach((e=>{let i=un("sheet-user");i.style.backgroundColor=e.color;let o=document.createElement("span");if(o.innerText=e.username,i.appendChild(o),i.setAttribute("data",e.id),i.addEventListener("click",(e=>{let n=parseInt(e.target.getAttribute("data")),t=Qe[""+n];t&&(on(t),window.scrollTo(0,0),Xe=n)})),e.id==D().id){Xe=e.id,n=i;let t=Qe[""+e.id];t&&on(t)}else t.appendChild(i)})),n&&t.insertBefore(n,t.firstChild)}(e.array)})).catch((e=>{q(e,"error"),console.error("ERROR ",e)})),Et())})).catch((e=>{q(e,"error"),console.error("ERROR ",e)})))})),n.appendChild(i),e.appendChild(n)}(n);let i=document.querySelector("#login-menu");i.appendChild(t),i.appendChild(n),fetch("/getUsers",{method:"post"}).then((function(e){return e.json()})).then((function(e){e&&(function(e){N=[],e.forEach((e=>{N[e.id]=e}))}(e.users),e.users.forEach((e=>{let n=document.createElement("div");n.className="list-item";let i=e.color;n.style.backgroundColor=i;let o=d(l(i));n.style.color=o?"#000000":"#FFFFFF",n.style.textShadow="1px 1px 2px "+(o?"#FFFFFF":"#000000"),n.addEventListener("click",(e=>{let t=document.querySelector("#login-junk");t.style.display="",t.parentElement.classList.remove("bigger-item"),n.appendChild(t),n.classList.add("bigger-item"),e.stopPropagation(),H.focus()}));let r=document.createElement("div");r.className="list-portrait",n.appendChild(r);let a=document.createElement("span");a.innerText=e.username,n.appendChild(a),t.appendChild(n)})))})).catch((e=>{console.error("ERROR"+e)}))}var W,V,j,U=!1,Y=1,X=!1,J=0,G=void 0,K={x:0,y:0};function Z(e){let n=F[e];n&&(n.classList.add("cardMax"),n.focused=!0,n.style.zIndex=0,Object.values(n.children).forEach((e=>{"card-notifier"==e.className?e.remove():e.style.display="initial"})),"chatCard"==n.id&&(Ot(),ue.focus()),Vt(n.id),-1==n.spot?(j.style.top="32px",j.style.left="32px"):(j.style.top=n.style.top,j.style.left=n.style.left),j.spot=n.spot,setTimeout((()=>{j.style.opacity="1",j.style.pointerEvents="auto"}),100),R=n)}function Q(){console.log("close called"),R&&(console.log("focused close called"),R.classList.remove("cardMax"),R.style.zIndex=2,R.focused=void 0,Vt(void 0),Object.values(R.children).forEach((e=>{"card-notifier"==e.className?e.style.display="initial":e.style.display="none"})),j.style.opacity="0",j.style.pointerEvents="none",j.spot=-1),X&&(X=!1,oe())}function $(){clearTimeout(V),V=setTimeout((function(){oe(),Hi()}),250)}function ee(e){let n=0,t=[],i=0==Y||2==Y;e?(n=F.length,t=F):F.forEach((e=>{-1!=e.spot&&(t.push(e),n++)})),i?(B.style.height=64*(n>0?n:1)+"px",B.style.width="82px"):(B.style.width=64*(n>0?n:1)+"px",B.style.height="82px");let o=B.getBoundingClientRect();P=o;let r,a=o.width,l=o.height;r=i?l/n:a/n,e||(i?t.sort((function(e,n){return parseInt(e.style.top)-parseInt(n.style.top)})):t.sort((function(e,n){return parseInt(e.style.left)-parseInt(n.style.left)})));for(let s=0;s<n;s++)W[s]=i?{x:o.left+a/2,y:32+o.top+s*r}:{x:32+o.left+s*r,y:o.top+l/2},G&&G==t[s]&&(K=W[s]),e&&(F[s].spot=s,W[s].app=t[s]),-1!=j.spot&&t[s].spot==j.spot&&ae(j,W[s].x,W[s].y),ae(t[s],W[s].x,W[s].y);let s=barHandle.getBoundingClientRect();if(i){let e=s.left+s.width/2;te({x:e,y:s.top},{x:e,y:s.bottom})}else{let e=s.top+s.height/2;te({x:s.left,y:e},{x:s.right,y:e})}}function ne(){requestAnimationFrame(ne)}function te(e,n){e.x,e.y,n.x,n.y}function ie(e){if(function(e){if(U){J++;let n=e.clientX,t=e.clientY,i=window.innerWidth/2,o=window.innerHeight/2,r=n-i,a=t-o,l=i-Math.abs(r)<10,s=o-Math.abs(a)<10,c=Math.atan2(a,r)/Math.PI,d=Math.abs(c);d<.25?(2!=Y&&(Y=2,oe()),l!=X&&(X=l,oe())):d<.75?(c<0?3!=Y&&(Y=3,oe()):1!=Y&&(Y=1,oe()),s!=X&&(X=s,oe())):(0!=Y&&(Y=0,oe()),l!=X&&(X=l,oe()))}}(e),G){if(J++,G.pos={x:e.clientX+G.offset.x,y:e.clientY+G.offset.y},e.clientY>P.top&&e.clientY<P.bottom&&e.clientX>P.left&&e.clientX<P.right){let e=K,n={x:e.x-G.pos.x,y:e.y-G.pos.y};G.pos={x:e.x-n.x/3,y:e.y-n.y/3},G.moving&&(G.moving=void 0,G.spot=0,ee())}else G.moving||(G.moving=!0,G.spot=-1,ee());G.style.left=G.pos.x+"px",G.style.top=G.pos.y+"px"}}function oe(){2==Y?(B.style.left=window.innerWidth-(X?-32:48)+"px",B.style.top="50%",ee(),barHandle.style.transform="translate(-200%,-50%)",barHandle.style.width="32px",barHandle.style.height="80%",B.style.borderWidth="0px 0px 0px 6px",He(!1)):3==Y?(barHandle.style.transform="translate(-50%,100%)",B.style.left="50%",B.style.top=(X?-32:48)+"px",ee(),barHandle.style.height="32px",barHandle.style.width="80%",B.style.borderWidth="0px 0px 6px 0px",He(!1)):1==Y?(barHandle.style.transform="translate(-50%,-200%)",B.style.left="50%",B.style.top=window.innerHeight-(X?-32:48)+"px",ee(),barHandle.style.height="32px",barHandle.style.width="80%",B.style.borderWidth="6px 0px 0px 0px",He(!0)):(barHandle.style.transform="translate(100%,-50%)",B.style.left=(X?-32:48)+"px",B.style.top="50%",ee(),barHandle.style.width="32px",barHandle.style.height="80%",B.style.borderWidth="0px 6px 0px 0px",He(!1))}function re(e){U&&(U=!1,console.log(J),J<10&&Q()),G?(G.classList.remove("cardMove"),J<20?(R&&R==G&&(G.classList.remove("cardMax"),G.focused=void 0,R=void 0,G.style.zIndex=2),Q(),Z(G.appId)):(ee(),console.log("fix bar also"))):(ee(),console.log("fix bar")),G=void 0,J=0}function ae(e,n,t,i){i||(e.pos={x:n,y:t}),e.style.left=n+"px",e.style.top=t+"px"}var le,se,ce,de,pe,ue,he,ge=!1,me="black";function fe(){ge=!0}function ve(e){if(ge){le.fillStyle=me;let n=e.target.getBoundingClientRect();le.fillRect(32*(e.clientX-n.left)/132,32*(e.clientY-n.top)/132,2,2)}}function xe(e){ge=!1}function we(e){be(e.target),le.fillStyle="rgba(255, 255, 255, 0)",le.clearRect(0,0,32,32)}function ye(e){be(e.target),function(e){let n=document.createElement("a");n.href=e,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e.target.parentElement.parentElement.querySelector(".drawer").toDataURL("image/png"))}function be(e){e.style.animationName="",e.offsetWidth,e.style.animationName="jello"}function ke(e){be(e.target),me=e.target.style.backgroundColor}function _e(){return ce.toDataURL("image/png")}function Ee(e){le.clearRect(0,0,32,32),e.src.includes("undefined")||(le.fillStyle="rgba(255, 255, 255, 0)",le.drawImage(e,0,0,32,32))}function Se(e){let n=document.createElement("div");return e&&(n.className=e),n}function Ce(e,n,t){let i=Se("drawer-opener");return i.setAttribute("status",n),i.addEventListener("click",(n=>{let i=e.querySelector(".drawer-group");i&&"initial"==i.style.display?(i.style.display="none",de=void 0,t&&t(!1)):(se.style.display="initial","character"==(de=n.target.getAttribute("status"))?(se.style.left="-72px",se.style.top="64px"):(se.style.top="-100px",se.style.left="50%"),e.appendChild(se),t&&t(!0))})),e.appendChild(i),i}function Le(){return de}var ze=-1,Ae=null,Te=-1;function Me(){if(ue.value.length>0||"chat"==Le()){let n="";"chat"==Le()&&(n+=_e()+"#",se.style.display="none",de=void 0),n+=ue.value,e=n,rn.emit("message",e),ue.value=""}var e}function qe(e,n){let t=function(e){return N[e]}(e);t||(t={username:"Unknown",id:-1,color:"black"}),function(e,n,t){let i=document.createElement("p"),o=n.color;i.style.backgroundColor=o;let r=d(l(o));i.style.color=r?"#000000":"#FFFFFF",i.style.textShadow="1px 1px 2px "+(r?"#FFFFFF":"#000000");let a=e.indexOf("data:image");if(a>-1){let n=e.indexOf("#",a);if(n>-1){let t=e.substring(a,n);console.log(t);let o=new Image;o.className="stretch-image",o.src=t,i.appendChild(o),e=e.substring(n+1)}}i.innerHTML+=e;{let e=document.createElement("div");if(e.classList.add("chat-row"),n.id==D().id&&e.classList.add("chat-right"),i.classList.add("chat-bubble"),Te>=0&&Te==n.id)ze==n.id?(Ae.classList.remove("chat-bubble-footer"),Ae.classList.add("chat-bubble-body")):Ae.classList.add("chat-bubble-header"),i.classList.add("chat-bubble-footer");else{let e=document.createElement("p");e.classList.add("chat-nametag"),e.innerHTML=n.username;let t=document.createElement("div");n.id==D().id&&(t.style.textAlign="right"),t.appendChild(e),pe.appendChild(t)}ze=Te,Ae=i,Te=n.id,e.appendChild(i),pe.appendChild(e),pe.scrollTop=pe.scrollHeight}}(n,t),function(e,n){let t=F[2];if(!t.focused){let e=t.querySelector(".card-notifier");e?e.innerText=parseInt(e.innerText)+1:(e=document.createElement("div"),e.className="card-notifier",t.appendChild(e),e.innerText=1),t.style.animation="",t.offsetWidth,t.style.animation="attention 0.2s"}}()}function Ne(){ue.blur(),Q(),Wt(!1)}function Ie(e){let n=document.createElement("div");n.className="chat-divider";let t=document.createElement("p");t.innerText=e,n.appendChild(t),pe.appendChild(n)}function He(e){e?(pe.style.height="calc(100vh - 100px)",he.style.bottom="100px"):(pe.style.height="calc(100vh - 64px)",he.style.bottom="0px")}const Fe=[["STR","Athletics","athletics.png"],["DEX","Acrobatics","acrobatics.png"],["DEX","Sleight of Hand","sleight.png"],["DEX","Stealth","stealth.png"],["INT","Arcana","arcana.png"],["INT","History","history.png"],["INT","Investigation","investigation.png"],["INT","Nature","nature.png"],["INT","Religion","religion.png"],["WIS","Animal Handling","animal.png"],["WIS","Insight","insight.png"],["WIS","Medicine","medicine.png"],["WIS","Perception","perception.png"],["WIS","Survival","survival.png"],["CHR","Deception","deception.png"],["CHR","Intimidation","intimidation.png"],["CHR","Performance","performance.png"],["CHR","Persuasion","persuasion.png"]];var Be,Pe,Re,De,Oe,We,Ve,je,Ue,Ye,Xe,Je,Ge,Ke=!0,Ze=!1,Qe=[];function $e(e,n){let t=un("section-item "+e),i=un("section-item-label"),o=hn(0,30);i.innerText=n,t.appendChild(i);let r=un("centered");r.appendChild(o),t.appendChild(r);let a=un("section-item-saving-throw"),l=un("centered"),s=document.createElement("input");s.className="number",s.value=0,s.type="number",s.min=0,s.max=30,l.appendChild(s),a.appendChild(l),t.appendChild(a);let c=un("skill-link-row");return t.appendChild(c),t}function en(e){let n,t=un("feature"),i=un("feature-name"),o=document.createElement("p"),r=document.createElement("input");return r.setAttribute("type","checkbox"),e?(r.checked=e.spell,r.style.display="none",i.innerText=e.name,o.innerText=e.description,n=[],e.tags.forEach((e=>{let t=un("feature-tag");t.innerText=e,n.push(t)}))):(n=un("feature-tag"),i.setAttribute("contenteditable",!0),n.setAttribute("contenteditable",!0),o.setAttribute("contenteditable",!0)),t.appendChild(i),e?n.forEach((e=>{t.appendChild(e)})):t.appendChild(n),t.appendChild(o),t.appendChild(r),t}function nn(){Ze=!0,Be.querySelectorAll(".section-group-mini").forEach((e=>{e.classList.remove("section-group-mini")})),Be.querySelectorAll(".number").forEach((e=>{e.disabled=!1,function(e){let n=un("editable-number"),t=e.getBoundingClientRect();n.style.left=t.width/2-24+e.offsetLeft+"px",n.style.top=t.height/2-24+e.offsetTop+"px",n.addEventListener("touchstart",sn),n.addEventListener("touchmove",cn),n.addEventListener("touchend",dn),n.addEventListener("click",pn),n.host=e,n.range=[parseInt(e.value),parseInt(e.min),parseInt(e.max)],e.parentElement.appendChild(n)}(e)})),Object.values(Be.querySelectorAll("p")).forEach((e=>{e.setAttribute("contenteditable",!0)})),Ve.querySelectorAll(".feature").forEach((e=>{let n=e.querySelector("input");n&&(n.style.display="initial");let t=e.querySelector(".feature-name"),i=e.querySelector("p");t&&t.setAttribute("contenteditable",!0),i&&i.setAttribute("contenteditable",!0),e.querySelectorAll(".feature-tag").forEach((e=>{e.setAttribute("contenteditable",!0)}))})),Ye.style.display="initial",Oe.querySelector(".section-banner").setAttribute("contenteditable",!0),Be.querySelectorAll(".feature-add").forEach((e=>{e.style.display="block"})),window.scrollTo(0,0)}function tn(e){Ze=!1,Be.querySelectorAll(".section-group").forEach((e=>{e.classList.add("section-group-mini")}));let n={};Be.querySelectorAll(".editable-number").forEach((e=>{e.removeEventListener("touchstart",sn),e.removeEventListener("touchmove",cn),e.removeEventListener("touchend",dn),e.addEventListener("mouseup",pn),e.remove()})),Be.querySelectorAll(".number").forEach((e=>{e.disabled=!0})),n.traits=[],Ve.querySelectorAll(".feature").forEach((e=>{let t={},i=e.querySelector(".feature-name"),o=e.querySelector("p");if(!i&&!o||0==i.innerText.length&&0==o.innerText.length)e.remove();else{t.name=i.innerText,t.text=o.innerText,t.tags=[],e.querySelectorAll(".feature-tag").forEach((e=>{e.setAttribute("contenteditable",void 0),e.innerText.length>0?t.tags.push(e.innerText):e.remove()}));let r=e.querySelector("input");r&&(r.checked?(t.spell=!0,e.classList.remove("trait"),e.classList.add("spell")):(e.classList.add("trait"),e.classList.remove("spell")),r.style.display="none"),i.setAttribute("contenteditable",void 0),o.setAttribute("contenteditable",void 0),n.traits.push(t)}})),n.personality=[],De.querySelectorAll("p").forEach((e=>{e.setAttribute("contenteditable",void 0),n.personality.push(e.innerText)})),n.proficiencies=[],We.querySelectorAll("p").forEach((e=>{n.proficiencies.push(e.innerText)})),n.abilities=[],Re.querySelectorAll(".section-item").forEach((e=>{let t=e.querySelectorAll(".number");n.abilities.push([t[0].value,t[1].value])})),n.skills=[],Re.querySelectorAll(".skill-item").forEach((e=>{n.skills.push(e.querySelector("input").value)})),n.character={};let t=Oe.querySelector(".section-banner"),i=Oe.querySelector(".character-class"),o=Oe.querySelector(".number");"character"==Le()&&Ye.click(),Ye.style.display="none";let r=Oe.querySelector(".character-inspiration").querySelector("img");var a,l;return n.character.name=t.innerText,n.character.type=i.innerText,n.character.proficiency=o.value,n.character.inspiration=r.src,Be.querySelectorAll(".feature-add").forEach((e=>{e.style.display="none"})),window.scrollTo(0,0),console.log(n),window.tempy=JSON.stringify(n),e||(a=Xe,l=n,rn.emit("updateSheet",a,l),mn(Xe,n)),n}function on(e){Ve.querySelectorAll(".feature").forEach((e=>{e.remove()})),e.traits.forEach((e=>{Ve.insertBefore(en(e),je)})),De.querySelectorAll("p").forEach(((n,t)=>{n.innerText=e.personality[t]})),We.querySelectorAll("p").forEach((e=>{e.remove()})),e.proficiencies.forEach((e=>{let n=un("feature");n.innerText=e,We.insertBefore(n,Ue)})),Re.querySelectorAll(".section-item").forEach(((n,t)=>{let i=n.querySelectorAll(".number");i[0].value=e.abilities[t][0],i[1].value=e.abilities[t][1]})),Re.querySelectorAll(".skill-item").forEach(((n,t)=>{n.querySelector("input").value=e.skills[t]}));let n=Oe.querySelector(".section-banner"),t=Oe.querySelector(".character-class"),i=Oe.querySelector(".number"),o=Oe.querySelector(".character-inspiration").querySelector("img");n.innerText=e.character.name,t.innerText=e.character.type,e.character.proficiency&&(i.value=e.character.proficiency),o.src=e.character.inspiration,window.scrollTo(0,0)}var rn,an={x:0,y:0},ln=!1;function sn(e){e.target,Ge=e.target.host,Je.style.display="none",an={x:e.touches[0].clientX,y:e.touches[0].clientY},e.target.className="floater-arrow",e.target.range[0]=parseInt(Ge.value),setTimeout((function(){ln=!0}),200),ln=!1}function cn(e){if(an){let n=!0,t=e.touches[0].clientX-an.x,i=0;t>24||t<-24?(t=Math.max(-96,Math.min(t,96)),t<-24?(n=!1,i=(e.target.range[1]-e.target.range[0])*((Math.abs(t)-24)/72)):i=(e.target.range[2]-e.target.range[0])*((t-24)/72)):t=0,console.log(t),Ge.value=Math.round(e.target.range[0]+i),e.target.style.transform="translate("+t+"px)"+(n?" rotate(180deg)":"")}}function dn(e){an=!1,e.target.className="editable-number",e.target.style.transform="translate(0)",ln||function(e){Je.style.display="block";let n=e.getBoundingClientRect();Je.style.left=-48+n.left+"px",Je.style.top=n.top+"px"}(e.target)}function pn(e){e.target,Ge=e.target.host,e.target.host.focus()}function un(e){let n=document.createElement("div");return e&&(n.className=e),n}function hn(e,n){let t=document.createElement("input");return t.className="number",t.value=0,t.type="number",t.min=e,t.max=n,t}function gn(e){Ze||(Be.querySelectorAll(".section-group").forEach((n=>{e.target!=n&&n.classList.add("section-group-mini")})),e&&e.target.classList.toggle("section-group-mini"))}function mn(e,n){Qe[""+e]=n}var fn,vn=!1;function xn(e,n,t,i,o,r){rn.emit("physMake",e,n,t,i,o,r)}function wn(e){e||(e="test"),rn.emit("message",e)}function yn(e,n){rn.emit("sendPhys",{id:e.id,position:e.position,velocity:e.velocity,quaternion:e.quaternion,angularVelocity:e.angularVelocity},n)}var bn=[],kn=[],_n=[];var En,Sn,Cn,Ln=2;function zn(e){e?Pi(Cn):Di(Cn)}function An(e,n,t){_n[e][n]=t,Tn()}function Tn(){Wn=6,qn();for(let n=0;n<_n.length;n++)for(let t=0;t<_n.length;t++){let i=_n[n][t],o=Math.floor(Vn(1,4)),r=Math.floor(Vn(1,6));if(1!=i){let o,a,l,s,c,d;o=n>0?_n[n-1][t]:0,a=n<_n.length-1?_n[n+1][t]:0,t<_n.length-1?(l=n>0?_n[n-1][t+1]:0,s=_n[n][t+1]):(l=0,s=0),t>0?(c=_n[n][t-1],d=n<_n.length-1?_n[n+1][t-1]:0):(c=0,d=0),o=o==i,a=a==i,s=s==i,d=d==i,c=c==i,l=l==i;let p=-1,u=0,h=[],g=5;[l,s,a,d,c,o].forEach(((e,n)=>{e?(h.push(n),-1==p&&(p=n),u=n):g=n}));let m="N",f="";if(6==h.length)Mn(i,"H"+f,n,t,Math.floor(r));else if(h.length>0){let o=[];var e=h[0];for(let n=1;n<h.length;n++)o.push(h[n]-e-1),e=h[n];let r=-1==p?0:p;switch(h.length){case 1:m="E",r+=0;break;case 2:m="P",0==o[0]?(f="3",r+=0):1==o[0]?(f="2",r+=0):2==o[0]?(f="1",r+=0):3==o[0]?(f="2",r+=4):(f="3",r+=5);break;case 3:m="T",0==o[0]?0==o[1]?(f=1,r+=0):3==o[1]?(f=1,r+=5):1==o[1]?(f=3,r+=3):2==o[1]&&(f=2,r+=4):1==o[0]?0==o[1]?f=2:1==o[1]?f=4:2==o[1]&&(f=3,r+=2):2==o[0]?0==o[1]?(f=3,r+=0):1==o[1]&&(f=2,r+=3):(f=1,r+=4),r%=6;break;case 4:m="Q",0==o[0]?0==o[1]?0==o[2]?(f=1,r+=0):1==o[2]?(f=3,r+=2):2==o[2]&&(f=1,r+=5):1==o[1]?0==o[2]?(f=2,r+=4):1==o[2]&&(f=3,r+=1):(f=1,r+=4):1==o[0]?0==o[1]?0==o[2]?(f=3,r+=4):f=2:f=3:(f=1,r+=3),r%=6;break;case 5:m="F",r=g+1}Mn(i,m+f,n,t,r)}else Mn(i,"N",n,t,0)}else 1==i&&Mn(i,"O"+o,n,t,Math.floor(r))}}function Mn(e,n,t,i,o){let r=8*Math.sqrt(3)/2,a="Grass_";switch(e){case 1:a="Grass_";break;case 0:a="Water_";break;case 3:a="Mount_";break;case 4:a="Tree_";break;case 5:a="House_"}let l=bn[a+n];if(l){let e=l.clone();e.position.set(t*r*2-48+i*r,8*i*1.5,-1.6),o&&(o=6-o,e.rotation.z=o*Math.PI/3),kn.push(e),Pi(e)}else console.log("invalid model "+a+n)}function qn(){kn.forEach((e=>{Di(e)})),kn=[]}function Nn(e,n){let t=8*Math.sqrt(3)/2,i=Math.floor((8+n)/12),o=Math.floor((e+48+8-i*t)/(2*t));return En.position.set(o*t*2-48+i*t,8*i*1.5,.8),[o,i]}let In={x:0,y:0},Hn=0;var Fn,Bn,Pn,Rn,Dn,On,Wn=6;function Vn(e,n){return(n=n||0)+(Wn=(9301*Wn+49297)%233280)/233280*((e=e||1)-n)}function jn(e){return bn[e].clone()}function Un(e,n){_n=n,Tn()}function Yn(e){En.visible=e}var Xn=2048;Math.PI;let Jn,Gn=1,Kn=-.001;function Zn(e){let n;switch(e){case 4:n=600,Bn.shadow.camera.far=1200,Bn.shadow.mapSize.width=Xn,Bn.shadow.mapSize.height=Xn,Jn=100,Bn.position.z=600;break;case 3:n=300,Bn.shadow.camera.far=600,Bn.shadow.mapSize.width=Xn,Bn.shadow.mapSize.height=Xn,Jn=100,Bn.position.z=300;break;case 2:n=120,Bn.shadow.camera.far=240,Bn.shadow.mapSize.width=Xn,Bn.shadow.mapSize.height=Xn,Jn=40,Bn.position.z=120;break;case 1:n=75,Bn.shadow.camera.far=150,Bn.shadow.mapSize.width=Xn,Bn.shadow.mapSize.height=Xn,Jn=25,Bn.position.z=75;break;default:n=30,Bn.shadow.camera.far=60,Bn.shadow.mapSize.width=Xn,Bn.shadow.mapSize.height=Xn,Jn=10,Bn.position.z=30}Bn.shadow.camera.left=-n,Bn.shadow.camera.right=n,Bn.shadow.camera.top=n,Bn.shadow.camera.bottom=-n,Bn.shadow.map&&(Bn.shadow.map.dispose(),Bn.shadow.map=null),Fn&&setTimeout((function(){Fn.update()}),100)}function Qn(e){e?Fn?Fn.visible=!0:Pi(Fn=new a.Rki(Bn.shadow.camera)):Fn&&(Fn.visible=!1)}var $n,et,nt,tt,it,ot,rt=["man","pot","rock","gran","goblin","hedgehog","werewolf","vampire","zombie"];function at(){return et}function lt(e){tt.style.left=e.clientX+"px",tt.style.top=e.clientY+"px"}function st(e,n,t){let i=function(e){let n=document.createElement("div");return n.className=e,n}("equipment-item");e||(e="undefined");let o=document.createElement("h4");o.innerText=e;let r=document.createElement("p");r.innerText=n||"stuff";let a=document.createElement("img");a.className="equipment-icon",t&&(i.setAttribute("data",t),a.setAttribute("src",L(t))),i.appendChild(o),i.appendChild(a),i.appendChild(r),i.addEventListener("pointerdown",(e=>{tt.children.length&&tt.children[0].remove(),(ot=i).classList.add("equipment-item-selected"),tt.appendChild(i.cloneNode(!0)),lt(e)})),i.addEventListener("pointerup",(e=>{let n=document.elementFromPoint(e.clientX,e.clientY);(n.classList.contains("equipment-item")||(n=n.parentElement,n.classList.contains("equipment-item")))&&(console.log("up"+n.innerText),ot&&(ot.classList.remove("equipment-item-selected"),it.insertBefore(ot,n),ot=void 0),tt.children.length&&tt.children[0].remove())})),it.appendChild(i)}var ct,dt,pt=t(335),ut=void 0,ht=!1,gt=!1,mt=0,ft=0,vt=0,xt=0,wt=0,yt=!1,bt=[],kt=0,_t=0;function Et(){let e=document.querySelector(".canvasHolder");window.addEventListener("pointermove",Mt),e.addEventListener("pointerdown",At),window.addEventListener("pointerup",Tt),window.addEventListener("contextmenu",Pt),window.addEventListener("keyup",Dt)}var St=!1;function Ct(e,n,t,i){!function(e,n){(ct=new pt.z(n,e)).callbackCounts=e=>{1==e?ut=setTimeout((function(){ht=!0}),100):ut&&clearTimeout(ut)},ct.mouseButtons={LEFT:void 0,MIDDLE:a.RsA.ROTATE,RIGHT:a.RsA.PAN},ct.maxPolarAngle=1.3,ct.isControl(),zt(),ct.addEventListener("change",(function(e){var n,t=ct.target.distanceTo(ct.object.position);t<30?(0!=St&&Zn(0),St=0):t<100?(1!=St&&Zn(1),St=1):t<180?(2!=St&&Zn(2),St=2):(3!=St&&Zn(3),St=3),n=ct.target,Dn.set(n.x,n.y,n.z),Bn.position.x=n.x,Rn.position.x=n.x})),ct.addEventListener("end",(function(e){ut&&clearTimeout(ut),ht=!1}))}(n,t)}function Lt(){console.log("p2"),ct.touches={ONE:69,TWO:a.QmN.DOLLY_PAN}}function zt(){console.log("p1"),ct.touches={ONE:a.QmN.PAN,TWO:a.QmN.DOLLY_ROTATE}}function At(e){0==e.button&&(gt=!0),mt=e.clientX,ft=e.clientY}function Tt(e){gt=!1,"landscapeCard"==dt?(Hn=0,In.x=0,In.y=0):"equipmentCard"==dt&&function(e,n){if(ot){ot.classList.remove("equipment-item-selected"),tt.children.length&&tt.children[0].remove(),ot.style.display="none";let e=function(e){let n={},t=e.querySelector("h4"),i=e.querySelector("p"),o=e.getAttribute("data");return t&&(n.name=t.innerText),i&&(n.description=i.innerText),o&&(n.model=o),n}(ot);if(e){let n=It();e.color=D().color,xn({x:1.5,y:1.5,z:3},2,{x:n.x,y:n.y,z:10},si(Math.PI/2),1,e)}ot=void 0}else{let t=ci();if(t){let i=document.elementFromPoint(e,n);i&&(i=i.closest("#equipment-bar"),i&&(st(t.meta.name,t.meta.description,t.meta.model),ei(t.id),jt()))}}}(mt,ft)}function Mt(e){mt=e.clientX,ft=e.clientY}function qt(){return mt}function Nt(){return ft}function It(){return{x:vt,y:xt,z:wt}}function Ht(e){let n={x:e.x-vt,y:e.y-xt,z:e.z-wt};switch(bt.push(n),bt.length>6&&bt.shift(),vt=e.x,xt=e.y,wt=e.z,dt){case"landscapeCard":gt||Nn(vt,xt),(ht||gt)&&function(e,n){let[t,i]=Nn(e,n),o=_n.length;(t!=In.x||i!=In.y)&&t>-1&&i>-1&&t<o&&i<o&&(0==Hn&&_n[t][i]==Ln?An(t,i,1):An(t,i,Ln),Hn++,In.x=t,In.y=i,Sn&&(clearTimeout(Sn),Sn=null),Sn=setTimeout((function(){var e;e=_n,rn.emit("terrain",D().id,0,e)}),2e3))}(vt,xt);break;case"makerCard":if(ht||gt){let e=at();if(e){ht=!1,gt=!1,Bt();let n=e.charAt(0).toUpperCase()+e.slice(1);xn({x:1.5,y:1.5,z:3},2,{x:vt,y:xt,z:wt+.1},si(_t),1,{name:n,color:D().color,model:e})}}break;default:ht||gt?(Bt(),1==(kt=ri(e,_t))&&(ct.reset(),Lt())):kt>-1&&(li(e,Ft()),jt())}}function Ft(){let e={x:0,y:0,z:0};return bt.forEach((n=>{e.x+=n.x,e.y+=n.y,e.z+=n.z})),e}function Bt(){let e=Ft();Math.sqrt(e.x*e.x+e.y*e.y)>.2&&(_t=Math.PI/2+Math.atan2(e.y,e.x))}function Pt(e){return e.preventDefault(),!1}function Rt(){return ct.object.rotation.z}function Dt(e){if(Ot())return!1;switch(console.log(e.which),e.which){case 13:Z(2);break;case 27:Q();break;case 49:Zn(0);break;case 50:Zn(1);break;case 51:Zn(2);break;case 52:Zn(3);break;case 53:Zn(4);break;case 84:case 89:break;case 192:window.pickTarget=r.pick(),window.pickTarget&&console.log("picked a "+window.pickTarget.type)}}function Ot(){return yt}function Wt(e){yt=e;let n=document.querySelectorAll(".menuHidable");n.length&&n.forEach((n=>{n.style.visibility=e?"hidden":"visible"}))}function Vt(e){switch(dt=e,e){case"makerCard":Lt();break;case"landscapeCard":Yn(!0),Lt();break;default:zt()}"landscapeCard"!=e&&Yn(!1)}function jt(){kt=-1,gt=!1,ht=!1,zt(),di()}var Ut,Yt,Xt=t(279),Jt=0;function Gt(){(Ut=new Xt.World).quatNormalizeSkip=0,Ut.quatNormalizeFast=!1,Ut.allowSleep=!0,Ut.gravity.set(0,0,-10),Ut.broadphase=new Xt.NaiveBroadphase;let e=new Xt.Box(new Xt.Vec3(1,1,2));for(let n=0;n<1;n++){let n=new Xt.Body({mass:4});n.addShape(e),n.position.set(0,0,60),Ut.addBody(n),Yt=n,window.playerBody=Yt}new Xt.Material({name:"gooProperty",friction:10,restitution:-1}).name="gooProperty",new Xt.Material({name:"wallProperty",friction:.1,restitution:1}).name="wallProperty",function(){let e=new Xt.Plane,n=new Xt.Body({mass:0});n.addShape(e),Ut.addBody(n)}()}function Kt(){Ut.step(.03333333333333333);let e=Object.values(Zt);for(var n=0;n!==e.length;n++)if(null!=e[n].id){let t=Qt[e[n].id];t.position.copy(e[n].position),t.quaternion.copy(e[n].quaternion)}let t=Rt(),i=Yt.velocity.length();Ki.left?(i<2&&(Yt.velocity.x-=2*Math.cos(t),Yt.velocity.y-=2*Math.sin(t)),Jt=t+Math.PI/2,Yt.quaternion.setFromAxisAngle(new Xt.Vec3(0,0,1),Jt)):Ki.right?(i<2&&(Yt.velocity.x+=2*Math.cos(t),Yt.velocity.y+=2*Math.sin(t)),Jt=t-Math.PI/2,Yt.quaternion.setFromAxisAngle(new Xt.Vec3(0,0,1),Jt)):Ki.up?(i<2&&(Yt.velocity.x-=2*Math.sin(t),Yt.velocity.y+=2*Math.cos(t)),Jt=t,Yt.quaternion.setFromAxisAngle(new Xt.Vec3(0,0,1),Jt)):Ki.down&&(i<2&&(Yt.velocity.x+=2*Math.sin(t),Yt.velocity.y-=2*Math.cos(t)),Jt=t+Math.PI,Yt.quaternion.setFromAxisAngle(new Xt.Vec3(0,0,1),Jt)),_i.position.copy(Yt.position),_i.quaternion.copy(Yt.quaternion)}var Zt=[],Qt=[];function $t(e,n,t,i,o,r,a){let l,s,c=new Xt.Body({mass:t});if(l=r?new Xt.Cylinder(n.x,n.y,n.z,6):new Xt.Box(new Xt.Vec3(n.x,n.y,n.z)),c.addShape(l),c.position.set(i.x,i.y,i.z),o&&c.quaternion.copy(o),c.id=e,c.meta=a,Zt[e]=c,Ut.addBody(c),a&&a.model){let e=_(a.model,a.color);s=Yi(),e.position.z=-n.z/2,e.rotation.x=Math.PI/2,s.add(e)}else s=r?Vi(n.x,n.y,n.z,i.x,i.y,i.z,a.color):Wi(2*n.x,2*n.y,2*n.z,i.x,i.y,i.z,a.color);Pi(s),Qt[e]=s,s.physId=e}function ei(e){Di(Qt[e]),delete Qt[e],Ut.remove(Zt[e]),delete Zt[e]}function ni(e){e.forEach((e=>{let n=Zt[e[0]];n&&(n.position.copy(e[1]),n.quaternion.copy(e[2]),n.velocity.copy(e[3]),n.angularVelocity.copy(e[4]),n.sleepState!=e[5]&&(2==e[5]?n.sleep():2==n.sleepState&&n.wakeUp()))}))}function ti(){Qt.forEach((e=>{Di(e)})),Qt=[],Object.values(Zt).forEach((e=>{Ut.remove(e)})),Zt=[]}var ii,oi=0;function ri(e,n){if(null==ii){let n,t=6;if(Qt.forEach((i=>{if(null!=i.physId){let o=i.position.distanceTo(e);o<t&&(n=i.physId,t=o)}})),null!=n)return ii=Zt[n],1;ii=-1}else if(-1!=ii){let t=ii;return t.quaternion.setFromAxisAngle(new Xt.Vec3(0,0,1),n),t.position.copy(e),t.position.z+=6,t.sleep(),++oi>10&&(oi=0,yn(t,!0),console.log("send phys ",t.id,JSON.stringify(t.meta))),1}return 0}function ai(e,n){let t=Zt[e.id];t&&(t.position.copy(e.position),t.quaternion.copy(e.quaternion),n?t.sleep():(t.velocity.copy(e.velocity),t.angularVelocity.copy(e.angularVelocity),t.wakeUp()))}function li(e,n){if(ii&&-1!=ii){let t=ii;t&&(t.wakeUp(),t.position.copy(e),t.velocity.copy(n),t.position.z+=6,oi=0,yn(t,!1),console.log("send phys NOW"))}ii=void 0}function si(e){let n=new Xt.Quaternion(0,0,0,0);return n.setFromAxisAngle(new Xt.Vec3(0,0,1),e),n}function ci(){if(-1!=ii)return ii}function di(){ii=void 0}var pi,ui,hi,gi,mi,fi,vi,xi,wi,yi,bi,ki,_i,Ei,Si,Ci,Li,zi=t(145),Ai=t(38),Ti=(t(857),t(596)),Mi=t(26);function qi(){var e;(pi=new a.cPb(45,window.innerWidth/window.innerHeight,1,5e3)).position.z=200,pi.position.y=-200,pi.up=new a.Pa4(0,0,1),pi.lookAt(new a.Pa4(0,0,0)),hi=new a.xsS,ji=hi,yi=document.querySelector(".canvasHolder"),(ui=new a.CP7({antialias:!0,alpha:!0})).shadowMap.enabled=!0,ui.shadowMap.type=a.ntZ,ui.toneMapping=a.LY2,ui.outputEncoding=a.knz,ui.setClearColor(16744242,1),yi.appendChild(ui.domElement),xi=new zi.E,e=a.rDY.merge([a.Vj0.standard.uniforms]),new a.jyz({uniforms:e,derivatives:!1,lights:!0,vertexColors:!0,vertexShader:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec3 shirt;\nuniform vec3 wind;\n\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #ifdef USE_COLOR\n        if(color==vec3(0,0,1))\n            vColor.xyz = shirt;\n        else\n            vColor.xyz = color.xyz;\n        \n    #endif\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n    #ifdef USE_TANGENT\n        vTangent = normalize( transformedTangent );\n        vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n    #endif\n#endif\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    \n        if(color==vec3(1,0,0)){\n            float val=max(0.0, 1.0976 - transformed.z);\n            transformed.xyz+=val*wind;\n            transformed.y*=1.0+sin((wind.z+transformed.z)*4.0)/2.0;\n\n        }\n    \n\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n}",fragmentShader:"\n    #define STANDARD\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <roughnessmap_fragment>\n    #include <metalnessmap_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n    #include <lights_physical_fragment>\n    #include <lights_fragment_begin>\n    #include <lights_fragment_maps>\n    #include <lights_fragment_end>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n    gl_FragColor = vec4( outgoingLight,1.-(((0.2125 * outgoingLight.r) + (0.7154 * outgoingLight.g) + (0.0721 * outgoingLight.b)) ) );\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n    #include <dithering_fragment>\n}",roughness:0,metalness:1}),ji=hi,mi=pi,Hi(),bi=new Ai.x(ui);let n=new Ti.G(hi,pi,300,200);n.kernelRadius=6,n.minDistance=15e-5,n.maxDistance=.001,bi.addPass(n),window.ssao=n,new a.vBJ({color:7722446}),new a.Wid({color:2156703,metalness:0,roughness:1}),new a.Wid({color:2156703,metalness:0,roughness:1}),new a.Wid({color:5534117,metalness:0,roughness:1});let t=new a.Wid({color:15398690,metalness:0,roughness:1});ki=new a.Wid({color:13576926,metalness:0,roughness:1}),new a.Wid({color:11930379,metalness:0,roughness:1}),new a.Wid({color:15398690,metalness:0,roughness:1}),gi=new a.ZAu,_i=new a.ZAu;let i=new a.vBJ({color:16777215,side:a.Wl3}),o=new a.vBJ({color:3282968,side:a.Wl3}),r=Oi(1,1,2,0,0,0,t),l=Oi(1,.2,1,0,.5,.5,i),s=Oi(.3,.2,.3,0,.6,.5,o);_i.add(r),_i.add(l),_i.add(s),gi.add(_i);let c=Oi(.5,.5,1.5,.75,0,20,new a.vBJ({color:14035807}));gi.add(c),hi.add(gi),function(){let e=new a.zf8(1,8);Si=new a.vBJ({color:4907322}),new a.vBJ({color:15461888}),(Ei=new a.Kj0(e,Si)).position.z=.05,hi.add(Ei),new a.iMs}(),new a.Pa4(1,0,0),Dn=new a.Pa4(0,0,0),Ri(On=new a.Mig(9408399)),(Bn=new a.Ox3(14702423,.5)).position.set(0,250,0),Bn.castShadow=!0,Ri(Bn),(Rn=new a.Tme).position.set(20,0,20),Ri(Rn),Bn.target=Rn,Bn.shadow.mapSize.width=Xn,Bn.shadow.mapSize.height=Xn,Bn.shadow.camera.near=1,Zn(0),Bn.shadow.radius=2.2,Bn.shadow.bias=-5e-4,(Pn=Bn.clone()).shadow.mapSize.width=256,Pn.shadow.mapSize.height=256,Pn.shadow.radius=0,Pn.visible=!1,Ri(Pn),window.sunLight=Bn,Qn(!0),Ct(0,yi,pi);let d=new a.vBJ({color:16711680}),p=new a.vBJ({color:16746496}),u=new a.vBJ({color:16776960}),h=new a.vBJ({color:65280}),g=new a.vBJ({color:255}),m=new a.vBJ({color:8913151}),f=new a.nvb(1,1,1);return Li=new a.Kj0(f,[d,p,u,h,g,m]),setTimeout((function(){Fi()}),1),yi}function Ni(e){e&&!Ci&&(Ci=new Mi.O(hi,Ut))}function Ii(e,n,t,i){xi.load("./"+e,(e=>{let o;if(e.scene.rotation.x=Math.PI/2,e.scene.traverse((function(e){e instanceof a.Kj0&&(o=e,t||(e.material=i?new a.Wid({color:i,metalness:0,roughness:1}):new a.Wid({vertexColors:a.jSK,metalness:0,roughness:1}),e.material.needsUpdate=!0))})),e.scene.children[0],o){var r=e.animations;if(r&&r.length){wi=new a.Xcj(o);for(var l=0;l<r.length;l++){var s=r[l];let e=wi.clipAction(s);e.timeScale=.002,e.play()}}}n(e.scene)}),(e=>{console.log(e.loaded/e.total*100+"% loaded")}),(e=>{console.error("An error happened",e)}))}function Hi(){window.screen.width>window.innerWidth?(fi=window.innerWidth,vi=window.innerHeight):(fi=window.screen.width,vi=window.screen.height),pi.aspect=fi/vi,pi.updateProjectionMatrix(),ui.setPixelRatio(.5),ui.setSize(fi,vi)}function Fi(e){Kt(),gi.rotation.z>Math.PI/16||(gi.rotation.z,Math.PI),function(){var e=new a.Pa4;e.set(qt()/window.innerWidth*2-1,-Nt()/window.innerHeight*2+1,.5),e.unproject(pi);var n=e.sub(pi.position).normalize(),t=-pi.position.z/n.z,i=pi.position.clone().add(n.multiplyScalar(t));Ei.position.x=i.x,Ei.position.y=i.y,Ei.position.z=i.z+.5,Ht(Ei.position)}(),function(){Gn+=Kn,Gn<0?(Gn=0,Kn=-Kn):Gn>1&&(Gn=1,Kn=-Kn),Gn&&(Bn.color.setHex(16777215),On.color.setHex(6316128),Ui(11594237,1));let e=Jn*Gn;Rn.position.y=Dn.y-e,Bn.position.y=Dn.y+e}(),Ci&&Ci.update(),ui.render(ji,mi),requestAnimationFrame(Fi)}function Bi(e,n){ui.setSize(128,128),ui.setClearColor(16777215,0),e&&n?ui.render(e,n):ui.render(getScene(),pi);let t=ui.domElement.toDataURL();return ui.setSize(fi,vi),t}function Pi(e){gi.add(e)}function Ri(e){hi.add(e)}function Di(e){gi.remove(e)}function Oi(e,n,t,i,o,r,l){let s=new a.nvb(e,n,t);l||(l=ki);let c=new a.Kj0(s,l);return c.castShadow=!0,c.position.x=i||0,c.position.y=o||0,c.position.z=r||0,c}function Wi(e,n,t,i,o,r,l){return Oi(e,n,t,i,o,r,l=l?new a.vBJ({color:l}):ki)}function Vi(e,n,t,i,o,r,l){let s=new a.fHI(e,n,t,6);l=l?new a.vBJ({color:l}):ki,s.rotateX(Math.PI/2),s.rotateZ(Math.PI/2);let c=new a.Kj0(s,l);return c.castShadow=!0,c.position.x=i||0,c.position.y=o||0,c.position.z=r||0,c}var ji=0;function Ui(e,n){ui.setClearColor(e,n)}function Yi(){return new a.ZAu}let Xi;function Ji(e,n,t,i){let o,r=document.createElement("div"),a=document.createElement("div");if(a.classList.add("switch"),t&&(o=settingsObject[t]),i){o!=i[0]&&(o!=i[i.length-1]?a.classList.add("switchHalf"):a.classList.add("switchOn")),a.setAttribute("value",o);let e=0;for(let n=0;n<i.length;n++)i[n]==o&&(e=n);a.setAttribute("index",e),a.addEventListener("click",(function(e){e.stopPropagation();let t=a.getAttribute("index");t++,t>=i.length&&(t=0),0==t?a.classList.remove("switchOn"):t==i.length-1?(a.classList.remove("switchHalf"),a.classList.add("switchOn")):a.classList.add("switchHalf");let o=i[t];a.setAttribute("value",o),a.setAttribute("index",t),n(o)}))}else o&&a.classList.add("switchOn"),a.addEventListener("click",(function(e){e.stopPropagation(),a.classList.contains("switchOn")?(a.classList.remove("switchOn"),n(!1)):(a.classList.add("switchOn"),n(!0))}));r.appendChild(a);let l=document.createElement("span");l.innerHTML=e,r.appendChild(l),Xi.appendChild(r),n(o)}var Gi,Ki;!function(){Gi=document.querySelector("#main"),Ki={},function(e){var n;(n=document.createElement("style")).innerHTML='\n\t\t.uiSysTop{\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tposition: relative;\n\t\tmax-width: 600px;\n\t\theight: 64px;\n\t\tborder-radius: 32px;\n\t\ttransform: translate(-50%);\n\t\tbox-shadow: 3px 3px 3px #0005;\n\t\tleft: 50%;\n\t\tbackground: #E0F9D5;\n\t\tmargin: 12px;\n\t\tanimation: uiSysUnfold 1s;\n\t\toverflow: hidden;\n\t\tline-height: 16px;\n\t}\n\t.uiSysTop div{\n\n\t\tmargin: 16px;\n\t\tmargin-left: 0px;\n\t\tflex: 0 0 64px;\n\t}\n\t.uiSysTop span{\n\t\tmargin-right: 48px;\n\t\tmargin-top: 8px;\n\t\tline-height: normal;\n\t\tvertical-align: middle;\n\t\tflex: 1;\n\n\t}\n\t@keyframes uiSysUnfold{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t100%{\n\t\t\ttop: 0px;\n\t\t}\n\t}\n\t@keyframes uiSysFold{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t\theight: 0;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t0%{\n\t\t\ttop: 0px;\n\n\t\t}\n\t}\n\t@keyframes uiSysMini{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\n\t\t}\n\t\t0%{\n\t\t\t\n\t\t}\n\t}\n\t@keyframes uiSysMax{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t100%{\n\t\t\tleft: 50%;\n\t\t}\n\t}\n\n\t.uiHolderSysTop{\n\t\twidth: 600px;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%);\n\t\t/*border: 3px #0999 dotted;*/\n\t\ttransition: height 1s;\n\t}\n\t.uiIcon{\n\t\tfloat: left;\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:32px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z"/></svg>\');\n\t}\n\t.uiIconWarning{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>\') !important;\n\t}\n\t.uiIconError{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>\') !important;\n\t}\n\t.uiIconNet{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"/></svg>\') !important;\n\t}\n\t.uiIconPerson{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>\') !important;\n\t\t\n\t}\n\t.uiIconTime{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/></svg>\') !important;\n\t}\n\n\t.uiIconSuccess{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>\') !important;\n\t}\n\t\n\t.uiCloseButton{\n\t\tposition: absolute;\n\t\tright: 0;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:16px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\');\n\t\t\n\t}\n\n\t.uiCursorMessage{\n\t\tmin-width: 64px;\n\t\theight: 64px;\n\t\tborder: 5px solid white;\n\t\tbackground-color: #FBAB7E;\n\t\tbackground-image: linear-gradient(270deg, #FBAB7E 0%, #F7CE68 100%);\n\n\t\tcolor: white;\n\t\tfont-size: 24px;\n\t\tfont-weight: bold;\n\t\tfont-stretch: ultra-condensed;\n\t\ttransform: translate(-50%,-50%);\n\t\tanimation: uiWobble 0.3s;\n\t\tborder-radius: 32px;\n\t\tbox-sizing: border-box;\n\t\tposition: absolute;\n\t\tline-height: 48px;\n\t\tpadding: 0 8px 0 8px;\n\t\tfont-family: sans-serif;\n\t}\n\n\t@keyframes uiWobble{\n\t\t0%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.6,0.4);\n\t\t}\n\t\t33%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.9,1.15);\n\t\t}\n\t\t66%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.8,0.9);\n\t\t}\n\t\t100%{\n\n\t\t}\n\t}\n\n\t@keyframes uiFade{\n\t\t0%{\n\t\t\topacity: 1;\n\t\t\ttransform: translate(-50%,-50%);\n\t\t}\n\t\t100%{\n\t\t\topacity: 0;\n\t\t\ttransform: translate(-50%,0%)\n\t\t}\n\t}\n\n\t.confetti{\n\t\tpointer-events: none;\n\t\tleft:200px;\n\t\ttop:200px;\n\t\twidth:50px;\n\t\theight:50px;\n\t\tposition: absolute;\n\t\tstroke-width:40px;\n\t\t/*background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 100 100" style="fill:none;stroke:lightgray;stroke-linecap:round;"><path d="M45 65L75 75M45 50L75 50M45 35L75 25" /></svg>\');\n\t\tbackground-size: cover;\n\t\tbackground-position: center;\n\t  \tbackground-repeat: no-repeat;*/\n\t}\n\t.confetti svg{\n\t\tposition: relative;\n\t\tanimation: dooter 0.5s forwards;\n\t\ttransform: translate(-50%,-50%);\n\t\twidth: 50px;\n\t\theight: 50px;\n\t}\n\t@keyframes dooter{\n\t\tfrom{\n\t\t\ttransform: translate(0%,0%) scale(0.1,0.1);\n\t\t\tstroke-width:30;\n\t\t}\n\t\tto{\n\t\t\ttransform: translate(100%,0%) scale(3,3);\n\t\t\tstroke-width:0;\n\t\t\tfilter:hue-rotate(270deg);\n\t\t}\n\t}\n\n\t',document.body.appendChild(n),e?A=e:(A=document.querySelector("#main"),A||(A=document.body)),A?(T=document.createElement("div"),T.className="uiHolderSysTop",A.appendChild(T),M=document.createElement("input"),M.type="text",M.style.position="fixed",M.taxindex="-1",M.style.display="none",M.style.pointerEvents="none",A.appendChild(M)):console.error("UI.js:: uh oh! no system dom element found")}(Gi),window.onError=function(e,n,t,i,o){q(e,"error")},Gt(),qi(),Ii("./assets/models/Hex.glb",(e=>{console.log("got children "+e.children.length);let n=new a.Wid({vertexColors:a.jSK,metalness:0,roughness:1});for(let t=0;t<e.children.length;t++){let i=e.children[t];i.position.set(0,0,60),i.scale.set(8,8,8),i.material=n,i.receiveShadow=!0,(i.name.startsWith("Mount")||i.name.startsWith("Tree")||i.name.startsWith("House"))&&(i.castShadow=!0),bn[i.name]=i;let o=[];if(i.geometry){let e=i.geometry.attributes.color.array.length/4;for(let n=0;n<e;n++){let e=4*n,t=c(i.geometry.attributes.color.array[0+e],i.geometry.attributes.color.array[1+e],i.geometry.attributes.color.array[2+e]);o[t]=t}}}function t(e,n){e.addEventListener("click",(e=>{console.log("clicking hex");let t=e.target;t.classList.contains("hex")||(t=t.parentElement),t.classList.remove("jelloAnim"),t.offsetWidth,t.classList.add("jelloAnim"),function(e){Ln=e,console.log("set hex "+Ln)}(n)}))}let i=document.querySelectorAll(".hex");i[0].appendChild(C(jn("Grass_O1"))),t(i[0],1),i[1].appendChild(C(jn("Tree_N"),75,-75)),t(i[1],4),i[2].appendChild(C(jn("Grass_P1"))),t(i[2],2),i[3].appendChild(C(jn("Mount_N"),90)),t(i[3],3),i[4].appendChild(C(jn("Water_N"))),t(i[4],0),i[5].appendChild(C(jn("House_N"))),t(i[5],5),function(){qn();for(let e=0;e<32;e++){_n[e]=[];for(let n=0;n<32;n++)_n[e][n]=1}}(),Tn()})),function(){let e=new a.vBJ({color:4907322}),n=new a.ZAu,t=new a.BKK(.6,8),i=new a.Kj0(t,e);i.position.set(8,0,0),n.add(i);for(let e=0;e<6;e++){let t=i.clone();t.rotation.z=e*Math.PI/3,t.position.set(8*Math.cos(t.rotation.z),8*Math.sin(t.rotation.z),0),n.add(t)}n.position.z+=6,Pi(n),(En=n).visible=!1}(),function(){let e=8*Math.sqrt(3)/2;var n=new a.ZXM;for(let t=0;t<32;t++)for(let i=0;i<32;i++)n.vertices.push(new a.Pa4(-48+e+t*e*2+i*e,8*i*1.5-4,.8)),n.vertices.push(new a.Pa4(-48+e+t*e*2+i*e,4+8*i*1.5,.8)),n.vertices.push(new a.Pa4(-48+e+t*e*2+i*e,4+8*i*1.5,.8)),n.vertices.push(new a.Pa4(t*e*2-48+i*e,8+8*i*1.5,.8)),n.vertices.push(new a.Pa4(t*e*2-48+i*e,8+8*i*1.5,.8)),n.vertices.push(new a.Pa4(-48-e+t*e*2+i*e,4+8*i*1.5,.8));var t=new a.nls({color:16777215});Cn=new a.ejS(n,t)}(),function(){h=new a.xsS,(g=new a.cPb(45,1,1,1e3)).position.z=200,g.position.y=-200,g.up=new a.Pa4(0,0,1),g.lookAt(new a.Pa4(0,0,0));var e=new a.Mig(9408399);h.add(e)}(),function(e){(j=document.querySelector("#closeCard")).spot=-1,j.addEventListener("click",(e=>{Q()}));let n=document.querySelectorAll(".card");F=[],n.forEach((e=>{F.push(e)})),F.forEach(((e,n)=>{e.style.top=Math.random()*window.innerWidth+"px",e.style.left=Math.random()*window.innerHeight+"px",e.offset={x:0,y:0},e.appId=n,e.addEventListener("pointerdown",(n=>{!function(e,n){e.focused||(G=e,e.pos={x:parseInt(e.style.left),y:parseInt(e.style.top)},K={x:e.pos.x,y:e.pos.y},e.offset={x:e.pos.x-n.clientX,y:e.pos.y-n.clientY},e.classList.add("cardMove"),e.moving=void 0)}(e,n)})),e.addEventListener("dragstart",(e=>{e.preventDefault()}))})),window.addEventListener("pointerup",re),window.addEventListener("resize",$),window.addEventListener("pointermove",ie),function(){B=document.querySelector("#bar");let e=document.querySelector("#barHandle");e.addEventListener("pointerdown",(e=>{U=!0})),e.addEventListener("dragstart",(e=>{e.preventDefault()})),W=[],e.style.transform="translate(-50%,-200%)",B.style.left="50%",B.style.top=window.innerHeight-64+"px",ee(!0)}(),$(),ne()}(),O(),function(){let e=document.querySelector("#chatCard");(pe=document.createElement("div")).classList.add("chat-pane"),e.appendChild(pe),(he=document.createElement("div")).classList.add("chat-bottom"),ue=document.createElement("input");let n="0xffff55";n="#"+n.substring(2,n.length),ue.style.border=n+" 6px solid",he.appendChild(ue),Ce(he,"chat");let t=document.createElement("div");t.className="chat-send-button",t.addEventListener("click",Me),he.appendChild(t),e.appendChild(he),ue.addEventListener("keyup",(function(e){13==e.which?ue.value.length>0||"chat"==Le()?Me():setTimeout(Ne,20):27==e.which&&Ne()})),document.createElement("div").classList.add("letterPane")}(),Xi=document.querySelector(".settingsPane"),Ji("Toggle Hex Grid Lines",zn),Ji("Toggle Light Helper",Qn),Ji("Toggle Physics Mesh Helper",Ni),$n=document.querySelector("#makerBar"),rt.forEach((e=>{!function(e){let n=function(e){let n=document.createElement("div");return n.className="makerIcon",n}();n.setAttribute("data",e),n.addEventListener("click",(e=>{et=e.target.getAttribute("data")})),n.innerText=e,$n.appendChild(n)}(e)})),y("pot"),y("rock"),y("goblin","glb"),y("hedgehog","glb"),y("werewolf","glb"),y("vampire","glb"),y("zombie","glb"),w("assets/models/man.gltf",((e,n)=>{var t;e=e.children[0],(p=e).castShadow=!0,p.receiveShadow=!0,e.scale.set(2,2,2),n&&n.forEach((e=>{e.name&&(v[e.name]=e)})),b(e,[1,.2541521191596985,.022173885256052017],[0,0,1]),new a.Pa4(0,0,1),(t=a.rDY.merge([a.Vj0.phong.uniforms,{shirt:{value:new a.Pa4(0,1,0)},wind:{value:new a.Pa4(0,0,0)}}])).ambientLightColor.value=null,(u=new a.jyz({uniforms:t,derivatives:!1,lights:!0,vertexColors:!0,vertexShader:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec3 shirt;\nuniform vec3 wind;\n\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #ifdef USE_COLOR\n        if(color==vec3(0,0,1))\n            vColor.xyz = shirt;\n        else\n            vColor.xyz = color.xyz;\n        \n    #endif\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n    #ifdef USE_TANGENT\n        vTangent = normalize( transformedTangent );\n        vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n    #endif\n#endif\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    \n        if(color==vec3(1,0,0)){\n            float val=max(0.0, 1.0976 - transformed.z);\n            transformed.xyz+=val*wind;\n            transformed.y*=1.0+sin((wind.z+transformed.z)*4.0)/2.0;\n\n        }\n    \n\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n}",fragmentShader:"\n    #define STANDARD\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <roughnessmap_fragment>\n    #include <metalnessmap_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n    #include <lights_physical_fragment>\n    #include <lights_fragment_begin>\n    #include <lights_fragment_maps>\n    #include <lights_fragment_end>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n    #include <dithering_fragment>\n}"})).needsUpdate=!0,u.skinning=!0,x.man=p,u.onBeforeCompile=e=>{e.uniforms.shirt=man.children[1].material.uniforms.shirt,e.vertexShader="uniform vec3 shirt;\n"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>","\n                #ifdef USE_COLOR\n                    if(color.xyz == vec3(0,0,1)){\n                        vColor.xyz = vec3(1,1,0);\n                    }else{\n                        vColor.xyz = color.xyz;\n                    }\n                #endif")}})),w("assets/models/gran.gltf",((e,n)=>{(e=e.children[0]).castShadow=!0,e.receiveShadow=!0,e.scale.set(2,2,2),b(e,[.42869052290916443,.262250691652298,.4677838087081909],[0,0,1]),new a.Pa4(0,0,1),x.gran=e})),function(){var e;(e=document.createElement("style")).innerHTML='\n.drawer-group{\n    position: absolute;\n    top: -204px;\n    width: 128px;\n    left: 50%;\n    transform: translate(-50%,-50%);\n}\n.drawer {\n    display:block;\n    width: 128px;\n    height: 128px;\n    position: relative;\n    border-radius: 8px;\n    border: gray solid 1px;\n    image-rendering: pixelated;\n    touch-action: none;\n    background-color: #5555;\n}\n\n.drawer-top{\nposition: relative;\npointer-events: none;\nwidth: 156px;\n}\n.drawer-top *{\n    pointer-events: initial;\n}\n\n.drawer-paint,\n.drawer-trash,\n.drawer-download {\n    width: 24px;\n    height: 24px;\n    border-radius: 12px;\n    display: inline-block;\n    border: gray solid 1px;\n    box-sizing: border-box;\n    animation: 0.2s;\n}\n\n\n.drawer-trash {\n    border: none;\n    background-position: center center;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v10zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>\');\n}\n\n.drawer-download {\n    border: none;\n    background-size: cover;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M11 5v11.17l-4.88-4.88c-.39-.39-1.03-.39-1.42 0-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0L13 16.17V5c0-.55-.45-1-1-1s-1 .45-1 1z"/></svg>\');\n}\n.drawer-opener{\n    width:48px;\n    height: 48px;\n    border-radius:24px !important;\n    background-color: white;\n    position: relative;\n    display: inline-block;\n    background-size: 32px;\n    background-position: center center;\n    background-repeat: no-repeat;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.9 13.98l2.1 2.53 3.1-3.99c.2-.26.6-.26.8.01l3.51 4.68c.25.33.01.8-.4.8H6.02c-.42 0-.65-.48-.39-.81L8.12 14c.19-.26.57-.27.78-.02z"/></svg>\');\n}\n.stretch-image{\n    width: 64px;\n    height 64px;\n}\n',document.body.appendChild(e),se=document.querySelector(".drawer-group"),(ce=se.querySelector(".drawer")).setAttribute("width","32px"),ce.setAttribute("height","32px"),ce.addEventListener("pointerdown",fe),ce.addEventListener("pointermove",ve),window.addEventListener("pointerup",xe),(le=ce.getContext("2d")).imageSmoothingEnabled=!1;let n=se.querySelector(".drawer-top"),t=Se("drawer-paint");t.style.backgroundColor="black",t.addEventListener("pointerup",ke);let i=Se("drawer-paint");i.style.backgroundColor="red",i.addEventListener("pointerup",ke);let o=Se("drawer-paint");o.style.backgroundColor="#65BB00",o.addEventListener("pointerup",ke);let r=Se("drawer-paint");r.style.backgroundColor="white",r.addEventListener("pointerup",ke);let a=Se("drawer-download");a.addEventListener("pointerup",ye);let l=Se("drawer-trash");l.addEventListener("pointerup",we),n.appendChild(t),n.appendChild(i),n.appendChild(o),n.appendChild(r),n.appendChild(a),n.appendChild(l),document.onpaste=function(e){var n=(e.clipboardData||e.originalEvent.clipboardData).items;let t;for(t in console.log(JSON.stringify(n)),n){var i=n[t];if("file"===i.kind){var o=i.getAsFile(),r=new FileReader;r.onload=function(e){var n=new Image;n.onload=function(){Ee(n)},n.src=e.target.result},r.readAsDataURL(o)}}}}();let e=setInterval((function(){var n;f<=0&&((n=document.createElement("style")).innerHTML="\n    #equipment-bar{\n        position: absolute;\n        border-radius: 16px;\n        background-color: #fff5;\n        border-radius: 16px;\n        min-height: 128px;\n        max-height: 60%;\n        width: 512px;\n        bottom: 96px;\n        left: 50%;\n        transform: translate(-50%);\n        overflow-x: hidden;\n        overflow-y: auto;\n        touch-action: none;\n        pointer-events:auto;\n    }\n    .equipment-item{\n        user-select: none;\n        border-radius: 8px;\n        background-color: white;\n        display: inline-block;\n        min-height: 16px;\n        min-width: 16px;\n        max-width: 200px;\n        margin: 8px;\n        box-sizing: border-box;\n    }\n    .equipment-item-selected{\n        border: dashed white 3px;\n        opacity: 0.5;\n    }\n    .equipment-item h4{\n        display:block;\n        margin:6px;\n    }\n    .equipment-item p{\n        display: inline-block;\n        margin: 16px;\n    }\n    .equipment-icon{\n        min-width: 48px;\n        min-height: 48px;\n        border-radius: 8px;\n        background-color: gray;\n        display: inline-block;\n    }\n    #pseduo-dragger{\n        position: absolute;\n        pointer-events: none;\n    }",document.body.appendChild(n),nt=document.querySelector("#equipmentCard"),it=nt.querySelector("#equipment-bar"),tt=nt.querySelector("#pseduo-dragger"),window.addEventListener("pointermove",(e=>{ot&&lt(e)})),window.addEventListener("pointerup",(e=>{})),st("A Man","Good boi","man"),st("Cool Rock","It's a cool rock","rock"),st("Pot","420","pot"),function(){var e;Be=document.querySelector("#characterCard"),(e=document.createElement("style")).innerHTML='\n    [contenteditable="true"]:active,\n[contenteditable="true"]:focus{\n  border:none;\n  outline:none;\n}\n\n[contenteditable="true"]::before{\n    color:#5555;\ncontent:"::";\n}\n[contenteditable="true"]::after{\n    color:#5555;\n    text-align: right;\ncontent:"::";\n}\n\n[type="checkbox"]{\n    margin:0 !important;\n}\n\ninput::-webkit-outer-spin-button,\ninput::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n}\n\n/* Firefox */\ninput[type=number] {\n    -moz-appearance: textfield;\n}\n\n\n.sheet {\n    display: flex;\n    position: absolute;\n    border-radius: 16px;\n    background-color: white;\n    box-shadow: 6px 6px 1px #0005;\n    margin: 0 32px;\n    flex-direction: row;\n    flex-wrap: wrap;\n    align-items: flex-start;\n    align-content: flex-start;\n    overflow-y: auto;\n    max-height: calc(100% - 200px);\n    font-family: openBold;\n}\n.sub-section{\n    display: flex;\n    flex: 1;\n    flex-direction: row;\n    flex-wrap: wrap;\n    align-items: flex-start;\n    align-content: flex-start;\n}\n\n.section {\n    font-size: 16px;\n    width: 300px;\n    border-radius: 16px;\n    background-color: #F5F0E5;\n    box-shadow: 6px 6px 1px #0005;\n    flex: 3 1 1;\n    margin: 16px;\n    min-height: 96px;\n}\n.section *{\n    border-radius: 16px;\n}\n.section-banner{\n    text-align: center;\n    position: relative;\n    font-size: 24px;\n    background-color: inherit;\n    box-shadow: inherit;\n    border-radius: 4px;\n    padding: 8px;\n    letter-spacing: 6px;\n    width: 100%;\n    left: 50%;\n    border: 6px outset gray;\n    border-style: none groove none groove;\n    transform: translate(-50%);\n}\n\n.section-item {\n    height: 32px;\n    box-shadow: 6px 6px 1px #0005;\n    padding: 16px;\n    position: relative;\n    background-color: #83D943;\n}\n\n.number {\n    color: inherit;\n    font: inherit;\n    width: auto;\n    outline: none;\n    border: none;\n    background-color: transparent;\n    padding: 0;\n    text-align: center;\n    max-width: 64px;\n    font-size: 32px;\n}\n\n\n\n.section-item-label {\n    position: absolute;\n    left: 16px;\n    top: 16px;\n}\n\n.STR {\n    background-color: #FF1B71 !important;\n    color: #8B1944 !important;\n}\n\n.DEX {\n    background-color: #8BFF36 !important;\n    color: #697F1E !important;\n}\n\n.CON {\n    background-color: #E9EE6A !important;\n    color: #76602C !important;\n}\n\n.INT {\n    background-color: #730FB2 !important;\n    color: #FDC3FF !important;\n}\n\n.WIS {\n    background-color: #FFA81F !important;\n    color: #FFFEB6 !important;\n}\n\n.CHR {\n    background-color: #FFA3A3 !important;\n    color: #8800AF !important;\n}\n\n.section-item-saving-throw {\n    border: white solid 3px;\n    width: 64px;\n    height: 64px;\n    position: absolute;\n    right: 0;\n    top: 0;\n    box-sizing: border-box;\n    border-radius: 16px;\n    font-size: 24px;\n    text-align: center;\n    line-height: 24px;\n}\n\n.section-item-saving-throw::before {\n    line-height: 102px;\n    top: -10px;\n    color: white;\n    font-size: 16px;\n    content: \'S.T.\'\n}\n\n.section-group{\n    border-radius: 16px;\n    background-color: #5555;\n    margin: 16px;\n\n}\n .section-group *{\n    pointer-events: none;\n}\n\n\n.section-skills {}\n.section-stats {\n}\n.section-status *{\n    margin: 8px;\n}\n.section-character{\n\n}\n.section-traits{\n\n}\n.section-personality{\n\n}\n.section-other{\n\n}\n\n.skill-item {\n    border-radius: 16px;\n    height: 24px;\n    box-shadow: 6px 6px 1px #0005;\n    padding: 8px;\n    position: relative;\n    background-color: #8DA4EE;\n    margin: 16px;\n}\n.skill-item .number{\n    font-size: initial;\n}\n.skill-item-icon {\n    border-radius: 16px 8px 8px 16px;\n    width: 40px;\n    height: 40px;\n    position: absolute;\n    top: 0;\n    left: -1px;\n    background-color: white;\n    background-size: 40px;\n    background-image: url(\'./spell.png\');\n}\n\n.skill-item .number {\n    position: absolute;\n    right: 32px;\n}\n\n.skill-item-label {\n    display: inline-block;\n    margin-left: 48px;\n    content: \'hello\'\n}\n\n/**********/\n.section-group-mini .skill-item{\n    width: 64px;\n    display: inline-block;\n    margin:4px;\n}\n.section-group-mini .skill-item-label{\n    display: none;\n}\n.section-group-mini .number{\n    right:0;\n}\n/*********/\n\n\n.feature{\n    max-height: 96px;\n    overflow-y: scroll;\n    background-color: #B6E0D1;\n   padding: 1px 16px 16px 16px;\n   margin: 8px;\n   color: gray;\n   position: relative;\n}\n.feature p{\n    margin: 0 16px 0 16px;\n    font-family: open;\n}\n\n.feature-name{\n    font-size: 22px;\n    display: inline-block;\n    font-style: italic;\n    color: black;\n    margin: 0 8px 0 8px;\n}\n.feature-middle{\n    font-size: 18px;\n    font-style: italic;\n    text-align: center;\n    color: gray;\n}\n\n\n.feature-tag{\n    border-radius: 16px;\n    background-color: lightgreen;\n    font-weight: bold;\n    display: inline-block;\n    padding: 0 16px 0 16px;\n    box-sizing: border-box;\n    border: solid white 2px;\n}\n.trait{\n    background-color: #8BBDEB\n}\n\n.spell{\n    background-color: #E3C5E3\n}\n\n.feature input{\n    position: absolute;\n    right: 12px;\n    top: 12px;\n\n}\n.feature input::after{\n    color: gray;\n    font-size: 10px;\n    content: \'spell?\';\n    position: relative;\n    left: -28px;\n    top: -6px;\n}\n\n.feature-add,.lil-add{\n        position: relative;\n        width:36px;\n        height:36px;\n        background-color: #FAFABC;\n        border-radius: 28px;\n        margin:18px 0 18px 0;\n        cursor: pointer;\n        pointer-events: auto;\n        left: 50%;\n        transform: translate(-50%);\n\n        background-image: url("data:image/svg+xml,<svg width=\'36\' height=\'36\' stroke=\'black\' stroke-width=\'6\' stroke-linecap=\'round\' viewBox=\'0 0 36 36\' xmlns=\'http://www.w3.org/2000/svg\'><path d=\'m9 18 h 18M18 9v18\'/></svg>");\n        \n    }\n    .lil-add{\n        width:24px;\n        height:24px;\n        background-size: cover;\n        left: auto;\n        transform: none;\n    }\n\n\n/************/\n\n.floater-number-input {\n    position: absolute;\n    width: 144px;\n    height: 48px;\n    /*border:black 3px solid;*/\n}\n\n.floater-arrow {\n    z-index: 99;\n    width: 48px;\n    height: 48px;\n    border-radius: 24px;\n    background-color: #5558;\n    position: absolute;\n    left: 0;\n    top: 0;\n    display: inline-block;\n    animation: 0.3s;\n    background-repeat: no-repeat;\n    background-size: 32px;\n    background-position: center center;\n\n\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M14.71 6.71c-.39-.39-1.02-.39-1.41 0L8.71 11.3c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L10.83 12l3.88-3.88c.39-.39.38-1.03 0-1.41z"/></svg>\');\n\n}\n\n.floater-number-input .floater-arrow:nth-child(1) {\n    left: 96px;\n    transform: rotate(180deg);\n}\n\n/*.floater-arrow::after{\n            content: \'\';\n            background-color: red;\n            width: 16px;\n            height: 16px;\n            display: block;\n            position: absolute;\n            left: 48px;\n            top: 50%;\n            border-radius: 8px;\n            transform: translate(0,-50%);\n        }\n\n        .floater-arrow::before{\n            width: 48px;\n            height: 2px;\n            border-radius: 8px;\n            content: \'\';\n            display: block;\n            background-color: green;\n            position: absolute;\n            left: 24px;\n            top: 50%;\n            transform: translate(0,-50%);\n        }*/\n\n@keyframes blinker {\n    0% {\n        background-color: #fff6;\n    }\n\n    50% {\n        background-color: #0004;\n    }\n\n    100% {}\n}\n\n.editable-number {\n    width: 48px;\n    height: 48px;\n    box-sizing: border-box;\n    border-radius: 24px;\n    border: #fff7 dotted 3px;\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 0;\n\n    overflow: visible;\n    transition: 0.1s transform;\n}\n\n.editable-number::before {\n    content: \'\';\n    width: 24px;\n    height: 24px;\n    display: block;\n    position: absolute;\n    left: 32px;\n    top: -8px;\n\n    background-repeat: no-repeat;\n    background-size: 24px;\n    background-position: center center;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>\');\n}\n\n\n.selected {\n\n    box-shadow: 12px 6px 0px white;\n}\n\n.selected::after {\n    content: \'\';\n    right: 0px;\n    top: 8px;\n    width: 24px;\n    height: 24px;\n    position: absolute;\n    display: block;\n    background-position: center center;\n    background-size: 24px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" fill="white" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>\');\n}\n\n.section-dashed-line {\n    height: 0;\n    margin: 16px;\n    border-bottom: 3px dashed black;\n    border-radius:0;\n}\n\n.centered {\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n}\n\n.status-hitpoints{\n    height: 64px;\n    background-color: #EE9A9A;\n    background-position: left center;\n    background-repeat: no-repeat;\n    background-size: 64px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" fill="white" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M13.35 20.13c-.76.69-1.93.69-2.69-.01l-.11-.1C5.3 15.27 1.87 12.16 2 8.28c.06-1.7.93-3.33 2.34-4.29 2.64-1.8 5.9-.96 7.66 1.1 1.76-2.06 5.02-2.91 7.66-1.1 1.41.96 2.28 2.59 2.34 4.29.14 3.88-3.3 6.99-8.55 11.76l-.1.09z"/></svg>\');\n}\n\n.status-initiative,.status-armor,.status-speed{\n    display: inline-block;\n    width:64px;\n    height: 64px;\n    background-position: center center;\n    background-repeat: no-repeat;\n}\n.status-initiative .number,.status-armor .number,.status-speed .number{\n    color: white;\n    font-size: 24px;\n    position: relative;\n}\n.status-initiative{\n    background-size: 82px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="rgb(170, 68, 0)" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 17.27l5.17 3.12c.38.23.85-.11.75-.54l-1.37-5.88 4.56-3.95c.33-.29.16-.84-.29-.88l-6.01-.51-2.35-5.54c-.17-.41-.75-.41-.92 0L9.19 8.63l-6.01.51c-.44.04-.62.59-.28.88l4.56 3.95-1.37 5.88c-.1.43.37.77.75.54L12 17.27z"/></svg>\');\n}\n.status-armor{\n    background-size: 64px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24" fill="rgb(35, 79, 35)"><g><rect fill="none" height="24" width="24"/><path d="M12,1L3,5v6c0,5.55,3.84,10.74,9,12c5.16-1.26,9-6.45,9-12V5L12,1L12,1z"/></g></svg>\'); /*fill="#224E22"     rgb(35, 79, 35)*/\n}\n.status-speed{\n    background-size: 86px;\n    background-position: center center;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" fill="rgb(30, 70, 178)" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3.5 18.99l11 .01c.67 0 1.27-.33 1.63-.84L20.5 12l-4.37-6.16c-.36-.51-.96-.84-1.63-.84l-11 .01L8.34 12 3.5 18.99z"/></svg>\');\n}\n\n.status-dice{\n    background-color: #8CEB8C;\n    height: 64px;\n    background-size: 64px;\n    background-position: center center;\n    background-position: left center;\n    background-repeat: no-repeat;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" fill="white" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 3h-4.18H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-6 15h-2v-2h2v2zm0-5c0 .55-.45 1-1 1s-1-.45-1-1V9c0-.55.45-1 1-1s1 .45 1 1v4zm-1-8c-.55"/></svg>\');\n}\n.saving-row{\n\n    position: relative;\n    text-align: right;\n}\n\n/*************/\n.character-picture{\n    width:212px;\n    height: 256px;\n    background-color: #17D1FF;\n    display: inline-block;\n}\n.character-column{\n    width:64px;\n    display: inline-block;\n    position: absolute;\n\n}\n\n.character-proficiency{\n    display: inline-block;\n    width:64px;\n    height: 64px;\n    position: relative;\n    left: 0;\n    top: 0;\n    background-color: #ECD4EC;\n}\n.character-inspiration{\n    display: inline-block;\n    width:64px;\n    height: 64px;\n    position: relative;\n    right: 0;\n    top: 0;\n    background-color: #5555;\n}\n.character-inspiration img{\n    width: 100%;\n    height: 100%;\n}\n.character-class{\n    display: block;\n    margin: 6px;\n    position: relative;\n    text-align: center;\n    font-size: 18px;\n    color: gray;\n}\n/***********************/\n\n.sheet-nav{\n    position: relative;\n    height: 96px;\n    overflow-x: auto;\n    overflow-y: hidden;\n    width: calc(100% - 88px);\n    transform: translate(-50%);\n    left: 50%;\n    white-space: nowrap;\n}\n.sheet-user{\n    position: relative;\n    display: inline-block;\n    border-radius: 28px;\n    background-color: green;\n    height: 56px;\n    width: 56px;\n    top: 0;\n    margin: 8px 8px 0 8px;\n}\n.sheet-user span{\n    border-radius: 16px;\n    position: absolute;\n    bottom: -10px;\n    left: 50%;\n    transform: translate(-50%);\n    background-color: #fff5;\n}\n\n.sheet-selected::before{\n    position: absolute;\n    display: block;\n    background-color: white;\n    top: -10px;\n    height: 112px;\n    width: 64px;\n    border-radius: 16px;\n    content: \'\';\n    z-index: -1;\n    left: 50%;\n    transform: translate(-50%);\n}\n\n#sheet-edit-button{\n     position: fixed;\n        width:56px;\n        height:56px;\n        background-color: #FAFABC;\n        border-radius: 28px;\n        cursor: pointer;\n        pointer-events: auto;\n        right: 102px;\n        bottom: 108px;\n        background-size: 48px;\n        background-position: center center;\n        box-shadow: 6px 6px 1px #0005;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>\');\n}\n#sheet-edit-button.toggled{\n    background-color: #16FF16;\n\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M9 16.17L5.53 12.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0L9 16.17z"/></svg>\');\n}',document.body.appendChild(e);let n=Be.querySelector(".section-stats");Re=n,We=Be.querySelector(".section-other"),Ve=Be.querySelector(".section-traits"),De=Be.querySelector(".section-personality"),Pe=Be.querySelector(".section-status"),Oe=Be.querySelector(".section-character");let t=$e("STR","Strength"),i=$e("DEX","Dexterity"),o=$e("CON","Constitution"),r=$e("INT","Intelligence"),a=$e("WIS","Wisdom"),l=$e("CHR","Charisma"),s=un("section-group section-group-mini"),c=un("section-group section-group-mini"),d=un("section-group section-group-mini"),p=un("section-group section-group-mini"),u=un("section-group section-group-mini"),h=un("section-group section-group-mini");s.appendChild(t),c.appendChild(i),d.appendChild(o),p.appendChild(r),u.appendChild(a),h.appendChild(l),n.appendChild(s),n.appendChild(c),n.appendChild(d),n.appendChild(p),n.appendChild(u),n.appendChild(h),Fe.forEach(((e,n)=>{let t=function(e,n,t,i){let o=un("skill-item");o.classList.add(n),o.type=n;let r=un("skill-item-icon");r.style.backgroundImage=" url('./assets/"+i+"')";let a=un("skill-item-label");a.innerText=t;let l=document.createElement("input");return l.className="number",l.value=0,l.type="number",l.min=-5,l.max=10,o.appendChild(r),o.appendChild(a),o.appendChild(l),o.skillId=e,o}(n,e[0],e[1],e[2]);switch(e[0]){case"STR":s.appendChild(t);break;case"DEX":c.appendChild(t);break;case"CON":d.appendChild(t);break;case"INT":p.appendChild(t);break;case"WIS":u.appendChild(t)}})),s.addEventListener("click",gn),c.addEventListener("click",gn),d.addEventListener("click",gn),p.addEventListener("click",gn),u.addEventListener("click",gn),h.addEventListener("click",gn),window.addEventListener("keyup",(e=>{27==e.keyCode&&(Ke?nn():tn(),Ke=!Ke)})),function(){Be.querySelector(".section-status");let e=un("status-armor"),n=un("status-initiative"),t=un("status-speed"),i=hn(0,10),o=hn(0,10),r=hn(0,10);i.innerText=10,r.innerText=10,o.innerText=10,e.appendChild(o),t.appendChild(i),n.appendChild(r);let a=Be.querySelector(".status-row");a.appendChild(e),a.appendChild(n),a.appendChild(t);let l=Pe.querySelector(".status-hitpoints"),s=hn(0,30),c=hn(0,30);l.appendChild(s),l.appendChild(c)}(),Ue=We.querySelector(".feature-add"),je=Ve.querySelector(".feature-add"),Ue.addEventListener("click",(e=>{let n=function(){let e=un("feature"),n=document.createElement("p");return n.setAttribute("contenteditable",!0),e.appendChild(n),e}();We.insertBefore(n,Ue)})),je.addEventListener("click",(e=>{let n=en();Ve.insertBefore(n,je)}));let g=Oe.querySelector(".character-proficiency"),m=un("centered");m.appendChild(hn(2,6)),g.appendChild(m),Be.querySelector("#sheet-edit-button").addEventListener("click",(e=>{Ke?(nn(),e.target.classList.add("toggled")):(tn()&&q("Saved Character!","success"),e.target.classList.remove("toggled")),Ke=!Ke}));let f=Oe.querySelector(".character-inspiration");(Ye=Ce(f,"character",(function(e){let n=Oe.querySelector(".character-inspiration").querySelector("img");e?Ee(n):n.src=_e()}))).style.position="absolute",Ye.style.right="-16px",Ye.style.bottom="-16px",Oe.querySelector(".character-picture").src=L("man"),tn(!0)}(),clearInterval(e))}),1e3)}()}},0,[[111,666,977]]]);