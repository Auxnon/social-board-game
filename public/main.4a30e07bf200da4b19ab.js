(self.webpackChunkbuup=self.webpackChunkbuup||[]).push([[179],{838:(t,e,n)=>{"use strict";n.d(e,{a:()=>vn});var o={};n.r(o),n.d(o,{_O:()=>ge,S1:()=>Xt,Z2:()=>xe,Qc:()=>we,A$:()=>Qt,V8:()=>se,KT:()=>le,LP:()=>$t,W1:()=>Jt,D9:()=>de});var i={};n.r(i),n.d(i,{mS:()=>rn,n6:()=>sn,UX:()=>an,bK:()=>dn,GI:()=>pn,S1:()=>$e,u7:()=>en,hM:()=>Ve,gw:()=>ln,SI:()=>nn,ob:()=>hn,j3:()=>tn});var a,r,s=n(642);function l(t){t.startsWith("0x")&&(t=t.substring(1));let e=0,n=0,o=0;return 4==t.length?(e="0x"+t[1]+t[1],n="0x"+t[2]+t[2],o="0x"+t[3]+t[3]):7==t.length&&(e="0x"+t[1]+t[2],n="0x"+t[3]+t[4],o="0x"+t[5]+t[6]),[parseInt(e),parseInt(n),parseInt(o)]}function c(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function d(t){let e=.299*t[0]+.587*t[1]+.114*t[2];return console.log(e),e>186}function p(t,e,n){e?t.scale.set(e,e,e):t.scale.set(110,110,110),n?t.position.set(0,0,n):t.position.set(0,0,-30),a.add(t);let o=document.createElement("img");return o.className="hexPortrait",o.setAttribute("src",an(a,r)),a.remove(t),o}var u=n(321);let h,m,f;function g(t,e,n){let o=document.createElement("div");o.className="uiSysTop";let i=document.createElement("div"),a=" ";if("object"==typeof e&&null!==e)e.type&&(a+=e.type),e.color&&(o.style.backgroundColor=e.color);else switch(e){case"warn":a+="uiIconWarning",o.style.backgroundColor="#EFEF79";break;case"error":a+="uiIconError",o.style.backgroundColor="#D25E5E";break;case"net":a+="uiIconNet",o.style.backgroundColor="#FFC65E";break;case"person":a+="uiIconPerson",o.style.backgroundColor="#D257FF";break;case"time":a+="uiIconTime",o.style.backgroundColor="#5094D9";break;case"success":a+="uiIconSuccess",o.style.backgroundColor="#95F17F"}i.className="uiIcon"+a;let r=document.createElement("span");function s(){o.style.animation=n?"0.5s uiSysMini forwards":"0.5s uiSysFold forwards",setTimeout((function(){n?(o.style.position="absolute",o.style.left="-64px",o.addEventListener("click",(function(t){o.style.animation="0.5s uiSysMax forwards",setTimeout((function(){o.style.animation="0.5s uiSysMini forwards"}),3500)}))):o.remove()}),500)}if(r.innerText=t,r.addEventListener("click",(function(t){!function(t){f.value=t.innerText,f.style.display="block",f.select(),document.execCommand("copy"),f.blur(),f.style.display="none"}(r),function(t,e,n){let o=document.createElement("div");o.className="uiCursorMessage",o.style.left=t+"px",o.style.top=e+"px",o.innerText="Copied",h.appendChild(o),setTimeout((function(){o.style.animation="1s uiFade forwards",setTimeout((function(){o.remove()}),1e3)}),1500)}(t.clientX,t.clientY)})),o.appendChild(i),o.appendChild(r),!n){let t=document.createElement("div");t.className="uiCloseButton",o.appendChild(t),t.addEventListener("click",(function(t){s()}))}return setTimeout((function(){s()}),3500),m.appendChild(o),o}var v,y,x,w,b,_,E;function k(){return y}function z(){return parseInt("0x"+y.color.substring(1))}var L,S,C,M,T,A=!1,P=1,H=!1,I=0,N=void 0,F={x:0,y:0};function q(t){let e=w[t];e&&(e.classList.add("cardMax"),e.focused=!0,e.style.zIndex=0,Object.values(e.children).forEach((t=>{"card-notifier"==t.className?t.remove():t.style.display="initial"})),"landscapeCard"==e.id?$t(!0):$t(!1),"chatCard"==e.id&&(xe(),T.focus()),-1==e.spot?(C.style.top="32px",C.style.left="32px"):(C.style.top=e.style.top,C.style.left=e.style.left),C.style.opacity="1",C.style.pointerEvents="auto",E=e)}function R(){E&&(E.classList.remove("cardMax"),E.style.zIndex=2,E.focused=void 0,Qt(),$t(!1),Object.values(E.children).forEach((t=>{"card-notifier"==t.className?t.style.display="initial":t.style.display="none"})),C.style.opacity="0",C.style.pointerEvents="none"),H&&(H=!1,V())}function B(){clearTimeout(S),S=setTimeout((function(){V(),nn()}),250)}function W(t){let e=0,n=[],o=0==P||2==P;t?(e=w.length,n=w):w.forEach((t=>{-1!=t.spot&&(n.push(t),e++)})),o?(b.style.height=64*(e>0?e:1)+"px",b.style.width="82px"):(b.style.width=64*(e>0?e:1)+"px",b.style.height="82px");let i=b.getBoundingClientRect();_=i;let a,r=i.width,s=i.height;a=o?s/e:r/e,t||(o?n.sort((function(t,e){return parseInt(t.style.top)-parseInt(e.style.top)})):n.sort((function(t,e){return parseInt(t.style.left)-parseInt(e.style.left)})));for(let p=0;p<e;p++)L[p]=o?{x:i.left+r/2,y:32+i.top+p*a}:{x:32+i.left+p*a,y:i.top+s/2},N&&N==n[p]&&(F=L[p]),t&&(w[p].spot=p,L[p].app=n[p]),l=n[p],c=L[p].x,d=L[p].y,void 0||(l.pos={x:c,y:d}),l.style.left=c+"px",l.style.top=d+"px";var l,c,d;let p=barHandle.getBoundingClientRect();if(o){let t=p.left+p.width/2;O({x:t,y:p.top},{x:t,y:p.bottom})}else{let t=p.top+p.height/2;O({x:p.left,y:t},{x:p.right,y:t})}}function j(){requestAnimationFrame(j)}function O(t,e){t.x,t.y,e.x,e.y}function D(t){if(function(t){if(A){I++;let e=t.clientX,n=t.clientY,o=window.innerWidth/2,i=window.innerHeight/2,a=e-o,r=n-i,s=o-Math.abs(a)<10,l=i-Math.abs(r)<10,c=Math.atan2(r,a)/Math.PI,d=Math.abs(c);d<.25?(2!=P&&(P=2,V()),s!=H&&(H=s,V())):d<.75?(c<0?3!=P&&(P=3,V()):1!=P&&(P=1,V()),l!=H&&(H=l,V())):(0!=P&&(P=0,V()),s!=H&&(H=s,V()))}}(t),N){if(I++,N.pos={x:t.clientX+N.offset.x,y:t.clientY+N.offset.y},t.clientY>_.top&&t.clientY<_.bottom&&t.clientX>_.left&&t.clientX<_.right){let t=F,e={x:t.x-N.pos.x,y:t.y-N.pos.y};N.pos={x:t.x-e.x/3,y:t.y-e.y/3},N.moving&&(N.moving=void 0,N.spot=0,W())}else N.moving||(N.moving=!0,N.spot=-1,W());N.style.left=N.pos.x+"px",N.style.top=N.pos.y+"px"}}function V(){2==P?(b.style.left=window.innerWidth-(H?-32:48)+"px",b.style.top="50%",W(),barHandle.style.transform="translate(-200%,-50%)",barHandle.style.width="32px",barHandle.style.height="80%",b.style.borderWidth="0px 0px 0px 6px",$(!1)):3==P?(barHandle.style.transform="translate(-50%,100%)",b.style.left="50%",b.style.top=(H?-32:48)+"px",W(),barHandle.style.height="32px",barHandle.style.width="80%",b.style.borderWidth="0px 0px 6px 0px",$(!1)):1==P?(barHandle.style.transform="translate(-50%,-200%)",b.style.left="50%",b.style.top=window.innerHeight-(H?-32:48)+"px",W(),barHandle.style.height="32px",barHandle.style.width="80%",b.style.borderWidth="6px 0px 0px 0px",$(!0)):(barHandle.style.transform="translate(100%,-50%)",b.style.left=(H?-32:48)+"px",b.style.top="50%",W(),barHandle.style.width="32px",barHandle.style.height="80%",b.style.borderWidth="0px 6px 0px 0px",$(!1))}function Y(t){A&&(A=!1,console.log(I),I<10&&R()),N?(N.classList.remove("cardMove"),I<20?(E&&E==N&&(N.classList.remove("cardMax"),N.focused=void 0,E=void 0,N.style.zIndex=2),R(),q(N.appId)):(W(),console.log("fix bar also"))):(W(),console.log("fix bar")),N=void 0,I=0}var U,G=-1,X=null,K=-1;function J(t,e){let n=function(t){return v[t]}(t);n||(n={username:"Unknown",id:-1,color:"black"}),function(t,e,n){let o=document.createElement("p"),i=e.color;o.style.backgroundColor=i;let a=d(l(i));o.style.color=a?"#000000":"#FFFFFF",o.style.textShadow="1px 1px 2px "+(a?"#FFFFFF":"#000000"),o.innerHTML=t;{let t=document.createElement("div");if(t.classList.add("chat-row"),e.id==k().id&&t.classList.add("chat-right"),o.classList.add("chat-bubble"),K>=0&&K==e.id)G==e.id?(X.classList.remove("chat-bubble-footer"),X.classList.add("chat-bubble-body")):X.classList.add("chat-bubble-header"),o.classList.add("chat-bubble-footer");else{let t=document.createElement("p");t.classList.add("chat-nametag"),t.innerHTML=e.username;let n=document.createElement("div");e.id==k().id&&(n.style.textAlign="right"),n.appendChild(t),M.appendChild(n)}G=K,X=o,K=e.id,t.appendChild(o),M.appendChild(t),M.scrollTop=M.scrollHeight}}(e,n),function(t,e){let n=w[2];if(!n.focused){let t=n.querySelector(".card-notifier");t?t.innerText=parseInt(t.innerText)+1:(t=document.createElement("div"),t.className="card-notifier",n.appendChild(t),t.innerText=1),n.style.animation="",n.offsetWidth,n.style.animation="attention 0.2s"}}()}function Z(){T.blur(),R(),we(!1)}function Q(t){let e=document.createElement("div");e.className="chat-divider";let n=document.createElement("p");n.innerText=t,e.appendChild(n),M.appendChild(e)}function $(t){t?(M.style.height="calc(100vh - 100px)",document.querySelector(".chat-bottom").style.bottom="100px"):(M.style.height="calc(100vh - 64px)",document.querySelector(".chat-bottom").style.bottom="0px")}var tt,et=!1;function nt(t,e,n,o,i,a){U.emit("physMake",t,e,n,o,i,a)}function ot(t){t||(t="test"),U.emit("message",t)}function it(t,e){U.emit("sendPhys",{id:t.id,position:t.position,velocity:t.velocity,quaternion:t.quaternion,angularVelocity:t.angularVelocity},e)}var at=[],rt=[],st=[];var lt,ct,dt,pt=2;function ut(t,e,n){st[t][e]=n,ht()}function ht(){zt=6,ft();for(let e=0;e<st.length;e++)for(let n=0;n<st.length;n++){let o=st[e][n],i=Math.floor(Lt(1,4)),a=Math.floor(Lt(1,6));if(1!=o){let i,r,s,l,c,d;i=e>0?st[e-1][n]:0,r=e<st.length-1?st[e+1][n]:0,n<st.length-1?(s=e>0?st[e-1][n+1]:0,l=st[e][n+1]):(s=0,l=0),n>0?(c=st[e][n-1],d=e<st.length-1?st[e+1][n-1]:0):(c=0,d=0),i=i==o,r=r==o,l=l==o,d=d==o,c=c==o,s=s==o;let p=-1,u=0,h=[],m=5;[s,l,r,d,c,i].forEach(((t,e)=>{t?(h.push(e),-1==p&&(p=e),u=e):m=e}));let f="N",g="";if(6==h.length)mt(o,"H"+g,e,n,Math.floor(a));else if(h.length>0){let i=[];var t=h[0];for(let e=1;e<h.length;e++)i.push(h[e]-t-1),t=h[e];let a=-1==p?0:p;switch(h.length){case 1:f="E",a+=0;break;case 2:f="P",0==i[0]?(g="3",a+=0):1==i[0]?(g="2",a+=0):2==i[0]?(g="1",a+=0):3==i[0]?(g="2",a+=4):(g="3",a+=5);break;case 3:f="T",0==i[0]?0==i[1]?(g=1,a+=0):3==i[1]?(g=1,a+=5):1==i[1]?(g=3,a+=3):2==i[1]&&(g=2,a+=4):1==i[0]?0==i[1]?g=2:1==i[1]?g=4:2==i[1]&&(g=3,a+=2):2==i[0]?0==i[1]?(g=3,a+=0):1==i[1]&&(g=2,a+=3):(g=1,a+=4),a%=6;break;case 4:f="Q",0==i[0]?0==i[1]?0==i[2]?(g=1,a+=0):1==i[2]?(g=3,a+=2):2==i[2]&&(g=1,a+=5):1==i[1]?0==i[2]?(g=2,a+=4):1==i[2]&&(g=3,a+=1):(g=1,a+=4):1==i[0]?0==i[1]?0==i[2]?(g=3,a+=4):g=2:g=3:(g=1,a+=3),a%=6;break;case 5:f="F",a=m+1}mt(o,f+g,e,n,a)}else mt(o,"N",e,n,0)}else 1==o&&mt(o,"O"+i,e,n,Math.floor(a))}}function mt(t,e,n,o,i){let a=8*Math.sqrt(3)/2,r="Grass_";switch(t){case 1:r="Grass_";break;case 0:r="Water_";break;case 3:r="Mount_";break;case 4:r="Tree_";break;case 5:r="House_"}let s=at[r+e];if(s){let t=s.clone();t.position.set(n*a*2-48+o*a,8*o*1.5,-1.6),i&&(i=6-i,t.rotation.z=i*Math.PI/3),rt.push(t),rn(t)}else console.log("invalid model "+r+e)}function ft(){rt.forEach((t=>{ln(t)})),rt=[]}function gt(t,e){let n=8*Math.sqrt(3)/2,o=Math.floor((8+e)/12),i=Math.floor((t+48+8-o*n)/(2*n));return lt.position.set(i*n*2-48+o*n,8*o*1.5,.8),[i,o]}let vt={x:0,y:0},yt=0;var xt,wt,bt,_t,Et,kt,zt=6;function Lt(t,e){return(e=e||0)+(zt=(9301*zt+49297)%233280)/233280*((t=t||1)-e)}function St(t){return at[t].clone()}function Ct(t,e){st=e,ht()}var Mt=2048;Math.PI;let Tt,At=1,Pt=-.001;function Ht(t){let e;switch(t){case 4:e=600,wt.shadow.camera.far=1200,wt.shadow.mapSize.width=Mt,wt.shadow.mapSize.height=Mt,Tt=100,wt.position.z=600;break;case 3:e=300,wt.shadow.camera.far=600,wt.shadow.mapSize.width=Mt,wt.shadow.mapSize.height=Mt,Tt=100,wt.position.z=300;break;case 2:e=120,wt.shadow.camera.far=240,wt.shadow.mapSize.width=Mt,wt.shadow.mapSize.height=Mt,Tt=40,wt.position.z=120;break;case 1:e=75,wt.shadow.camera.far=150,wt.shadow.mapSize.width=Mt,wt.shadow.mapSize.height=Mt,Tt=25,wt.position.z=75;break;default:e=30,wt.shadow.camera.far=60,wt.shadow.mapSize.width=Mt,wt.shadow.mapSize.height=Mt,Tt=10,wt.position.z=30}wt.shadow.camera.left=-e,wt.shadow.camera.right=e,wt.shadow.camera.top=e,wt.shadow.camera.bottom=-e,wt.shadow.map&&(wt.shadow.map.dispose(),wt.shadow.map=null),xt&&setTimeout((function(){xt.update()}),100)}function It(t){t?xt?xt.visible=!0:rn(xt=new s.Rki(wt.shadow.camera)):xt&&(xt.visible=!1)}var Nt,Ft=n(335),qt=!1,Rt=void 0,Bt=!1,Wt=!1,jt=0,Ot=0,Dt=0,Vt=0,Yt=0,Ut=!1,Gt=[];function Xt(){let t=document.querySelector(".canvasHolder");t.addEventListener("mousemove",te),t.addEventListener("mousedown",ee),t.addEventListener("mouseup",ne),t.addEventListener("touchstart",oe),t.addEventListener("touchend",ie),t.addEventListener("touchmove",re),window.addEventListener("contextmenu",fe),window.addEventListener("keyup",ye)}var Kt=!1;function Jt(t,e,n,o){!function(t,e){(Nt=new Ft.z(e,t)).callbackCounts=t=>{1==t?Rt=setTimeout((function(){Bt=!0}),100):Rt&&clearTimeout(Rt)},Nt.mouseButtons={LEFT:void 0,MIDDLE:s.RsA.ROTATE,RIGHT:s.RsA.PAN},Nt.maxPolarAngle=1.3,Nt.isControl(),Qt(),Nt.addEventListener("change",(function(t){var e,n=Nt.target.distanceTo(Nt.object.position);n<30?(0!=Kt&&Ht(0),Kt=0):n<100?(1!=Kt&&Ht(1),Kt=1):n<180?(2!=Kt&&Ht(2),Kt=2):(3!=Kt&&Ht(3),Kt=3),e=Nt.target,Et.set(e.x,e.y,e.z),wt.position.x=e.x,_t.position.x=e.x})),Nt.addEventListener("end",(function(t){Rt&&clearTimeout(Rt),Bt=!1}))}(e,n)}function Zt(){console.log("p2"),Nt.touches={ONE:69,TWO:s.QmN.DOLLY_PAN}}function Qt(){console.log("p1"),Nt.touches={ONE:s.QmN.PAN,TWO:s.QmN.DOLLY_ROTATE}}function $t(t){var e;e=qt=t,lt.visible=e,t?Zt():Qt()}function te(t){ve(t.clientX,t.clientY)}function ee(t){return 1===t.which&&(Wt=!0,!0)}function ne(t){if(2===t.which)return!1;Wt=!1,ae()}function oe(t){return Wt=!0,jt=t.touches[0].clientX,Ot=t.touches[0].clientY,!0}function ie(t){Wt&&(pe||Nt.isControl()),Wt=!1,me&&(document.querySelector(".bubbleSelector").style.visibility="hidden",me=!1),ae()}function ae(){qt&&(yt=0,vt.x=0,vt.y=0),function(){if(pe){pe=void 0,document.querySelectorAll(".bubble").forEach((t=>{t.style.visibility="hidden"}));let t=document.querySelector(".overtext");t&&(t.style.visibility="hidden"),he>=0&&ue[he](Dt,Vt,0),we(!1)}}()}function re(t){ve(t.touches[0].clientX,t.touches[0].clientY)}function se(){return jt}function le(){return Ot}var ce=0;function de(t){let e={x:t.x-Dt,y:t.y-Vt,z:t.z-Yt};Gt.push(e),Gt.length>6&&Gt.shift(),Dt=t.x,Vt=t.y,Yt=t.z,qt?(Wt||gt(Dt,Vt),(Bt||Wt)&&function(t,e){let[n,o]=gt(t,e),i=st.length;(n!=vt.x||o!=vt.y)&&n>-1&&o>-1&&n<i&&o<i&&(0==yt&&st[n][o]==pt?ut(n,o,1):ut(n,o,pt),yt++,vt.x=n,vt.y=o,ct&&(clearTimeout(ct),ct=null),ct=setTimeout((function(){var t;t=st,U.emit("terrain",k().id,0,t)}),2e3))}(Dt,Vt)):Bt||Wt?1==(ce=function(t){if(null==Ae){let e,n=6;if(Ce.forEach((o=>{if(null!=o.physId){let i=o.position.distanceTo(t);i<n&&(e=o.physId,n=i)}})),null!=e)return Ae=Se[e],1;Ae=-1}else if(-1!=Ae){let e=Ae;return e.quaternion.setFromAxisAngle(new ke.Vec3(0,0,1),0),e.position.copy(t),e.position.z+=6,e.sleep(),++Xe>10&&(Xe=0,it(e,!0),console.log("send phys")),1}return 0}(t))&&(Nt.reset(),Zt()):ce>-1&&(function(t,e){if(Ae&&-1!=Ae){let n=Ae;n&&(n.wakeUp(),n.position.copy(t),n.velocity.copy(e),n.position.z+=6,Xe=0,it(n,!1),console.log("send phys NOW"))}Ae=void 0}(t,function(){let t={x:0,y:0,z:0};return Gt.forEach((e=>{t.x+=e.x,t.y+=e.y,t.z+=e.z})),t}()),ce=!1,ce=-1,Qt())}var pe,ue=[],he=-1,me=!1;function fe(t){return t.preventDefault(),!1}function ge(){return Nt.object.rotation.z}function ve(t,e){pe?function(t,e){let n=t-pe.x,o=e-pe.y,i=Math.sqrt(n*n+o*o),a=function(t,e){let n=Math.atan2(t,-e);return n<0&&(n=2*Math.PI+n),n}(n,o),r=document.querySelectorAll(".bubble"),s=2*Math.PI/r.length,l=a/s+s/2,c=Math.floor(l);c>=r.length&&(c=0),i>100&&(c=-1);let d="";r.forEach(((t,e)=>{e==c?(t.style.border="solid blue 6px",d=t.getAttribute("value")):t.style.border=""})),Math.PI;let p=document.querySelector(".overtext");c>-1?(p.style.visibility="visible",p.style.left=t+"px",p.style.top=e+"px",p.innerHTML=d,p.style.transform=n>25?"translate(28px,-50%)":n<-25?"translate(calc(-28px - 100%),-50%)":"translate(-50%,calc(-28px - 100%))"):p.style.visibility="hidden",he=c}(t,e):(jt=t,Ot=e)}function ye(t){if(xe())return!1;switch(console.log(t.which),t.which){case 13:q(2);break;case 27:R();break;case 49:Ht(0);break;case 50:Ht(1);break;case 51:Ht(2);break;case 52:Ht(3);break;case 53:Ht(4);break;case 84:nt({x:2,y:2,z:3},2,{x:Dt,y:Vt,z:30},0,z());break;case 89:nt({x:2,y:2,z:6},2,{x:Dt,y:Vt,z:30},1,z());break;case 192:window.pickTarget=i.pick(),window.pickTarget&&console.log("picked a "+window.pickTarget.type)}}function xe(){return Ut}function we(t){Ut=t;let e=document.querySelectorAll(".menuHidable");e.length&&e.forEach((e=>{e.style.visibility=t?"hidden":"visible"}))}var be,_e,Ee,ke=n(279),ze=0;var Le=[],Se=[],Ce=[];function Me(t,e,n,o,i,a){let r,s,l=new ke.Body({mass:n});r=i?new ke.Cylinder(e.x,e.y,e.z,6):new ke.Box(new ke.Vec3(e.x,e.y,e.z)),l.addShape(r),l.position.set(o.x,o.y,o.z),l.id=t,Le.push(t),Se[t]=l,be.push(l),_e.addBody(l),s=i?pn(e.x,e.y,e.z,o.x,o.y,o.z,a):dn(2*e.x,2*e.y,2*e.z,o.x,o.y,o.z,a),rn(s),Ce[t]=s,s.physId=t}function Te(t){t.forEach((t=>{let e=Se[t[0]];e&&(e.position.copy(t[1]),e.quaternion.copy(t[2]),e.velocity.copy(t[3]),e.angularVelocity.copy(t[4]),e.sleepState!=t[5]&&(2==t[5]?e.sleep():2==e.sleepState&&e.wakeUp()))}))}var Ae,Pe,He,Ie,Ne,Fe,qe,Re,Be,We,je,Oe,De,Ve,Ye,Ue,Ge,Xe=0,Ke=n(145),Je=n(38),Ze=(n(857),n(596)),Qe=n(26);function $e(){var t;(Pe=new s.cPb(45,window.innerWidth/window.innerHeight,1,5e3)).position.z=200,Pe.position.y=-200,Pe.up=new s.Pa4(0,0,1),Pe.lookAt(new s.Pa4(0,0,0)),Ie=new s.xsS,un=Ie,je=document.querySelector(".canvasHolder"),(He=new s.CP7({antialias:!0,alpha:!0})).shadowMap.enabled=!0,He.shadowMap.type=s.ntZ,He.toneMapping=s.LY2,He.outputEncoding=s.knz,He.setClearColor(16744242,1),je.appendChild(He.domElement),Be=new Ke.E,t=s.rDY.merge([s.Vj0.standard.uniforms]),new s.jyz({uniforms:t,derivatives:!1,lights:!0,vertexColors:!0,vertexShader:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec3 shirt;\nuniform vec3 wind;\n\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #ifdef USE_COLOR\n        if(color==vec3(0,0,1))\n            vColor.xyz = shirt;\n        else\n            vColor.xyz = color.xyz;\n        \n    #endif\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n    #ifdef USE_TANGENT\n        vTangent = normalize( transformedTangent );\n        vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n    #endif\n#endif\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    \n        if(color==vec3(1,0,0)){\n            float val=max(0.0, 1.0976 - transformed.z);\n            transformed.xyz+=val*wind;\n            transformed.y*=1.0+sin((wind.z+transformed.z)*4.0)/2.0;\n\n        }\n    \n\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n}",fragmentShader:"\n    #define STANDARD\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <roughnessmap_fragment>\n    #include <metalnessmap_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n    #include <lights_physical_fragment>\n    #include <lights_fragment_begin>\n    #include <lights_fragment_maps>\n    #include <lights_fragment_end>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n    gl_FragColor = vec4( outgoingLight,1.-(((0.2125 * outgoingLight.r) + (0.7154 * outgoingLight.g) + (0.0721 * outgoingLight.b)) ) );\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n    #include <dithering_fragment>\n}",roughness:0,metalness:1}),un=Ie,Fe=Pe,nn(),Oe=new Je.x(He);let e=new Ze.G(Ie,Pe,300,200);e.kernelRadius=6,e.minDistance=15e-5,e.maxDistance=.001,Oe.addPass(e),window.ssao=e,new s.vBJ({color:7722446}),new s.Wid({color:2156703,metalness:0,roughness:1}),new s.Wid({color:2156703,metalness:0,roughness:1}),new s.Wid({color:5534117,metalness:0,roughness:1});let n=new s.Wid({color:15398690,metalness:0,roughness:1});De=new s.Wid({color:13576926,metalness:0,roughness:1}),new s.Wid({color:11930379,metalness:0,roughness:1}),new s.Wid({color:15398690,metalness:0,roughness:1}),Ne=new s.ZAu,Ve=new s.ZAu;let o=new s.vBJ({color:16777215,side:s.Wl3}),i=new s.vBJ({color:3282968,side:s.Wl3}),a=cn(1,1,2,0,0,0,n),r=cn(1,.2,1,0,.5,.5,o),l=cn(.3,.2,.3,0,.6,.5,i);Ve.add(a),Ve.add(r),Ve.add(l),Ne.add(Ve);let c=cn(.5,.5,1.5,.75,0,20,new s.vBJ({color:14035807}));return Ne.add(c),Ie.add(Ne),function(){let t=new s.zf8(3,8);Ue=new s.vBJ({color:4907322}),new s.vBJ({color:15461888}),(Ye=new s.Kj0(t,Ue)).position.z=.05,Ie.add(Ye)}(),new s.Pa4(1,0,0),Et=new s.Pa4(0,0,0),sn(kt=new s.Mig(9408399)),(wt=new s.Ox3(14702423,.5)).position.set(0,250,0),wt.castShadow=!0,sn(wt),(_t=new s.Tme).position.set(20,0,20),sn(_t),wt.target=_t,wt.shadow.mapSize.width=Mt,wt.shadow.mapSize.height=Mt,wt.shadow.camera.near=1,Ht(0),wt.shadow.radius=2.2,wt.shadow.bias=-5e-4,(bt=wt.clone()).shadow.mapSize.width=256,bt.shadow.mapSize.height=256,bt.shadow.radius=0,bt.visible=!1,sn(bt),window.sunLight=wt,It(!0),Jt(0,je,Pe),setTimeout((function(){on()}),1),je}function tn(t){t&&!Ge&&(Ge=new Qe.O(Ie,_e))}function en(t,e,n,o){Be.load("./"+t,(t=>{let i;if(t.scene.rotation.x=Math.PI/2,t.scene.traverse((function(t){t instanceof s.Kj0&&(i=t,n||(t.material=o?new s.Wid({color:o,metalness:0,roughness:1}):new s.Wid({vertexColors:s.jSK,metalness:0,roughness:1}),t.material.needsUpdate=!0))})),t.scene.children[0],i){var a=t.animations;if(a&&a.length){We=new s.Xcj(i);for(var r=0;r<a.length;r++){var l=a[r];action=We.clipAction(l),action.timeScale=.002,action.play()}}}e(t.scene)}),(t=>{console.log(t.loaded/t.total*100+"% loaded")}),(t=>{console.error("An error happened",t)}))}function nn(){window.screen.width>window.innerWidth?(qe=window.innerWidth,Re=window.innerHeight):(qe=window.screen.width,Re=window.screen.height),Pe.aspect=qe/Re,Pe.updateProjectionMatrix(),He.setPixelRatio(.5),He.setSize(qe,Re)}function on(t){!function(){_e.step(.03333333333333333);for(var t=0;t!==be.length;t++){if(null!=be[t].id){let e=Ce[be[t].id];e.position.copy(be[t].position),e.quaternion.copy(be[t].quaternion)}be[t].position.z<-100&&(be[t].position.set(80*Math.random()-40,80*Math.random()-40,100),be[t].velocity.set(0,0,0),be[t].collisionResponse=!1,be[t].sleep())}let e=ge(),n=Ee.velocity.length();vn.left?(n<2&&(Ee.velocity.x-=2*Math.cos(e),Ee.velocity.y-=2*Math.sin(e)),ze=e+Math.PI/2,Ee.quaternion.setFromAxisAngle(new ke.Vec3(0,0,1),ze)):vn.right?(n<2&&(Ee.velocity.x+=2*Math.cos(e),Ee.velocity.y+=2*Math.sin(e)),ze=e-Math.PI/2,Ee.quaternion.setFromAxisAngle(new ke.Vec3(0,0,1),ze)):vn.up?(n<2&&(Ee.velocity.x-=2*Math.sin(e),Ee.velocity.y+=2*Math.cos(e)),ze=e,Ee.quaternion.setFromAxisAngle(new ke.Vec3(0,0,1),ze)):vn.down&&(n<2&&(Ee.velocity.x+=2*Math.sin(e),Ee.velocity.y-=2*Math.cos(e)),ze=e+Math.PI,Ee.quaternion.setFromAxisAngle(new ke.Vec3(0,0,1),ze)),Ve.position.copy(Ee.position),Ve.quaternion.copy(Ee.quaternion)}(),Ne.rotation.z>Math.PI/16||(Ne.rotation.z,Math.PI),function(){var t=new s.Pa4;t.set(se()/window.innerWidth*2-1,-le()/window.innerHeight*2+1,.5),t.unproject(Pe);var e=t.sub(Pe.position).normalize(),n=-Pe.position.z/e.z,o=Pe.position.clone().add(e.multiplyScalar(n));Ye.position.x=o.x,Ye.position.y=o.y,Ye.position.z=2,de(Ye.position)}(),function(){At+=Pt,At<0?(At=0,Pt=-Pt):At>1&&(At=1,Pt=-Pt),At&&(wt.color.setHex(16777215),kt.color.setHex(6316128),hn(11594237,1));let t=Tt*At;_t.position.y=Et.y-t,wt.position.y=Et.y+t}(),Ge&&Ge.update(),He.render(un,Fe),requestAnimationFrame(on)}function an(t,e){He.setSize(256,256),He.setClearColor(16777215,0),t&&e?He.render(t,e):He.render(getScene(),Pe);let n=He.domElement.toDataURL();return He.setSize(qe,Re),n}function rn(t){Ne.add(t)}function sn(t){Ie.add(t)}function ln(t){Ne.remove(t)}function cn(t,e,n,o,i,a,r){let l=new s.nvb(t,e,n);r||(r=De);let c=new s.Kj0(l,r);return c.castShadow=!0,c.position.x=o||0,c.position.y=i||0,c.position.z=a||0,c}function dn(t,e,n,o,i,a,r){return cn(t,e,n,o,i,a,r=r?new s.vBJ({color:r}):De)}function pn(t,e,n,o,i,a,r){let l=new s.fHI(t,e,n,6);r=r?new s.vBJ({color:r}):De,l.rotateX(Math.PI/2),l.rotateZ(Math.PI/2);let c=new s.Kj0(l,r);return c.castShadow=!0,c.position.x=o||0,c.position.y=i||0,c.position.z=a||0,c}var un=0;function hn(t,e){He.setClearColor(t,e)}let mn;function fn(t,e,n,o){let i,a=document.createElement("div"),r=document.createElement("div");if(r.classList.add("switch"),n&&(i=settingsObject[n]),o){i!=o[0]&&(i!=o[o.length-1]?r.classList.add("switchHalf"):r.classList.add("switchOn")),r.setAttribute("value",i);let t=0;for(let e=0;e<o.length;e++)o[e]==i&&(t=e);r.setAttribute("index",t),r.addEventListener("click",(function(t){t.stopPropagation();let n=r.getAttribute("index");n++,n>=o.length&&(n=0),0==n?r.classList.remove("switchOn"):n==o.length-1?(r.classList.remove("switchHalf"),r.classList.add("switchOn")):r.classList.add("switchHalf");let i=o[n];r.setAttribute("value",i),r.setAttribute("index",n),e(i)}))}else i&&r.classList.add("switchOn"),r.addEventListener("click",(function(t){t.stopPropagation(),r.classList.contains("switchOn")?(r.classList.remove("switchOn"),e(!1)):(r.classList.add("switchOn"),e(!0))}));a.appendChild(r);let s=document.createElement("span");s.innerHTML=t,a.appendChild(s),mn.appendChild(a),e(i)}var gn,vn;gn=document.querySelector("#main"),vn={},function(t){var e;(e=document.createElement("style")).innerHTML='\n\t\t.uiSysTop{\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tposition: relative;\n\t\tmax-width: 600px;\n\t\theight: 64px;\n\t\tborder-radius: 32px;\n\t\ttransform: translate(-50%);\n\t\tbox-shadow: 3px 3px 3px #0005;\n\t\tleft: 50%;\n\t\tbackground: #E0F9D5;\n\t\tmargin: 12px;\n\t\tanimation: uiSysUnfold 1s;\n\t\toverflow: hidden;\n\t\tline-height: 16px;\n\t}\n\t.uiSysTop div{\n\n\t\tmargin: 16px;\n\t\tmargin-left: 0px;\n\t\tflex: 0 0 64px;\n\t}\n\t.uiSysTop span{\n\t\tmargin-right: 48px;\n\t\tmargin-top: 8px;\n\t\tline-height: normal;\n\t\tvertical-align: middle;\n\t\tflex: 1;\n\n\t}\n\t@keyframes uiSysUnfold{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t100%{\n\t\t\ttop: 0px;\n\t\t}\n\t}\n\t@keyframes uiSysFold{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t\theight: 0;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t0%{\n\t\t\ttop: 0px;\n\n\t\t}\n\t}\n\t@keyframes uiSysMini{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\n\t\t}\n\t\t0%{\n\t\t\t\n\t\t}\n\t}\n\t@keyframes uiSysMax{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t100%{\n\t\t\tleft: 50%;\n\t\t}\n\t}\n\n\t.uiHolderSysTop{\n\t\twidth: 600px;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%);\n\t\t/*border: 3px #0999 dotted;*/\n\t\ttransition: height 1s;\n\t}\n\t.uiIcon{\n\t\tfloat: left;\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:32px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z"/></svg>\');\n\t}\n\t.uiIconWarning{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>\') !important;\n\t}\n\t.uiIconError{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>\') !important;\n\t}\n\t.uiIconNet{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"/></svg>\') !important;\n\t}\n\t.uiIconPerson{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>\') !important;\n\t\t\n\t}\n\t.uiIconTime{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/></svg>\') !important;\n\t}\n\n\t.uiIconSuccess{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>\') !important;\n\t}\n\t\n\t.uiCloseButton{\n\t\tposition: absolute;\n\t\tright: 0;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:16px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\');\n\t\t\n\t}\n\n\t.uiCursorMessage{\n\t\tmin-width: 64px;\n\t\theight: 64px;\n\t\tborder: 5px solid white;\n\t\tbackground-color: #FBAB7E;\n\t\tbackground-image: linear-gradient(270deg, #FBAB7E 0%, #F7CE68 100%);\n\n\t\tcolor: white;\n\t\tfont-size: 24px;\n\t\tfont-weight: bold;\n\t\tfont-stretch: ultra-condensed;\n\t\ttransform: translate(-50%,-50%);\n\t\tanimation: uiWobble 0.3s;\n\t\tborder-radius: 32px;\n\t\tbox-sizing: border-box;\n\t\tposition: absolute;\n\t\tline-height: 48px;\n\t\tpadding: 0 8px 0 8px;\n\t\tfont-family: sans-serif;\n\t}\n\n\t@keyframes uiWobble{\n\t\t0%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.6,0.4);\n\t\t}\n\t\t33%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.9,1.15);\n\t\t}\n\t\t66%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.8,0.9);\n\t\t}\n\t\t100%{\n\n\t\t}\n\t}\n\n\t@keyframes uiFade{\n\t\t0%{\n\t\t\topacity: 1;\n\t\t\ttransform: translate(-50%,-50%);\n\t\t}\n\t\t100%{\n\t\t\topacity: 0;\n\t\t\ttransform: translate(-50%,0%)\n\t\t}\n\t}\n\n\t.confetti{\n\t\tpointer-events: none;\n\t\tleft:200px;\n\t\ttop:200px;\n\t\twidth:50px;\n\t\theight:50px;\n\t\tposition: absolute;\n\t\tstroke-width:40px;\n\t\t/*background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 100 100" style="fill:none;stroke:lightgray;stroke-linecap:round;"><path d="M45 65L75 75M45 50L75 50M45 35L75 25" /></svg>\');\n\t\tbackground-size: cover;\n\t\tbackground-position: center;\n\t  \tbackground-repeat: no-repeat;*/\n\t}\n\t.confetti svg{\n\t\tposition: relative;\n\t\tanimation: dooter 0.5s forwards;\n\t\ttransform: translate(-50%,-50%);\n\t\twidth: 50px;\n\t\theight: 50px;\n\t}\n\t@keyframes dooter{\n\t\tfrom{\n\t\t\ttransform: translate(0%,0%) scale(0.1,0.1);\n\t\t\tstroke-width:30;\n\t\t}\n\t\tto{\n\t\t\ttransform: translate(100%,0%) scale(3,3);\n\t\t\tstroke-width:0;\n\t\t\tfilter:hue-rotate(270deg);\n\t\t}\n\t}\n\n\t',document.body.appendChild(e),t?h=t:(h=document.querySelector("#main"),h||(h=document.body)),h?(m=document.createElement("div"),m.className="uiHolderSysTop",h.appendChild(m),f=document.createElement("input"),f.type="text",f.style.position="fixed",f.taxindex="-1",f.style.display="none",f.style.pointerEvents="none",h.appendChild(f)):console.error("UI.js:: uh oh! no system dom element found")}(gn),window.onError=function(t,e,n,o,i){g(t,"error")},function(){be=[],(_e=new ke.World).quatNormalizeSkip=0,_e.quatNormalizeFast=!1,_e.allowSleep=!0,_e.gravity.set(0,0,-10),_e.broadphase=new ke.NaiveBroadphase;let t=new ke.Box(new ke.Vec3(1,1,2));for(let e=0;e<1;e++){let e=new ke.Body({mass:4});e.addShape(t),e.position.set(0,0,60),_e.addBody(e),Ee=e,window.playerBody=Ee}new ke.Material({name:"gooProperty",friction:10,restitution:-1}).name="gooProperty",new ke.Material({name:"wallProperty",friction:.1,restitution:1}).name="wallProperty",function(){let t=new ke.Plane,e=new ke.Body({mass:0});e.addShape(t),_e.addBody(e)}()}(),$e(),en("./assets/models/Hex.glb",(t=>{console.log("got children "+t.children.length);let e=new s.Wid({vertexColors:s.jSK,metalness:0,roughness:1});for(let a=0;a<t.children.length;a++){let r=t.children[a];r.position.set(0,0,60),r.scale.set(8,8,8),r.material=e,r.receiveShadow=!0,(r.name.startsWith("Mount")||r.name.startsWith("Tree")||r.name.startsWith("House"))&&(r.castShadow=!0),at[r.name]=r;let s=[];if(r.geometry){let t=r.geometry.attributes.color.array.length/4;for(let e=0;e<t;e++){let t=4*e,a=(n=r.geometry.attributes.color.array[0+t],o=r.geometry.attributes.color.array[1+t],i=r.geometry.attributes.color.array[2+t],function(t,e,n){return"#"+c(t)+c(e)+c(n)}(n=Math.floor(256*n),o=Math.floor(256*o),i=Math.floor(256*i)));s[a]=a}}}var n,o,i;function a(t,e){t.addEventListener("click",(t=>{console.log("clicking hex");let n=t.target;n.classList.contains("hex")||(n=n.parentElement),n.classList.remove("jelloAnim"),n.offsetWidth,n.classList.add("jelloAnim"),function(t){pt=t,console.log("set hex "+pt)}(e)}))}let r=document.querySelectorAll(".hex");r[0].appendChild(p(St("Grass_O1"))),a(r[0],1),r[1].appendChild(p(St("Tree_N"),75,-75)),a(r[1],4),r[2].appendChild(p(St("Grass_P1"))),a(r[2],2),r[3].appendChild(p(St("Mount_N"),90)),a(r[3],3),r[4].appendChild(p(St("Water_N"))),a(r[4],0),r[5].appendChild(p(St("House_N"))),a(r[5],5),function(){ft();for(let t=0;t<32;t++){st[t]=[];for(let e=0;e<32;e++)st[t][e]=1}}(),ht()})),function(){let t=new s.vBJ({color:4907322}),e=new s.ZAu,n=new s.BKK(.6,8),o=new s.Kj0(n,t);o.position.set(8,0,0),e.add(o);for(let t=0;t<6;t++){let n=o.clone();n.rotation.z=t*Math.PI/3,n.position.set(8*Math.cos(n.rotation.z),8*Math.sin(n.rotation.z),0),e.add(n)}e.position.z+=6,rn(e),(lt=e).visible=!1}(),function(){let t=8*Math.sqrt(3)/2;var e=new s.ZXM;for(let n=0;n<32;n++)for(let o=0;o<32;o++)e.vertices.push(new s.Pa4(-48+t+n*t*2+o*t,8*o*1.5-4,.8)),e.vertices.push(new s.Pa4(-48+t+n*t*2+o*t,4+8*o*1.5,.8)),e.vertices.push(new s.Pa4(-48+t+n*t*2+o*t,4+8*o*1.5,.8)),e.vertices.push(new s.Pa4(n*t*2-48+o*t,8+8*o*1.5,.8)),e.vertices.push(new s.Pa4(n*t*2-48+o*t,8+8*o*1.5,.8)),e.vertices.push(new s.Pa4(-48-t+n*t*2+o*t,4+8*o*1.5,.8));var n=new s.nls({color:16777215});dt=new s.ejS(e,n)}(),function(){a=new s.xsS,(r=new s.cPb(45,1,1,1e3)).position.z=200,r.position.y=-200,r.up=new s.Pa4(0,0,1),r.lookAt(new s.Pa4(0,0,0));var t=new s.Mig(9408399);a.add(t)}(),function(t){(C=document.querySelector("#closeCard")).addEventListener("click",(t=>{R()}));let e=document.querySelectorAll(".card");w=[],e.forEach((t=>{w.push(t)})),w.forEach(((t,e)=>{t.style.top=Math.random()*window.innerWidth+"px",t.style.left=Math.random()*window.innerHeight+"px",t.offset={x:0,y:0},t.appId=e,t.addEventListener("pointerdown",(e=>{!function(t,e){t.focused||(N=t,t.pos={x:parseInt(t.style.left),y:parseInt(t.style.top)},F={x:t.pos.x,y:t.pos.y},t.offset={x:t.pos.x-e.clientX,y:t.pos.y-e.clientY},t.classList.add("cardMove"),t.moving=void 0)}(t,e)})),t.addEventListener("dragstart",(t=>{t.preventDefault()}))})),window.addEventListener("pointerup",Y),window.addEventListener("resize",B),window.addEventListener("pointermove",D),function(){b=document.querySelector("#bar");let t=document.querySelector("#barHandle");t.addEventListener("pointerdown",(t=>{A=!0})),t.addEventListener("dragstart",(t=>{t.preventDefault()})),L=[],t.style.transform="translate(-50%,-200%)",b.style.left="50%",b.style.top=window.innerHeight-64+"px",W(!0)}(),B(),j()}(),function(){var t;(t=document.createElement("style")).innerHTML="\n        .list-item{\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            max-width: calc(100% - 128px);\n            transform: translate(-50%,0);// rotate3d(1,0,0,0deg);\n            margin: 32px 0 16px 0;\n            position: relative;\n            padding: 16px;\n            left: 50%;\n            font-weight: bold;\n            font-size: 2em;\n            text-shadow: 1px 1px 2px black;\n            text-align: center;\n            font-family: 'openBold', serif;\n            transition: 0.2s transform;\n\n        }\n        .list-item span{\n            margin: 32px 0 32px 0;\n        }\n        .list-item:hover{\n            transform: translate(-50%,0) scale(1.05,1.05);// rotate3d(1,0,0,0deg);\n        }\n        .list{\n            width: 100%;\n            height: 100%;\n            position: absolute;\n            overflow-y: scroll;\n        }\n        .list *{\n        \tuser-select: none;\n        }\n        .list-portrait{\n            left: 8px;\n            top: 8px;\n            position: absolute;\n            display: inline-block;\n            width: 64px;\n            height: 64px;\n            border-radius: 32px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            overflow: hidden;\n            box-sizing: border-box;\n            border: white solid 6px;\n            transform: translate(-50%,-50%);\n            transition: left 0.4s;\n        }\n        .bigger-item .list-portrait{\n            left: 50% !important;\n            top: 0px !important;\n        }\n        .login-popin{\n            position: fixed;\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n        }\n        #login-junk{\n            max-width: 500px;\n            height: 300px;\n            transform: translate(-50%,0);\n            position: relative;\n            left: 50%;\n        }\n        .num{\n            margin-left: 0 !important;\n            border-radius: 28px;\n            font-size: 36px;\n            background-color: #0005;\n            width: 56px;\n            height: 56px;\n            display: inline-block;\n            overflow: hidden;\n            cursor: pointer;\n        }\n        .num-row{\n            width: 168px;\n            height: 168px;\n            position: absolute;\n            left: 50%;\n            transform: translate(-50%,0);\n        }\n        input{\n            text-align: center;\n            font-size: 16px;\n            outline: none;\n            border: none;\n            border-bottom: black 6px solid;\n            margin: 16px;\n            background-color: transparent;\n            color: inherit;\n        }\n        ",document.body.appendChild(t);let e=document.querySelector("#login-junk");e.style.display="none";let n=document.createElement("div");n.className="list",x=e.querySelector("input"),function(t){let e=document.createElement("div");e.className="num-row";for(let t=1;t<=10;t++){let n=document.createElement("div");n.innerText=10==t?0:t,n.className="num",e.appendChild(n),n.addEventListener("click",(t=>{t.stopPropagation(),x.value.length<4&&(x.value+=t.target.innerText)}))}let n=document.createElement("div");n.className="num",n.innerText="C",n.addEventListener("click",(t=>{t.stopPropagation(),x.value=""})),e.appendChild(n);let o=document.createElement("div");o.className="num",o.innerText="Go",o.style.backgroundColor="#fff5",o.addEventListener("click",(t=>{t.stopPropagation();let e=t.target.parentElement.parentElement.parentElement.querySelector("span");var n,o;e&&(console.log("login with ",e.innerText,":",x.value),n=e.innerText,o=x.value,fetch("/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:o})}).then((function(t){return t.ok?t.json():void g(t.status+":"+t.statusText,"warn")})).then((function(t){t&&(g(t.message,"success"),function(t){if(!(y=v[t]))throw new Error("player doesn't exist")}(t.id),window.m=ot,console.log("trying auth..."),tt=g("attempting communications...","net",!0),(U=u("/dand-dev")).on("connect",(function(){document.querySelector("#login-menu").style.display="none",console.log("connected"),U.emit("physInit"),tt.remove(),tt=void 0})),U.on("event",(function(t){})),U.on("disconnect",(function(t){console.log("disconnected ",t),t.includes("disconnect")?document.querySelector("#login-menu").style.display="block":tt=g("lost connection, attempting reconnection...","net",!0)})),U.on("message",(function(t,e){J(t,e)})),U.on("join",(function(t){Q(t+" has joined!")})),U.on("terrain",(function(t,e,n){Ct(0,n)})),U.on("sendPhys",(function(t,e){!function(t,e){let n=Se[t.id];n&&(n.position.copy(t.position),n.quaternion.copy(t.quaternion),e?n.sleep():(n.velocity.copy(t.velocity),n.angularVelocity.copy(t.angularVelocity),n.wakeUp()))}(t,e)})),U.on("physUpdate",(function(t){et?(Te(t),console.log("phys synced")):console.log("!!!phys IGNORED")})),U.on("physInit",(function(t,e){Ce.forEach((t=>{ln(t)})),Ce=[],be.forEach((t=>{_e.remove(t)})),be=[],Le=[],Se=[],t.forEach(((t,e)=>{Me(t[0],t[1],t[2],{x:0,y:0,z:0},t[3],t[4])})),Te(e),et=!0})),U.on("physMake",(function(t,e,n,o,i,a,r){Me(t,e,n,o,i,a),console.log("made")})),fetch("/lastChats",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():void 0})).then((function(t){t&&(t.array.forEach((t=>{J(t[0],t[1])})),Q("Last 10 messages"))})).catch((t=>{g(t,"error"),console.error("ERROR ",t)})),fetch("/grid",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(t){return t.ok?t.json():void 0})).then((function(t){t&&t.grid.length>0&&Ct(0,t.grid)})).catch((t=>{g(t,"error"),console.error("ERROR ",t)})),Xt())})).catch((t=>{g(t,"error"),console.error("ERROR ",t)})))})),e.appendChild(o),t.appendChild(e)}(e);let o=document.querySelector("#login-menu");o.appendChild(n),o.appendChild(e),fetch("/getUsers",{method:"post"}).then((function(t){return t.json()})).then((function(t){t&&(function(t){v=[],t.forEach((t=>{v[t.id]=t}))}(t.users),t.users.forEach((t=>{let e=document.createElement("div");e.className="list-item";let o=t.color;e.style.backgroundColor=o;let i=d(l(o));e.style.color=i?"#000000":"#FFFFFF",e.style.textShadow="1px 1px 2px "+(i?"#FFFFFF":"#000000"),e.addEventListener("click",(t=>{let n=document.querySelector("#login-junk");n.style.display="",n.parentElement.classList.remove("bigger-item"),e.appendChild(n),e.classList.add("bigger-item"),t.stopPropagation(),x.focus()}));let a=document.createElement("div");a.className="list-portrait",e.appendChild(a);let r=document.createElement("span");r.innerText=t.username,e.appendChild(r),n.appendChild(e)})))})).catch((t=>{console.error("ERROR"+t)}))}(),function(){let t=document.querySelector("#chatCard");(M=document.createElement("div")).classList.add("chat-pane"),t.appendChild(M);let e=document.createElement("div");e.classList.add("chat-bottom"),T=document.createElement("input");let n="0xffff55";n="#"+n.substring(2,n.length),T.style.border=n+" 6px solid",e.appendChild(T),t.appendChild(e),T.addEventListener("keyup",(function(t){var e;13==t.which?T.value.length>0?(e=T.value,U.emit("message",e),T.value=""):setTimeout(Z,20):27==t.which&&Z()})),document.createElement("div").classList.add("letterPane")}(),mn=document.querySelector(".settingsPane"),fn("Toggle Hex Grid Lines",(function(t){t?rn(dt):ln(dt)})),fn("Toggle Light Helper",It),fn("Toggle Physics Mesh Helper",tn)}},0,[[838,666,977]]]);