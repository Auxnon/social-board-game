(self.webpackChunkbuup=self.webpackChunkbuup||[]).push([[179],{111:(e,n,t)=>{"use strict";t.d(n,{a:()=>Ki});var i={};t.r(i),t.d(i,{ep:()=>Bi,mS:()=>Ri,n6:()=>Di,UX:()=>Fi,bK:()=>ji,GI:()=>Vi,pk:()=>Si,S1:()=>Mi,u7:()=>Ni,b5:()=>Ji,hM:()=>wi,gw:()=>Oi,SI:()=>Ii,ob:()=>Yi,j3:()=>qi});var o=t(642);function r(e){if(!e)return[0,0,0];"string"!=typeof e&&(e=e.toString(16)),e.startsWith("#")?e=e.substring(1):e.startsWith("0x")&&(e=e.substring(2));let n=0,t=0,i=0;return 3==e.length?(n="0x"+e[0]+e[0],t="0x"+e[1]+e[1],i="0x"+e[2]+e[2]):6==e.length&&(n="0x"+e[0]+e[1],t="0x"+e[2]+e[3],i="0x"+e[4]+e[5]),[parseInt(n),parseInt(t),parseInt(i)]}function a(e){return r(e).map((e=>e/256))}function l(e){var n=e.toString(16);return 1==n.length?"0"+n:n}function s(e,n,t){return function(e,n,t){return"#"+l(e)+l(n)+l(t)}(e=Math.floor(256*e),n=Math.floor(256*n),t=Math.floor(256*t))}function c(e){return.299*e[0]+.587*e[1]+.114*e[2]>186}var d,p,u=t(429);function h(e){return d[e]}function m(){return p}var g,f,v,x,y=0,b={},w={};function k(e,n){y++,Ni(e,((e,t)=>{y--,n(e,t)}))}function E(e,n,t){n||(n="gltf"),k("assets/models/"+e+"."+n,(n=>{"Scene"==n.type&&(n=n.children[0]),n.scale.set(2,2,2),n.castShadow=!0,n.receiveShadow=!0,_(n),function(e,n){let t=e.replace(/[0-9]/g,"");if(t!=e)if(w[t]){if(!Array.isArray(w[t])){let e=w[t];w[t]=[e]}w[t].push(n)}else w[t]=n;w[e]=n}(e,n)}))}function _(e,n,t){if(e.geometry)S(e,e.geometry,n,t);else if(e.children&&e.children.length>0)for(let i=0;i<e.children.length;i++)e.children[i].geometry&&S(e,e.children[i].geometry,n,t)}function S(e,n,t,i){if(!n)return;let o,r=t&&i,a=n.attributes.color.array,l=[];for(let e=0;e<a.length;e++)if(o=e%4,o>=3)if(r)a[e-3]==t[0]&&a[e-2]==t[1]&&a[e-1]==t[2]&&(a[e-3]=i[0],a[e-2]=i[1],a[e-1]=i[2]);else{let n=s(a[e-3],a[e-2],a[e-1]);l[n]=a[e-3]+","+a[e-2]+","+a[e-1]}r||Object.keys(l).forEach((t=>{console.log("%s %s %c %s %c %s",e.name,n.name,"background: "+t+"; color: #000",t,"background: white;",l[t])}))}function C(e,n){let t=w[e];if(t){if(Array.isArray(t))t=t[Math.floor(Math.random()*t.length)];else if(n&&n.color){if("man"==e||"gran"==e){t=u.b.clone(t);let e=a(n.color);return t.userData.shirt={value:new o.Pa4(e[0],e[1],e[2])},t.userData.wind={value:new o.Pa4(0,1,0)},t.children.forEach((e=>{e&&"SkinnedMesh"==e.type&&(e.castShadow=!0,e.receiveShadow=!0,"Gran"!=e.name&&"Man"!=e.name&&"GranHead"!=e.name||(console.log("skinned ",e.name),e.material=f.clone(),e.material.skinning=!0,e.material.needsUpdate=!0,e.material.uniforms.shirt=t.userData.shirt),e.name)})),t}if(n&&n.id){let e=h(n.id);if(!e.shader){e.shader=f.clone(),e.shader.needsUpdate=!0;let t=a(n.color);e.shader.uniforms.shirt={value:new o.Pa4(t[0],t[1],t[2])}}let i=t.clone();return i.material=e.shader,i}}return t.clone()}return Si.clone()}var L=[];function z(e,n,t){n?e.scale.set(n,n,n):e.scale.set(110,110,110),t?e.position.set(0,0,t):e.position.set(0,0,-30),v.add(e);let i=Fi(v,x);return v.remove(e),i}function A(e,n,t){let i=document.createElement("img");return i.className="hexPortrait",i.setAttribute("src",z(e,n,t)),i}function T(e,n,t){let i=L[e];return i||(i=z(C(e),n,t),L[e]=i,i)}var M=t(321);let q,N,I;function H(e,n,t,i){i||(i=3500);let o=document.createElement("div");o.className="uiSysTop";let r=document.createElement("div"),a=" ";if("object"==typeof n&&null!==n)n.type&&(a+=n.type),n.color&&(o.style.backgroundColor=n.color);else switch(n){case"warn":a+="uiIconWarning",o.style.backgroundColor="#EFEF79";break;case"error":a+="uiIconError",o.style.backgroundColor="#D25E5E";break;case"net":a+="uiIconNet",o.style.backgroundColor="#FFC65E";break;case"person":a+="uiIconPerson",o.style.backgroundColor="#D257FF";break;case"time":a+="uiIconTime",o.style.backgroundColor="#5094D9";break;case"success":a+="uiIconSuccess",o.style.backgroundColor="#95F17F"}r.className="uiIcon"+a;let l=document.createElement("span");function s(){o.style.animation=t?"0.5s uiSysMini forwards":"0.5s uiSysFold forwards",setTimeout((function(){t?(o.style.position="absolute",o.style.left="-64px",o.addEventListener("click",(function(e){o.style.animation="0.5s uiSysMax forwards",setTimeout((function(){o.style.animation="0.5s uiSysMini forwards"}),i)}))):o.remove()}),500)}if(l.innerText=e,l.addEventListener("click",(function(e){!function(e){I.value=e.innerText,I.style.display="block",I.select(),document.execCommand("copy"),I.blur(),I.style.display="none"}(l),function(e,n,t){let i=document.createElement("div");i.className="uiCursorMessage",i.style.left=e+"px",i.style.top=n+"px",i.innerText="Copied",q.appendChild(i),setTimeout((function(){i.style.animation="1s uiFade forwards",setTimeout((function(){i.remove()}),1e3)}),1500)}(e.clientX,e.clientY)})),o.appendChild(r),o.appendChild(l),!t){let e=document.createElement("div");e.className="uiCloseButton",o.appendChild(e),e.addEventListener("click",(function(e){s()}))}return setTimeout((function(){s()}),i),N.appendChild(o),o}function F(e,n,t){let i=document.querySelector("#main"),o=document.createElement("div");o.classList.add("confetti"),o.innerHTML='<svg viewbox="0 0 100 100" style="fill:none;stroke:lightgreen;stroke-linecap:round"><path d="M45 70L55 75M45 50L55 50M45 30L55 25" /></svg>',o.style.left=e+"px",o.style.top=n+"px",o.style.transform="translate(-50%,-50%) rotate("+(t||0)+"deg)",setTimeout((function(){o.remove()}),500),i.appendChild(o)}var B,P,R,D,O,W,j,V,U=!1,Y="black";function J(){U=!0}function X(e){if(U){B.fillStyle=Y;let n=e.target.getBoundingClientRect();B.fillRect(32*(e.clientX-n.left)/132,32*(e.clientY-n.top)/132,2,2)}}function G(e){U=!1}function K(e){Q(e.target),B.fillStyle="rgba(255, 255, 255, 0)",B.clearRect(0,0,32,32)}function Z(e){Q(e.target),function(e){let n=document.createElement("a");n.href=e,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e.target.parentElement.parentElement.querySelector(".drawer").toDataURL("image/png"))}function Q(e){e.style.animationName="",e.offsetWidth,e.style.animationName="jello"}function $(e){Q(e.target),Y=e.target.style.backgroundColor}function ee(){return R.toDataURL("image/png")}function ne(e){B.clearRect(0,0,32,32),e.src.includes("undefined")||(B.fillStyle="rgba(255, 255, 255, 0)",B.drawImage(e,0,0,32,32))}function te(e){let n=document.createElement("div");return e&&(n.className=e),n}function ie(e,n,t){let i=te("drawer-opener");return i.setAttribute("status",n),i.addEventListener("click",(n=>{let i=e.querySelector(".drawer-group");i&&"initial"==i.style.display?(i.style.display="none",D=void 0,t&&t(!1)):(P.style.display="initial","character"==(D=n.target.getAttribute("status"))?(P.style.left="-72px",P.style.top="64px"):(P.style.top="-100px",P.style.left="50%"),e.appendChild(P),t&&t(!0))})),e.appendChild(i),i}function oe(){return D}var re,ae,le,se,ce=-1,de=null,pe=-1;function ue(e,n,t){let i=document.createElement("p"),o=n.color;i.style.backgroundColor=o;let a=c(r(o));i.style.color=a?"#000000":"#FFFFFF",i.style.textShadow="1px 1px 2px "+(a?"#FFFFFF":"#000000");let l=e.indexOf("data:image");if(l>-1){let n=e.indexOf("#",l);if(n>-1){let t=e.substring(l,n);console.log(t);let o=new Image;o.className="stretch-image",o.src=t,i.appendChild(o),e=e.substring(n+1)}}if(i.innerHTML+=e,t){i.classList.add("chat-world-bubble"),V.appendChild(i);let e=Bi(t,i);return F(e.x,e.y,Math.floor(360*Math.random())),F(e.x,e.y,Math.floor(360*Math.random())),e}{let e=document.createElement("div");if(e.classList.add("chat-row"),n.id==m().id&&e.classList.add("chat-right"),i.classList.add("chat-bubble"),pe>=0&&pe==n.id)ce==n.id?(de.classList.remove("chat-bubble-footer"),de.classList.add("chat-bubble-body")):de.classList.add("chat-bubble-header"),i.classList.add("chat-bubble-footer");else{let e=document.createElement("p");e.classList.add("chat-nametag"),e.innerHTML=n.username;let t=document.createElement("div");n.id==m().id&&(t.style.textAlign="right"),t.appendChild(e),O.appendChild(t)}return ce=pe,de=i,pe=n.id,e.appendChild(i),O.appendChild(e),O.scrollTop=O.scrollHeight,i}}function he(){if(W.value.length>0||"chat"==oe()){let n="";"chat"==oe()&&(n+=ee()+"#",P.style.display="none",D=void 0),n+=W.value,e=n,gn.emit("message",e),W.value=""}var e}function me(e,n){let t=h(e);t||(t={username:"Unknown",id:-1,color:"black"}),ue(n,t),function(e,n){let t=re[2];if(!t.focused){let e=t.querySelector(".card-notifier");e?e.innerText=parseInt(e.innerText)+1:(e=document.createElement("div"),e.className="card-notifier",t.appendChild(e),e.innerText=1),t.style.animation="",t.offsetWidth,t.style.animation="attention 0.2s"}}()}function ge(){W.blur(),Ae(),function(e){Tt=false;let n=document.querySelectorAll(".menuHidable");n.length&&n.forEach((e=>{e.style.visibility="visible"}))}()}function fe(e){let n=document.createElement("div");n.className="chat-divider";let t=document.createElement("p");t.innerText=e,n.appendChild(t),O.appendChild(n)}function ve(e){O&&j&&(e?(O.style.height="calc(100vh - 100px)",j.style.bottom="100px"):(O.style.height="calc(100vh - 64px)",j.style.bottom="0px"))}var xe,ye,be,we,ke=!1,Ee=1,_e=!1,Se=0,Ce=void 0,Le={x:0,y:0};function ze(e){let n=re[e];n&&(n.classList.add("cardMax"),n.focused=!0,n.style.zIndex=0,Object.values(n.children).forEach((e=>{"card-notifier"==e.className?e.remove():e.style.display="initial"})),"chatCard"==n.id&&(Ut(),W.focus()),Yt(n.id),-1==n.spot?(be.style.top="32px",be.style.left="32px"):(be.style.top=n.style.top,be.style.left=n.style.left),be.spot=n.spot,setTimeout((()=>{be.style.opacity="1",be.style.pointerEvents="auto"}),100),se=n)}function Ae(){console.log("close called"),se&&(console.log("focused close called"),se.classList.remove("cardMax"),se.style.zIndex=2,se.focused=void 0,Yt(void 0),Object.values(se.children).forEach((e=>{"card-notifier"==e.className?e.style.display="initial":e.style.display="none"})),be.style.opacity="0",be.style.pointerEvents="none",be.spot=-1),_e&&(_e=!1,He())}function Te(){clearTimeout(ye),ye=setTimeout((function(){He(),Ii()}),250)}function Me(e){let n=0,t=[],i=0==Ee||2==Ee;e?(n=re.length,t=re):re.forEach((e=>{-1!=e.spot&&(t.push(e),n++)})),i?(ae.style.height=64*(n>0?n:1)+"px",ae.style.width="82px"):(ae.style.width=64*(n>0?n:1)+"px",ae.style.height="82px");let o=ae.getBoundingClientRect();le=o;let r,a=o.width,l=o.height;r=i?l/n:a/n,e||(i?t.sort((function(e,n){return parseInt(e.style.top)-parseInt(n.style.top)})):t.sort((function(e,n){return parseInt(e.style.left)-parseInt(n.style.left)})));for(let s=0;s<n;s++)xe[s]=i?{x:o.left+a/2,y:32+o.top+s*r}:{x:32+o.left+s*r,y:o.top+l/2},Ce&&Ce==t[s]&&(Le=xe[s]),e&&(re[s].spot=s,xe[s].app=t[s]),-1!=be.spot&&t[s].spot==be.spot&&Be(be,xe[s].x,xe[s].y),Be(t[s],xe[s].x,xe[s].y);let s=barHandle.getBoundingClientRect();if(i){let e=s.left+s.width/2;Ne({x:e,y:s.top},{x:e,y:s.bottom})}else{let e=s.top+s.height/2;Ne({x:s.left,y:e},{x:s.right,y:e})}}function qe(){requestAnimationFrame(qe)}function Ne(e,n){e.x,e.y,n.x,n.y}function Ie(e){if(function(e){if(ke){Se++;let n=e.clientX,t=e.clientY,i=window.innerWidth/2,o=window.innerHeight/2,r=n-i,a=t-o,l=i-Math.abs(r)<10,s=o-Math.abs(a)<10,c=Math.atan2(a,r)/Math.PI,d=Math.abs(c);d<.25?(2!=Ee&&(Ee=2,He()),l!=_e&&(_e=l,He())):d<.75?(c<0?3!=Ee&&(Ee=3,He()):1!=Ee&&(Ee=1,He()),s!=_e&&(_e=s,He())):(0!=Ee&&(Ee=0,He()),l!=_e&&(_e=l,He()))}}(e),Ce){if(Se++,Ce.pos={x:e.clientX+Ce.offset.x,y:e.clientY+Ce.offset.y},e.clientY>le.top&&e.clientY<le.bottom&&e.clientX>le.left&&e.clientX<le.right){let e=Le,n={x:e.x-Ce.pos.x,y:e.y-Ce.pos.y};Ce.pos={x:e.x-n.x/3,y:e.y-n.y/3},Ce.moving&&(Ce.moving=void 0,Ce.spot=0,Me())}else Ce.moving||(Ce.moving=!0,Ce.spot=-1,Me());Ce.style.left=Ce.pos.x+"px",Ce.style.top=Ce.pos.y+"px"}}function He(){2==Ee?(ae.style.left=window.innerWidth-(_e?-32:48)+"px",ae.style.top="50%",Me(),barHandle.style.transform="translate(-200%,-50%)",barHandle.style.width="32px",barHandle.style.height="80%",ae.style.borderWidth="0px 0px 0px 6px",ve(!1)):3==Ee?(barHandle.style.transform="translate(-50%,100%)",ae.style.left="50%",ae.style.top=(_e?-32:48)+"px",Me(),barHandle.style.height="32px",barHandle.style.width="80%",ae.style.borderWidth="0px 0px 6px 0px",ve(!1)):1==Ee?(barHandle.style.transform="translate(-50%,-200%)",ae.style.left="50%",ae.style.top=window.innerHeight-(_e?-32:48)+"px",Me(),barHandle.style.height="32px",barHandle.style.width="80%",ae.style.borderWidth="6px 0px 0px 0px",ve(!0)):(barHandle.style.transform="translate(100%,-50%)",ae.style.left=(_e?-32:48)+"px",ae.style.top="50%",Me(),barHandle.style.width="32px",barHandle.style.height="80%",ae.style.borderWidth="0px 6px 0px 0px",ve(!1))}function Fe(e){ke&&(ke=!1,console.log(Se),Se<10&&Ae()),Ce?(Ce.classList.remove("cardMove"),Se<20?(se&&se==Ce&&(Ce.classList.remove("cardMax"),Ce.focused=void 0,se=void 0,Ce.style.zIndex=2),Ae(),ze(Ce.appId)):(Me(),console.log("fix bar also"))):(Me(),console.log("fix bar")),Ce=void 0,Se=0}function Be(e,n,t,i){i||(e.pos={x:n,y:t}),e.style.left=n+"px",e.style.top=t+"px"}function Pe(){var e;(e=document.createElement("style")).innerHTML="\n        .list-item{\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            max-width: calc(100% - 128px);\n            transform: translate(-50%,0);// rotate3d(1,0,0,0deg);\n            margin: 32px 0 16px 0;\n            position: relative;\n            padding: 16px;\n            left: 50%;\n            font-weight: bold;\n            font-size: 2em;\n            text-shadow: 1px 1px 2px black;\n            text-align: center;\n            font-family: 'openBold', serif;\n            transition: 0.2s transform;\n\n        }\n        .list-item span{\n            margin: 32px 0 32px 0;\n        }\n        .list-item:hover{\n            transform: translate(-50%,0) scale(1.05,1.05);// rotate3d(1,0,0,0deg);\n        }\n        .list{\n            width: 100%;\n            height: 100%;\n            position: absolute;\n            overflow-y: scroll;\n        }\n        .list *{\n            user-select: none;\n        }\n        .list-portrait{\n            left: 8px;\n            top: 8px;\n            position: absolute;\n            display: inline-block;\n            width: 64px;\n            height: 64px;\n            border-radius: 32px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            overflow: hidden;\n            box-sizing: border-box;\n            border: white solid 6px;\n            transform: translate(-50%,-50%);\n            transition: left 0.4s;\n        }\n        .bigger-item .list-portrait{\n            left: 50% !important;\n            top: 0px !important;\n        }\n        .login-popin{\n            position: fixed;\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n        }\n        #login-junk{\n            max-width: 500px;\n            height: 300px;\n            transform: translate(-50%,0);\n            position: relative;\n            left: 50%;\n        }\n        .num{\n            margin-left: 0 !important;\n            border-radius: 28px;\n            font-size: 36px;\n            background-color: #0005;\n            width: 56px;\n            height: 56px;\n            display: inline-block;\n            overflow: hidden;\n            cursor: pointer;\n        }\n        .num-row{\n            width: 168px;\n            height: 168px;\n            position: absolute;\n            left: 50%;\n            transform: translate(-50%,0);\n        }\n        input{\n            text-align: center;\n            font-size: 16px;\n            outline: none;\n            border: none;\n            border-bottom: black 6px solid;\n            margin: 16px;\n            background-color: transparent;\n            color: inherit;\n        }\n        ",document.body.appendChild(e);let n=document.querySelector("#login-junk");n.style.display="none";let t=document.createElement("div");t.className="list",we=n.querySelector("input"),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&we.setAttribute("readonly","readonly"),function(e){let n=document.createElement("div");n.className="num-row";for(let e=1;e<=10;e++){let t=document.createElement("div");t.innerText=10==e?0:e,t.className="num",n.appendChild(t),t.addEventListener("click",(e=>{e.stopPropagation,we.value.length<4&&(we.value+=e.target.innerText)}))}let t=document.createElement("div");t.className="num",t.innerText="C",t.addEventListener("click",(e=>{e.stopPropagation(),we.value=""})),n.appendChild(t);let i=document.createElement("div");i.className="num",i.innerText="Go",i.style.backgroundColor="#fff5",i.addEventListener("click",(e=>{e.stopPropagation();let n=e.target.parentElement.parentElement.parentElement.querySelector("span");var t,i;n&&(console.log("login with ",n.innerText,":",we.value),t=n.innerText,i=we.value,fetch("/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:i})}).then((function(e){return e.ok?e.json():void H(e.status+":"+e.statusText,"warn")})).then((function(e){e&&(function(e){if(!(p=d[e]))throw new Error("player doesn't exist")}(e.id),function(){try{window.sysMessage=Nn,window.forceSave=In,_e=!1,He(),console.log("trying auth..."),An=H("attempting communications...","net",!0),(gn=M("/dand-dev")).on("connect",(function(){document.querySelector("#login-menu").style.display="none",console.log("connected"),gn.emit("physInit"),An&&An.remove(),An=void 0})),gn.on("event",(function(e){})),gn.on("disconnect",(function(e){console.log("disconnected ",e),e.includes("disconnect")?document.querySelector("#login-menu").style.display="block":An=H("lost connection, attempting reconnection...","net",!0)})),gn.on("message",(function(e,n){me(e,n)})),gn.on("join",(function(e){fe(e+" has joined!")})),gn.on("terrain",(function(e,n,t){rt(0,t)})),gn.on("physSend",(function(e,n){!function(e,n){let t=ei[e.id];t&&(t.position.copy(e.position),t.quaternion.copy(e.quaternion),n?t.sleep():(t.velocity.copy(e.velocity),t.angularVelocity.copy(e.angularVelocity),t.wakeUp()))}(e,n)})),gn.on("physUpdate",(function(e){Tn?(oi(e),console.log("phys synced")):console.log("!!!phys IGNORED")})),gn.on("physInit",(function(e,n){ni.forEach((e=>{Oi(e)})),ni=[],Object.values(ei).forEach((e=>{Xt.remove(e)})),ei=[],e.forEach(((e,n)=>{ti(e[0],e[1],e[2],{x:0,y:0,z:0},{x:0,y:0,z:0,w:0},e[3],e[4])})),oi(n),Tn=!0})),gn.on("physMake",(function(e,n,t,i,o,r,a){ti(e,n,t,i,o,r,a),console.log("made")})),gn.on("physDel",(function(e){ii(e),console.log("deleted")})),gn.on("updateSheet",(function(e,n){Sn(e,n),console.log("deleted")})),gn.on("sysMessage",(function(e,n){console.log("sysMessage ",e,n),H(e,n)})),fetch("/lastChats",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&(e.array.forEach((e=>{me(e[0],e[1])})),fe("Last 10 messages"))})).catch((e=>{H(e,"error"),console.error("ERROR ",e)})),fetch("/grid",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&e.grid.length>0&&rt(0,e.grid)})).catch((e=>{H(e,"error"),console.error("ERROR ",e)})),fetch("/getSheets",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&function(e){en=e;let n,t=De.querySelector(".sheet-nav");d.forEach((e=>{let i=kn("sheet-user");i.style.backgroundColor=e.color;let o=document.createElement("span");if(o.innerText=e.username,i.appendChild(o),i.setAttribute("data",e.id),i.addEventListener("click",(e=>{let n=parseInt(e.target.getAttribute("data")),t=en[n];t||(H("No Sheet available, loading empty","warn",!1,1500),t=JSON.parse(nn)),ln(t,n),window.scrollTo(0,0),Ke=n,e.target.style.animation="",e.target.offsetWidth,e.target.style.animation="jello 0.4s",Ze.style.animation="",Ze.offsetWidth,Ze.style.animation="jello 0.4s"})),e.id==m().id){Ke=e.id,n=i;let t=en[e.id];t&&ln(t,e.id)}else t.appendChild(i)})),n&&t.insertBefore(n,t.firstChild)}(e.array)})).catch((e=>{H(e,"error"),console.error("ERROR ",e)})),e=m().id,fetch("/getEquipment",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&function(e){e&&0!=e.length?e.forEach((e=>{Ln(e.name,e.description,e.model)})):(Ln("A Man","Good boi","man"),Ln("Cool Rock","It's a cool rock","rock"),Ln("Pot","420","pot"))}(e.array)})).catch((e=>{H(e,"error"),console.error("ERROR ",e)})),function(){let e=document.querySelector(".canvasHolder");window.addEventListener("pointermove",Rt),e.addEventListener("pointerdown",Bt),window.addEventListener("pointerup",Pt),window.addEventListener("contextmenu",jt),window.addEventListener("keyup",Vt)}()}catch(e){H("Stage2 Auth: "+e,"error"),console.log("test")}var e}())})).catch((e=>{H(e,"error"),console.error("ERROR ",e)})))})),n.appendChild(i),e.appendChild(n)}(n);let i=document.querySelector("#login-menu");i.appendChild(t),i.appendChild(n),_e=!0,He(),fetch("/getUsers",{method:"post"}).then((function(e){return e.json()})).then((function(e){e&&(function(e){d=[],e.forEach((e=>{d[e.id]=e}))}(e.users),e.users.forEach((e=>{let n=document.createElement("div");n.className="list-item";let i=e.color;n.style.backgroundColor=i;let o=c(r(i));n.style.color=o?"#000000":"#FFFFFF",n.style.textShadow="1px 1px 2px "+(o?"#FFFFFF":"#000000"),n.addEventListener("click",(e=>{let t=document.querySelector("#login-junk");t.style.display="",t.parentElement.classList.remove("bigger-item"),n.appendChild(t),n.classList.add("bigger-item"),e.stopPropagation(),we.focus()}));let a=document.createElement("div");a.className="list-portrait",n.appendChild(a);let l=document.createElement("span");l.innerText=e.username,n.appendChild(l),t.appendChild(n)})))})).catch((e=>{console.error("ERROR"+e)}))}const Re=[["STR","Athletics","athletics.png"],["DEX","Acrobatics","acrobatics.png"],["DEX","Sleight of Hand","sleight.png"],["DEX","Stealth","stealth.png"],["INT","Arcana","arcana.png"],["INT","History","history.png"],["INT","Investigation","investigation.png"],["INT","Nature","nature.png"],["INT","Religion","religion.png"],["WIS","Animal Handling","animal.png"],["WIS","Insight","insight.png"],["WIS","Medicine","medicine.png"],["WIS","Perception","perception.png"],["WIS","Survival","survival.png"],["CHR","Deception","deception.png"],["CHR","Intimidation","intimidation.png"],["CHR","Performance","performance.png"],["CHR","Persuasion","persuasion.png"]];var De,Oe,We,je,Ve,Ue,Ye,Je,Xe,Ge,Ke,Ze,Qe=!0,$e=!1,en={};const nn=JSON.stringify({traits:[],personality:["","","",""],proficiencies:[],abilities:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],skills:[0,0,0,0,0,0,0,0,0,0,0,0,0,0],character:{name:"Doopy",type:"Bard",proficiency:0,inspiration:"./undefined"}});function tn(e,n){let t=kn("section-item "+e),i=kn("section-item-label"),o=En(0,30);i.innerText=n,t.appendChild(i);let r=kn("centered");r.appendChild(o),t.appendChild(r);let a=kn("section-item-saving-throw"),l=kn("centered"),s=document.createElement("input");s.className="number",s.value=0,s.type="number",s.min=0,s.max=30,l.appendChild(s),a.appendChild(l),t.appendChild(a);let c=kn("skill-link-row");return t.appendChild(c),t}function on(e){let n,t=kn("feature"),i=kn("feature-name"),o=document.createElement("p"),r=document.createElement("input");return r.setAttribute("type","checkbox"),e?(r.checked=e.spell,r.style.display="none",i.innerText=e.name,o.innerText=e.text,n=[],e.tags.forEach((e=>{let t=kn("feature-tag");t.innerText=e,n.push(t)}))):(n=kn("feature-tag"),i.setAttribute("contenteditable",!0),n.setAttribute("contenteditable",!0),o.setAttribute("contenteditable",!0)),t.appendChild(i),e?n.forEach((e=>{t.appendChild(e)})):t.appendChild(n),t.appendChild(o),t.appendChild(r),t}function rn(){$e=!0,De.querySelectorAll(".section-group-mini").forEach((e=>{e.classList.remove("section-group-mini")})),De.querySelectorAll(".number").forEach((e=>{e.disabled=!1,function(e){let n=kn("editable-number"),t=e.getBoundingClientRect();n.style.left=t.width/2-24+e.offsetLeft+"px",n.style.top=t.height/2-24+e.offsetTop+"px",n.addEventListener("touchstart",xn),n.addEventListener("touchmove",yn),n.addEventListener("touchend",bn),n.addEventListener("click",wn),n.host=e,n.range=[parseInt(e.value),parseInt(e.min),parseInt(e.max)],e.parentElement.appendChild(n)}(e)})),Object.values(De.querySelectorAll("p")).forEach((e=>{e.setAttribute("contenteditable",!0)})),Ye.querySelectorAll(".feature").forEach((e=>{let n=e.querySelector("input");n&&(n.style.display="initial");let t=e.querySelector(".feature-name"),i=e.querySelector("p");t&&t.setAttribute("contenteditable",!0),i&&i.setAttribute("contenteditable",!0),e.querySelectorAll(".feature-tag").forEach((e=>{e.setAttribute("contenteditable",!0)}))})),Ge.style.display="initial",Ve.querySelector(".section-banner").setAttribute("contenteditable",!0),De.querySelectorAll(".feature-add").forEach((e=>{e.style.display="block"})),window.scrollTo(0,0)}function an(e){$e=!1,De.querySelectorAll(".section-group").forEach((e=>{e.classList.add("section-group-mini")}));let n={};De.querySelectorAll(".editable-number").forEach((e=>{e.removeEventListener("touchstart",xn),e.removeEventListener("touchmove",yn),e.removeEventListener("touchend",bn),e.addEventListener("mouseup",wn),e.remove()})),De.querySelectorAll(".number").forEach((e=>{e.disabled=!0})),n.traits=[],Ye.querySelectorAll(".feature").forEach((e=>{let t={},i=e.querySelector(".feature-name"),o=e.querySelector("p");if(!i&&!o||0==i.innerText.length&&0==o.innerText.length)e.remove();else{t.name=i.innerText,t.text=o.innerText,t.tags=[],e.querySelectorAll(".feature-tag").forEach((e=>{e.setAttribute("contenteditable",void 0),e.innerText.length>0?t.tags.push(e.innerText):e.remove()}));let r=e.querySelector("input");r&&(r.checked?(t.spell=!0,e.classList.remove("trait"),e.classList.add("spell")):(e.classList.add("trait"),e.classList.remove("spell")),r.style.display="none"),i.setAttribute("contenteditable",void 0),o.setAttribute("contenteditable",void 0),n.traits.push(t)}})),n.personality=[],je.querySelectorAll("p").forEach((e=>{e.setAttribute("contenteditable",!1),n.personality.push(e.innerText)})),n.proficiencies=[],Ue.querySelectorAll("p").forEach((e=>{e.innerText.length>0?(n.proficiencies.push(e.innerText),e.setAttribute("contenteditable",!1)):e.parentElement.remove()})),n.abilities=[],We.querySelectorAll(".section-item").forEach((e=>{let t=e.querySelectorAll(".number");n.abilities.push([t[0].value,t[1].value])})),n.skills=[],We.querySelectorAll(".skill-item").forEach((e=>{n.skills.push(e.querySelector("input").value)})),n.status=[],Oe.querySelectorAll(".number").forEach((e=>{n.status.push(e.value)}));let t=Oe.querySelectorAll(".saving-row"),i=t[0].querySelectorAll("input"),o=t[1].querySelectorAll("input");n.successes=[i[0].checked,i[1].checked,i[2].checked],n.failures=[o[0].checked,o[1].checked,o[2].checked],n.character={};let r=Ve.querySelector(".section-banner"),a=Ve.querySelector(".character-class"),l=Ve.querySelector(".number");"character"==oe()&&Ge.click(),Ge.style.display="none";let s=Ve.querySelector(".character-inspiration").querySelector("img");var c,d;return n.character.name=r.innerText,r.setAttribute("contenteditable",!1),n.character.type=a.innerText,a.setAttribute("contenteditable",!1),n.character.proficiency=l.value,n.character.inspiration=s.src,De.querySelectorAll(".feature-add").forEach((e=>{e.style.display="none"})),window.scrollTo(0,0),console.log(n),window.tempy=JSON.stringify(n),e||(c=Ke,d=n,gn.emit("updateSheet",c,d),Sn(Ke,n)),n}function ln(e,n){if(Ye.querySelectorAll(".feature").forEach((e=>{e.remove()})),e.traits&&e.traits.forEach((e=>{Ye.insertBefore(on(e),Je)})),e.personality&&je.querySelectorAll("p").forEach(((n,t)=>{n.innerText=e.personality[t]})),Ue.querySelectorAll("p").forEach((e=>{e.remove()})),e.proficiencies&&e.proficiencies.forEach((e=>{let n=kn("feature");n.innerText=e,Ue.insertBefore(n,Xe)})),e.abilities&&We.querySelectorAll(".section-item").forEach(((n,t)=>{let i=n.querySelectorAll(".number");i[0].value=e.abilities[t][0]?e.abilities[t][0]:0,i[1].value=e.abilities[t][1]?e.abilities[t][1]:0})),e.skills&&We.querySelectorAll(".skill-item").forEach(((n,t)=>{n.querySelector("input").value=e.skills[t]})),e.character){let t=Ve.querySelector(".section-banner"),i=Ve.querySelector(".character-class"),o=Ve.querySelector(".number"),r=Ve.querySelector(".character-inspiration").querySelector("img");if(t.innerText=e.character.name,null!=n){let e=h(n);e&&(t.style.backgroundColor=e.color)}i.innerText=e.character.type,e.character.proficiency&&(o.value=e.character.proficiency),r.src=e.character.inspiration}if(e.status&&Oe.querySelectorAll(".number").forEach(((n,t)=>{n.value=e.status[t]?e.status[t]:0})),e.successes&&e.failures){let n=Oe.querySelectorAll(".saving-row"),t=n[0].querySelectorAll("input"),i=n[1].querySelectorAll("input");for(let n=0;n<3;n++)t[n].checked=e.successes[n],i[n].checked=e.failures[n]}window.scrollTo(0,0)}var sn,cn,dn,pn,un,hn,mn,gn,fn={x:0,y:0},vn=!1;function xn(e){e.target,cn=e.target.host,sn.style.display="none",fn={x:e.touches[0].clientX,y:e.touches[0].clientY},e.target.className="floater-arrow",e.target.range[0]=parseInt(cn.value),setTimeout((function(){vn=!0}),200),vn=!1}function yn(e){if(fn){let n=!0,t=e.touches[0].clientX-fn.x,i=0;t>24||t<-24?(t=Math.max(-96,Math.min(t,96)),t<-24?(n=!1,i=(e.target.range[1]-e.target.range[0])*((Math.abs(t)-24)/72)):i=(e.target.range[2]-e.target.range[0])*((t-24)/72)):t=0,console.log(t),cn.value=Math.round(e.target.range[0]+i),e.target.style.transform="translate("+t+"px)"+(n?" rotate(180deg)":"")}}function bn(e){fn=!1,e.target.className="editable-number",e.target.style.transform="translate(0)",vn||function(e){sn.style.display="block";let n=e.getBoundingClientRect();sn.style.left=-48+n.left+"px",sn.style.top=n.top+"px"}(e.target)}function wn(e){e.target,cn=e.target.host,e.target.host.focus()}function kn(e){let n=document.createElement("div");return e&&(n.className=e),n}function En(e,n){let t=document.createElement("input");return t.className="number",t.value=0,t.type="number",t.min=e,t.max=n,t}function _n(e){$e||(De.querySelectorAll(".section-group").forEach((n=>{e.target!=n&&n.classList.add("section-group-mini")})),e&&e.target.classList.toggle("section-group-mini"))}function Sn(e,n){en[e]=n}function Cn(e){pn.style.left=e.clientX+"px",pn.style.top=e.clientY+"px"}function Ln(e,n,t){let i=function(e){let n=document.createElement("div");return n.className=e,n}("equipment-item");e||(e="undefined");let o=document.createElement("h4");o.innerText=e;let r=document.createElement("p");r.innerText=n||"stuff";let a=document.createElement("img");a.className="equipment-icon",t&&(i.setAttribute("data",t),a.setAttribute("src",T(t))),i.appendChild(o),i.appendChild(a),i.appendChild(r),i.addEventListener("pointerdown",(e=>{pn.children.length&&pn.children[0].remove(),(hn=i).classList.add("equipment-item-selected"),pn.appendChild(i.cloneNode(!0)),Cn(e)})),i.addEventListener("pointerup",(e=>{let n=document.elementFromPoint(e.clientX,e.clientY);(n.classList.contains("equipment-item")||(n=n.parentElement,n.classList.contains("equipment-item")))&&(console.log("up"+n.innerText),hn&&(hn.classList.remove("equipment-item-selected"),un.insertBefore(hn,n),hn=void 0),pn.children.length&&pn.children[0].remove())})),un.appendChild(i),mn&&(clearTimeout(mn),mn=void 0),mn=setTimeout((()=>{let e=[];dn.querySelectorAll(".equipment-item").forEach((n=>{e.push(zn(n))})),function(e,n){gn.emit("sendEquipment",e,n)}(m().id,e),console.log("send equipment "+e.length)}),2e3)}function zn(e){let n={},t=e.querySelector("h4"),i=e.querySelector("p"),o=e.getAttribute("data");return t&&(n.name=t.innerText),i&&(n.description=i.innerText),o&&(n.model=o),n}var An,Tn=!1;function Mn(e,n,t,i,o,r){gn.emit("physMake",e,n,t,i,o,r)}function qn(e,n){gn.emit("physSend",{id:e.id,position:e.position,velocity:e.velocity,quaternion:e.quaternion,angularVelocity:e.angularVelocity},n)}function Nn(e,n){gn.emit("sysMessage",e,n)}function In(){gn.emit("forceSave")}var Hn=[],Fn=[],Bn=[];var Pn,Rn,Dn,On=2;function Wn(e){e?Ri(Dn):Oi(Dn)}function jn(e,n,t){Bn[e][n]=t,Vn()}function Vn(){tt=6,Yn();for(let n=0;n<Bn.length;n++)for(let t=0;t<Bn.length;t++){let i=Bn[n][t],o=Math.floor(it(1,4)),r=Math.floor(it(1,6));if(1!=i){let o,a,l,s,c,d;o=n>0?Bn[n-1][t]:0,a=n<Bn.length-1?Bn[n+1][t]:0,t<Bn.length-1?(l=n>0?Bn[n-1][t+1]:0,s=Bn[n][t+1]):(l=0,s=0),t>0?(c=Bn[n][t-1],d=n<Bn.length-1?Bn[n+1][t-1]:0):(c=0,d=0),o=o==i,a=a==i,s=s==i,d=d==i,c=c==i,l=l==i;let p=-1,u=0,h=[],m=5;[l,s,a,d,c,o].forEach(((e,n)=>{e?(h.push(n),-1==p&&(p=n),u=n):m=n}));let g="N",f="";if(6==h.length)Un(i,"H"+f,n,t,Math.floor(r));else if(h.length>0){let o=[];var e=h[0];for(let n=1;n<h.length;n++)o.push(h[n]-e-1),e=h[n];let r=-1==p?0:p;switch(h.length){case 1:g="E",r+=0;break;case 2:g="P",0==o[0]?(f="3",r+=0):1==o[0]?(f="2",r+=0):2==o[0]?(f="1",r+=0):3==o[0]?(f="2",r+=4):(f="3",r+=5);break;case 3:g="T",0==o[0]?0==o[1]?(f=1,r+=0):3==o[1]?(f=1,r+=5):1==o[1]?(f=3,r+=3):2==o[1]&&(f=2,r+=4):1==o[0]?0==o[1]?f=2:1==o[1]?f=4:2==o[1]&&(f=3,r+=2):2==o[0]?0==o[1]?(f=3,r+=0):1==o[1]&&(f=2,r+=3):(f=1,r+=4),r%=6;break;case 4:g="Q",0==o[0]?0==o[1]?0==o[2]?(f=1,r+=0):1==o[2]?(f=3,r+=2):2==o[2]&&(f=1,r+=5):1==o[1]?0==o[2]?(f=2,r+=4):1==o[2]&&(f=3,r+=1):(f=1,r+=4):1==o[0]?0==o[1]?0==o[2]?(f=3,r+=4):f=2:f=3:(f=1,r+=3),r%=6;break;case 5:g="F",r=m+1}Un(i,g+f,n,t,r)}else Un(i,"N",n,t,0)}else 1==i&&Un(i,"O"+o,n,t,Math.floor(r))}}function Un(e,n,t,i,o){let r=8*Math.sqrt(3)/2,a="Grass_";switch(e){case 1:a="Grass_";break;case 0:a="Water_";break;case 3:a="Mount_";break;case 4:a="Tree_";break;case 5:a="House_"}let l=Hn[a+n];if(l){let e=l.clone();e.position.set(t*r*2-48+i*r,8*i*1.5,-1.6),o&&(o=6-o,e.rotation.z=o*Math.PI/3),Fn.push(e),Ri(e)}else console.log("invalid model "+a+n)}function Yn(){Fn.forEach((e=>{Oi(e)})),Fn=[]}function Jn(e,n){let t=8*Math.sqrt(3)/2,i=Math.floor((8+n)/12),o=Math.floor((e+48+8-i*t)/(2*t));return Pn.position.set(o*t*2-48+i*t,8*i*1.5,.8),[o,i]}let Xn={x:0,y:0},Gn=0;var Kn,Zn,Qn,$n,et,nt,tt=6;function it(e,n){return(n=n||0)+(tt=(9301*tt+49297)%233280)/233280*((e=e||1)-n)}function ot(e){return Hn[e].clone()}function rt(e,n){Bn=st(n),Vn()}function at(e){Pn.visible=e}function lt(e){let n="";for(let t=0;t<e.length;t++)for(let i=0;i<e.length;i++)n+=String.fromCharCode(e[t][i]+48);return n}function st(e){let n=[];for(let t=0;t<32;t++){n[t]=[];for(let i=0;i<32;i++)n[t][i]=e.charCodeAt(32*t+i)-48}return n}var ct=2048;Math.PI;let dt,pt=1,ut=-.001;function ht(e){let n;switch(e){case 4:n=600,Zn.shadow.camera.far=1200,Zn.shadow.mapSize.width=ct,Zn.shadow.mapSize.height=ct,dt=100,Zn.position.z=600;break;case 3:n=300,Zn.shadow.camera.far=600,Zn.shadow.mapSize.width=ct,Zn.shadow.mapSize.height=ct,dt=100,Zn.position.z=300;break;case 2:n=120,Zn.shadow.camera.far=240,Zn.shadow.mapSize.width=ct,Zn.shadow.mapSize.height=ct,dt=40,Zn.position.z=120;break;case 1:n=75,Zn.shadow.camera.far=150,Zn.shadow.mapSize.width=ct,Zn.shadow.mapSize.height=ct,dt=25,Zn.position.z=75;break;default:n=30,Zn.shadow.camera.far=60,Zn.shadow.mapSize.width=ct,Zn.shadow.mapSize.height=ct,dt=10,Zn.position.z=30}Zn.shadow.camera.left=-n,Zn.shadow.camera.right=n,Zn.shadow.camera.top=n,Zn.shadow.camera.bottom=-n,Zn.shadow.map&&(Zn.shadow.map.dispose(),Zn.shadow.map=null),Kn&&setTimeout((function(){Kn.update()}),100)}function mt(e){e?Kn?Kn.visible=!0:Ri(Kn=new o.Rki(Zn.shadow.camera)):Kn&&(Kn.visible=!1)}var gt,ft,vt=["man","pot","rock","gran","goblin","hedgehog","werewolf","vampire","zombie","trash","die4","die6","die8","die10","die20"];function xt(){return ft}var yt,bt,wt=t(335),kt=void 0,Et=!1,_t=!1,St=0,Ct=0,Lt=0,zt=0,At=0,Tt=!1,Mt=[],qt=0,Nt=0,It=!1;function Ht(){console.log("p2"),yt.touches={ONE:69,TWO:o.QmN.DOLLY_PAN}}function Ft(){console.log("p1"),yt.touches={ONE:o.QmN.PAN,TWO:o.QmN.DOLLY_ROTATE}}function Bt(e){0==e.button&&(_t=!0),St=e.clientX,Ct=e.clientY}function Pt(e){_t=!1,"landscapeCard"==bt?(Gn=0,Xn.x=0,Xn.y=0):"equipmentCard"==bt&&function(e,n){if(hn){hn.classList.remove("equipment-item-selected"),pn.children.length&&pn.children[0].remove(),hn.style.display="none";let e=zn(hn);if(e){let n={x:Lt,y:zt,z:At};e.player=m(),e&&e.model.startsWith("die")?(e.label="dice",Mn({x:1.2,y:1.2,z:1.2},2,{x:n.x,y:n.y,z:10},si(Math.PI/2),3,e)):Mn({x:1.5,y:1.5,z:3},2,{x:n.x,y:n.y,z:10},si(Math.PI/2),1,e)}hn=void 0}else{let t=-1==ri?void 0:ri;if(t){let i=document.elementFromPoint(e,n);i&&(i=i.closest("#equipment-bar"),i&&(Ln(t.meta.name,t.meta.description,t.meta.model),ii(t.id),Jt()))}}}(St,Ct)}function Rt(e){St=e.clientX,Ct=e.clientY}function Dt(e){let n={x:e.x-Lt,y:e.y-zt,z:e.z-At};switch(Mt.push(n),Mt.length>6&&Mt.shift(),Lt=e.x,zt=e.y,At=e.z,bt){case"landscapeCard":_t||Jn(Lt,zt),(Et||_t)&&function(e,n){let[t,i]=Jn(e,n),o=Bn.length;(t!=Xn.x||i!=Xn.y)&&t>-1&&i>-1&&t<o&&i<o&&(0==Gn&&Bn[t][i]==On?jn(t,i,1):jn(t,i,On),Gn++,Xn.x=t,Xn.y=i,Rn&&(clearTimeout(Rn),Rn=null),Rn=setTimeout((function(){var e;e=lt(Bn),gn.emit("terrain",m().id,0,e)}),2e3))}(Lt,zt);break;case"makerCard":if(Et||_t){let n=xt();if(n)if("trash"==n){let n=li(1,e);null!=n&&(t=n,gn.emit("physDel",t))}else{Et=!1,_t=!1,Wt();let e=n.charAt(0).toUpperCase()+n.slice(1);n.startsWith("die")?Mn({x:1.2,y:1.2,z:1.2},1,{x:Lt,y:zt,z:At+.1},si(Nt),3,{name:e,player:m(),model:n}):Mn({x:1.5,y:1.5,z:3},2,{x:Lt,y:zt,z:At+.1},si(Nt),1,{name:e,player:m(),model:n})}}break;default:Et||_t?(Wt(),1==(qt=function(e,n){if(null==ri){let n=li(2.2,e);if(null!=n)return ri=ei[n],1;ri=-1}else if(-1!=ri){let t=ri;return t.quaternion.setFromAxisAngle(new Zt.Vec3(0,0,1),n),t.position.copy(e),t.position.z+=6,t.sleep(),++ai>10&&(ai=0,qn(t,!0),console.log("send phys ",t.id,JSON.stringify(t.meta))),1}return 0}(e,Nt))&&(yt.reset(),Ht())):qt>-1&&(function(e,n){if(ri&&-1!=ri){let t=ri;t&&(t.wakeUp(),t.position.copy(e),t.velocity.copy(n),t.position.z+=6,ai=0,qn(t,!1),console.log("send phys NOW"))}ri=void 0}(e,Ot()),Jt())}var t}function Ot(){let e={x:0,y:0,z:0};return Mt.forEach((n=>{e.x+=n.x,e.y+=n.y,e.z+=n.z})),e}function Wt(){let e=Ot();Math.sqrt(e.x*e.x+e.y*e.y)>.2&&(Nt=Math.PI/2+Math.atan2(e.y,e.x))}function jt(e){return e.preventDefault(),!1}function Vt(e){if(Ut())return!1;switch(console.log(e.which),e.which){case 13:ze(2);break;case 27:Ae();break;case 49:ht(0);break;case 50:ht(1);break;case 51:ht(2);break;case 52:ht(3);break;case 53:ht(4);break;case 84:case 89:break;case 192:window.pickTarget=i.pick(),window.pickTarget&&console.log("picked a "+window.pickTarget.type)}}function Ut(){return Tt}function Yt(e){switch(bt=e,e){case"makerCard":Ht();break;case"landscapeCard":at(!0),Ht();break;default:Ft()}"landscapeCard"!=e&&at(!1)}function Jt(){qt=-1,_t=!1,Et=!1,Ft(),ri=void 0}var Xt,Gt,Kt,Zt=t(279),Qt=0,$t=[];var ei=[],ni=[];function ti(e,n,t,i,o,r,a){let l,s,c=new Zt.Body({mass:t,material:Kt});switch(r){case 1:l=new Zt.Cylinder(n.x,n.y,n.z,6);break;case 3:l=new Zt.Sphere(n.x),c.angularDamping=.3;break;default:l=new Zt.Box(new Zt.Vec3(n.x,n.y,n.z))}if(c.addShape(l),c.position.set(i.x,i.y,i.z),o&&c.quaternion.copy(o),c.id=e,c.meta=a,ei[e]=c,Xt.addBody(c),a&&a.model){let e=C(a.model,a.player);s=Ji(),a.label||(e.position.z=-n.z/2),e.rotation.x=Math.PI/2,s.add(e),a.label&&"dice"==a.label&&(c.labelDom=ue("dice",{color:a.player.color},s),c.labelDom.mult=parseInt(a.model.substring(3)))}else s=1==r?Vi(n.x,n.y,n.z,i.x,i.y,i.z,a.color):ji(2*n.x,2*n.y,2*n.z,i.x,i.y,i.z,a.color);Ri(s),ni[e]=s,s.physId=e;let d=JSON.parse(JSON.stringify(c.meta));d.player.shader=void 0,console.log("phys ",e,d)}function ii(e){var n;Oi(ni[e]),delete ni[e],ei[e].labelDom&&((n=ei[e].labelDom).bubble.remove(),n.bubble=null),Xt.remove(ei[e]),delete ei[e]}function oi(e){e.forEach((e=>{let n=ei[e[0]];if(n&&(n.position.copy(e[1]),n.quaternion.copy(e[2]),n.velocity.copy(e[3]),n.angularVelocity.copy(e[4]),n.sleepState!=e[5].sleep&&(2==e[5].sleep?n.sleep():2==n.sleepState&&n.wakeUp()),n.labelDom)){let t=e[5].value;n.labelDom.mult&&(t=Math.floor(t*n.labelDom.mult)+1+" / "+n.labelDom.mult),n.labelDom.bubble.innerText=t}}))}var ri,ai=0;function li(e,n){let t,i=e;return ni.forEach((e=>{if(null!=e.physId){let o=e.position.distanceTo(n);o<i&&(t=e.physId,i=o)}})),t}function si(e){let n=new Zt.Quaternion(0,0,0,0);return n.setFromAxisAngle(new Zt.Vec3(0,0,1),e),n}var ci,di,pi,ui,hi,mi,gi,fi,vi,xi,yi,bi,wi,ki,Ei,_i,Si,Ci=t(145),Li=t(38),zi=(t(857),t(596)),Ai=t(26),Ti=[];function Mi(){var e;(ci=new o.cPb(45,window.innerWidth/window.innerHeight,1,5e3)).position.z=200,ci.position.y=-200,ci.up=new o.Pa4(0,0,1),ci.lookAt(new o.Pa4(0,0,0)),pi=new o.xsS,Ui=pi,xi=document.querySelector(".canvasHolder"),(di=new o.CP7({antialias:!0,alpha:!0})).shadowMap.enabled=!0,di.shadowMap.type=o.ntZ,di.toneMapping=o.LY2,di.outputEncoding=o.knz,di.setClearColor(16744242,1),xi.appendChild(di.domElement),fi=new Ci.E,e=o.rDY.merge([o.Vj0.standard.uniforms]),new o.jyz({uniforms:e,derivatives:!1,lights:!0,vertexColors:!0,vertexShader:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec3 shirt;\nuniform vec3 wind;\n\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #ifdef USE_COLOR\n        if(color==vec3(0,0,1))\n            vColor.xyz = shirt;\n        else\n            vColor.xyz = color.xyz;\n        \n    #endif\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n    #ifdef USE_TANGENT\n        vTangent = normalize( transformedTangent );\n        vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n    #endif\n#endif\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    \n        if(color==vec3(1,0,0)){\n            float val=max(0.0, 1.0976 - transformed.z);\n            transformed.xyz+=val*wind;\n            transformed.y*=1.0+sin((wind.z+transformed.z)*4.0)/2.0;\n\n        }\n    \n\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n}",fragmentShader:"\n    #define STANDARD\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <roughnessmap_fragment>\n    #include <metalnessmap_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n    #include <lights_physical_fragment>\n    #include <lights_fragment_begin>\n    #include <lights_fragment_maps>\n    #include <lights_fragment_end>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n    gl_FragColor = vec4( outgoingLight,1.-(((0.2125 * outgoingLight.r) + (0.7154 * outgoingLight.g) + (0.0721 * outgoingLight.b)) ) );\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n    #include <dithering_fragment>\n}",roughness:0,metalness:1}),Ui=pi,hi=ci,Ii(),yi=new Li.x(di);let n=new zi.G(pi,ci,300,200);n.kernelRadius=6,n.minDistance=15e-5,n.maxDistance=.001,yi.addPass(n),window.ssao=n,new o.vBJ({color:7722446}),new o.Wid({color:2156703,metalness:0,roughness:1}),new o.Wid({color:2156703,metalness:0,roughness:1}),new o.Wid({color:5534117,metalness:0,roughness:1});let t=new o.Wid({color:15398690,metalness:0,roughness:1});bi=new o.Wid({color:13576926,metalness:0,roughness:1}),new o.Wid({color:11930379,metalness:0,roughness:1}),new o.Wid({color:15398690,metalness:0,roughness:1}),ui=new o.ZAu,wi=new o.ZAu;let i=new o.vBJ({color:16777215,side:o.Wl3}),r=new o.vBJ({color:3282968,side:o.Wl3}),a=Wi(1,1,2,0,0,0,t),l=Wi(1,.2,1,0,.5,.5,i),s=Wi(.3,.2,.3,0,.6,.5,r);wi.add(a),wi.add(l),wi.add(s),ui.add(wi);let c=Wi(.5,.5,1.5,.75,0,20,new o.vBJ({color:14035807}));ui.add(c),pi.add(ui),function(){let e=new o.zf8(1,8);Ei=new o.vBJ({color:4907322}),new o.vBJ({color:15461888}),(ki=new o.Kj0(e,Ei)).position.z=.05,pi.add(ki),new o.iMs}(),new o.Pa4(1,0,0),et=new o.Pa4(0,0,0),Di(nt=new o.Mig(9408399)),(Zn=new o.Ox3(14702423,.5)).position.set(0,250,0),Zn.castShadow=!0,Di(Zn),($n=new o.Tme).position.set(20,0,20),Di($n),Zn.target=$n,Zn.shadow.mapSize.width=ct,Zn.shadow.mapSize.height=ct,Zn.shadow.camera.near=1,ht(0),Zn.shadow.radius=2.2,Zn.shadow.bias=-5e-4,(Qn=Zn.clone()).shadow.mapSize.width=256,Qn.shadow.mapSize.height=256,Qn.shadow.radius=0,Qn.visible=!1,Di(Qn),window.sunLight=Zn,mt(!0),function(e,n,t,i){!function(e,n){(yt=new wt.z(n,e)).callbackCounts=e=>{1==e?kt=setTimeout((function(){Et=!0}),100):kt&&clearTimeout(kt)},yt.mouseButtons={LEFT:void 0,MIDDLE:o.RsA.ROTATE,RIGHT:o.RsA.PAN},yt.maxPolarAngle=1.3,yt.isControl(),Ft(),yt.addEventListener("change",(function(e){var n,t=yt.target.distanceTo(yt.object.position);t<30?(0!=It&&ht(0),It=0):t<100?(1!=It&&ht(1),It=1):t<180?(2!=It&&ht(2),It=2):(3!=It&&ht(3),It=3),n=yt.target,et.set(n.x,n.y,n.z),Zn.position.x=n.x,$n.position.x=n.x})),yt.addEventListener("end",(function(e){kt&&clearTimeout(kt),Et=!1}))}(n,t)}(0,xi,ci);let d=new o.vBJ({color:16711680}),p=new o.vBJ({color:16746496}),u=new o.vBJ({color:16776960}),h=new o.vBJ({color:65280}),m=new o.vBJ({color:255}),g=new o.vBJ({color:8913151}),f=new o.nvb(1,1,1);return Si=new o.Kj0(f,[d,p,u,h,m,g]),setTimeout((function(){Hi()}),1),xi}function qi(e){e&&!_i&&(_i=new Ai.O(pi,Xt))}function Ni(e,n,t,i){fi.load("./"+e,(e=>{let r;if(e.scene.rotation.x=Math.PI/2,e.scene.traverse((function(e){e instanceof o.Kj0&&(r=e,t||(e.material=i?new o.Wid({color:i,metalness:0,roughness:1}):new o.Wid({vertexColors:o.jSK,metalness:0,roughness:1}),e.material.needsUpdate=!0))})),e.scene.children[0],r){var a=e.animations;if(a&&a.length){vi=new o.Xcj(r);for(var l=0;l<a.length;l++){var s=a[l];let e=vi.clipAction(s);e.timeScale=.002,e.play()}}}n(e.scene)}),(e=>{console.log(e.loaded/e.total*100+"% loaded")}),(e=>{console.error("An error happened",e)}))}function Ii(){window.screen.width>window.innerWidth?(mi=window.innerWidth,gi=window.innerHeight):(mi=window.screen.width,gi=window.screen.height),ci.aspect=mi/gi,ci.updateProjectionMatrix(),di.setPixelRatio(.5),di.setSize(mi,gi)}function Hi(e){(function(){Xt.step(.03333333333333333);let e=Object.values(ei);for(var n=0;n!==e.length;n++)if(null!=e[n].id){let t=ni[e[n].id];t.position.copy(e[n].position),t.quaternion.copy(e[n].quaternion)}let t=yt.object.rotation.z,i=Gt.velocity.length();Ki.left?(i<2&&(Gt.velocity.x-=2*Math.cos(t),Gt.velocity.y-=2*Math.sin(t)),Qt=t+Math.PI/2,Gt.quaternion.setFromAxisAngle(new Zt.Vec3(0,0,1),Qt)):Ki.right?(i<2&&(Gt.velocity.x+=2*Math.cos(t),Gt.velocity.y+=2*Math.sin(t)),Qt=t-Math.PI/2,Gt.quaternion.setFromAxisAngle(new Zt.Vec3(0,0,1),Qt)):Ki.up?(i<2&&(Gt.velocity.x-=2*Math.sin(t),Gt.velocity.y+=2*Math.cos(t)),Qt=t,Gt.quaternion.setFromAxisAngle(new Zt.Vec3(0,0,1),Qt)):Ki.down&&(i<2&&(Gt.velocity.x+=2*Math.sin(t),Gt.velocity.y-=2*Math.cos(t)),Qt=t+Math.PI,Gt.quaternion.setFromAxisAngle(new Zt.Vec3(0,0,1),Qt)),wi.position.copy(Gt.position),wi.quaternion.copy(Gt.quaternion)})(),ui.rotation.z>Math.PI/16||(ui.rotation.z,Math.PI),function(){var e=new o.Pa4;e.set(St/window.innerWidth*2-1,-Ct/window.innerHeight*2+1,.5),e.unproject(ci);var n=e.sub(ci.position).normalize(),t=-ci.position.z/n.z,i=ci.position.clone().add(n.multiplyScalar(t));ki.position.x=i.x,ki.position.y=i.y,ki.position.z=i.z+.5,Dt(ki.position)}(),function(){pt+=ut,pt<0?(pt=0,ut=-ut):pt>1&&(pt=1,ut=-ut),pt&&(Zn.color.setHex(16777215),nt.color.setHex(6316128),Yi(11594237,1));let e=dt*pt;$n.position.y=et.y-e,Zn.position.y=et.y+e}(),_i&&_i.update(),di.render(Ui,hi),Ti.length>0&&Ti.forEach(((e,n)=>{Pi(e,n)})),requestAnimationFrame(Hi)}function Fi(e,n){di.setSize(128,128),di.setClearColor(16777215,0),e&&n?di.render(e,n):di.render(getScene(),ci);let t=di.domElement.toDataURL();return di.setSize(mi,gi),t}function Bi(e,n){let t={host:e,bubble:n,x:0,y:0,offset:0};return Ti.forEach((n=>{n.host==e&&(n.offset-=40)})),Ti.push(t),console.log(Ti.length+" anchors"),Pi(t,Ti.length-1),t}function Pi(e,n){if(!e.bubble)return Ti.splice(n,1),!1;if(e.host){let n=function(e){var n=mi/2,t=gi/2;let i=e.position.clone();return i.z+=4,i.project(ci),i.x=i.x*n+n,i.y=-i.y*t+t,i}(e.host);e.bubble.style.left=-16+n.x+"px",e.bubble.style.top=40+e.offset+n.y+"px",e.x=n.x,e.y=n.y}}function Ri(e){ui.add(e)}function Di(e){pi.add(e)}function Oi(e){ui.remove(e)}function Wi(e,n,t,i,r,a,l){let s=new o.nvb(e,n,t);l||(l=bi);let c=new o.Kj0(s,l);return c.castShadow=!0,c.position.x=i||0,c.position.y=r||0,c.position.z=a||0,c}function ji(e,n,t,i,r,a,l){return Wi(e,n,t,i,r,a,l=l?new o.vBJ({color:l}):bi)}function Vi(e,n,t,i,r,a,l){let s=new o.fHI(e,n,t,6);l=l?new o.vBJ({color:l}):bi,s.rotateX(Math.PI/2),s.rotateZ(Math.PI/2);let c=new o.Kj0(s,l);return c.castShadow=!0,c.position.x=i||0,c.position.y=r||0,c.position.z=a||0,c}var Ui=0;function Yi(e,n){di.setClearColor(e,n)}function Ji(){return new o.ZAu}let Xi;function Gi(e,n,t,i){let o,r=document.createElement("div"),a=document.createElement("div");if(a.classList.add("switch"),t&&(o=settingsObject[t]),i){o!=i[0]&&(o!=i[i.length-1]?a.classList.add("switchHalf"):a.classList.add("switchOn")),a.setAttribute("value",o);let e=0;for(let n=0;n<i.length;n++)i[n]==o&&(e=n);a.setAttribute("index",e),a.addEventListener("click",(function(e){e.stopPropagation();let t=a.getAttribute("index");t++,t>=i.length&&(t=0),0==t?a.classList.remove("switchOn"):t==i.length-1?(a.classList.remove("switchHalf"),a.classList.add("switchOn")):a.classList.add("switchHalf");let o=i[t];a.setAttribute("value",o),a.setAttribute("index",t),n(o)}))}else o&&a.classList.add("switchOn"),a.addEventListener("click",(function(e){e.stopPropagation(),a.classList.contains("switchOn")?(a.classList.remove("switchOn"),n(!1)):(a.classList.add("switchOn"),n(!0))}));r.appendChild(a);let l=document.createElement("span");l.innerHTML=e,r.appendChild(l),Xi.appendChild(r),n(o)}var Ki;!function(){var e,n;e=document.querySelector("#main"),(n=document.createElement("style")).innerHTML='\n\t\t.uiSysTop{\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tposition: relative;\n\t\tmax-width: 600px;\n\t\theight: 64px;\n\t\tborder-radius: 32px;\n\t\ttransform: translate(-50%);\n\t\tbox-shadow: 3px 3px 3px #0005;\n\t\tleft: 50%;\n\t\tbackground: #E0F9D5;\n\t\tmargin: 12px;\n\t\tanimation: uiSysUnfold 1s;\n\t\toverflow: hidden;\n\t\tline-height: 16px;\n\t}\n\t.uiSysTop div{\n\n\t\tmargin: 16px;\n\t\tmargin-left: 0px;\n\t\tflex: 0 0 64px;\n\t}\n\t.uiSysTop span{\n\t\tmargin-right: 48px;\n\t\tmargin-top: 8px;\n\t\tline-height: normal;\n\t\tvertical-align: middle;\n\t\tflex: 1;\n\n\t}\n\t@keyframes uiSysUnfold{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t100%{\n\t\t\ttop: 0px;\n\t\t}\n\t}\n\t@keyframes uiSysFold{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t\theight: 0;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t0%{\n\t\t\ttop: 0px;\n\n\t\t}\n\t}\n\t@keyframes uiSysMini{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\n\t\t}\n\t\t0%{\n\t\t\t\n\t\t}\n\t}\n\t@keyframes uiSysMax{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t100%{\n\t\t\tleft: 50%;\n\t\t}\n\t}\n\n\t.uiHolderSysTop{\n\t\twidth: 600px;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%);\n\t\t/*border: 3px #0999 dotted;*/\n\t\ttransition: height 1s;\n\t}\n\t.uiIcon{\n\t\tfloat: left;\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:32px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z"/></svg>\');\n\t}\n\t.uiIconWarning{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>\') !important;\n\t}\n\t.uiIconError{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>\') !important;\n\t}\n\t.uiIconNet{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"/></svg>\') !important;\n\t}\n\t.uiIconPerson{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>\') !important;\n\t\t\n\t}\n\t.uiIconTime{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/></svg>\') !important;\n\t}\n\n\t.uiIconSuccess{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>\') !important;\n\t}\n\t\n\t.uiCloseButton{\n\t\tposition: absolute;\n\t\tright: 0;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:16px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\');\n\t\t\n\t}\n\n\t.uiCursorMessage{\n\t\tmin-width: 64px;\n\t\theight: 64px;\n\t\tborder: 5px solid white;\n\t\tbackground-color: #FBAB7E;\n\t\tbackground-image: linear-gradient(270deg, #FBAB7E 0%, #F7CE68 100%);\n\n\t\tcolor: white;\n\t\tfont-size: 24px;\n\t\tfont-weight: bold;\n\t\tfont-stretch: ultra-condensed;\n\t\ttransform: translate(-50%,-50%);\n\t\tanimation: uiWobble 0.3s;\n\t\tborder-radius: 32px;\n\t\tbox-sizing: border-box;\n\t\tposition: absolute;\n\t\tline-height: 48px;\n\t\tpadding: 0 8px 0 8px;\n\t\tfont-family: sans-serif;\n\t}\n\n\t@keyframes uiWobble{\n\t\t0%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.6,0.4);\n\t\t}\n\t\t33%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.9,1.15);\n\t\t}\n\t\t66%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.8,0.9);\n\t\t}\n\t\t100%{\n\n\t\t}\n\t}\n\n\t@keyframes uiFade{\n\t\t0%{\n\t\t\topacity: 1;\n\t\t\ttransform: translate(-50%,-50%);\n\t\t}\n\t\t100%{\n\t\t\topacity: 0;\n\t\t\ttransform: translate(-50%,0%)\n\t\t}\n\t}\n\n\t.confetti{\n\t\tpointer-events: none;\n\t\tleft:200px;\n\t\ttop:200px;\n\t\twidth:50px;\n\t\theight:50px;\n\t\tposition: absolute;\n\t\tstroke-width:40px;\n\t\t/*background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 100 100" style="fill:none;stroke:lightgray;stroke-linecap:round;"><path d="M45 65L75 75M45 50L75 50M45 35L75 25" /></svg>\');\n\t\tbackground-size: cover;\n\t\tbackground-position: center;\n\t  \tbackground-repeat: no-repeat;*/\n\t}\n\t.confetti svg{\n\t\tposition: relative;\n\t\tanimation: dooter 0.5s forwards;\n\t\ttransform: translate(-50%,-50%);\n\t\twidth: 50px;\n\t\theight: 50px;\n\t}\n\t@keyframes dooter{\n\t\tfrom{\n\t\t\ttransform: translate(0%,0%) scale(0.1,0.1);\n\t\t\tstroke-width:30;\n\t\t}\n\t\tto{\n\t\t\ttransform: translate(100%,0%) scale(3,3);\n\t\t\tstroke-width:0;\n\t\t\tfilter:hue-rotate(270deg);\n\t\t}\n\t}\n\n\t',document.body.appendChild(n),e?q=e:(q=document.querySelector("#main"),q||(q=document.body)),q?(N=document.createElement("div"),N.className="uiHolderSysTop",q.appendChild(N),I=document.createElement("input"),I.type="text",I.style.position="fixed",I.taxindex="-1",I.style.display="none",I.style.pointerEvents="none",q.appendChild(I)):console.error("UI.js:: uh oh! no system dom element found");try{Ki={},window.onError=function(e,n,t,i,o){H(e,"error")},function(){window.randTest=$t,(Xt=new Zt.World).quatNormalizeSkip=0,Xt.quatNormalizeFast=!1,Xt.allowSleep=!0,Xt.gravity.set(0,0,-10),Xt.broadphase=new Zt.NaiveBroadphase,Kt=new Zt.Material("basicMaterial");const e=new Zt.ContactMaterial(Kt,Kt,{friction:.2});Xt.addContactMaterial(e);let n=new Zt.Box(new Zt.Vec3(1,1,2));for(let e=0;e<1;e++){let e=new Zt.Body({mass:4});e.addShape(n),e.position.set(0,0,60),Xt.addBody(e),Gt=e,window.playerBody=Gt}new Zt.Material({name:"gooProperty",friction:10,restitution:-1}).name="gooProperty",new Zt.Material({name:"wallProperty",friction:.1,restitution:1}).name="wallProperty",function(){let e=new Zt.Plane,n=new Zt.Body({mass:0,material:Kt});n.addShape(e),Xt.addBody(n)}()}(),Mi(),window.updateTerrain=rt,window.compress=lt,window.decompress=st,Ni("./assets/models/Hex.glb",(e=>{console.log("got children "+e.children.length);let n=new o.Wid({vertexColors:o.jSK,metalness:0,roughness:1});for(let t=0;t<e.children.length;t++){let i=e.children[t];i.position.set(0,0,60),i.scale.set(8,8,8),i.material=n,i.receiveShadow=!0,(i.name.startsWith("Mount")||i.name.startsWith("Tree")||i.name.startsWith("House"))&&(i.castShadow=!0),Hn[i.name]=i;let o=[];if(i.geometry){let e=i.geometry.attributes.color.array.length/4;for(let n=0;n<e;n++){let e=4*n,t=s(i.geometry.attributes.color.array[0+e],i.geometry.attributes.color.array[1+e],i.geometry.attributes.color.array[2+e]);o[t]=t}}}function t(e,n){e.addEventListener("click",(e=>{console.log("clicking hex");let t=e.target;t.classList.contains("hex")||(t=t.parentElement),t.classList.remove("jelloAnim"),t.offsetWidth,t.classList.add("jelloAnim"),function(e){On=e,console.log("set hex "+On)}(n)}))}let i=document.querySelectorAll(".hex");i[0].appendChild(A(ot("Grass_O1"))),t(i[0],1),i[1].appendChild(A(ot("Tree_N"),75,-75)),t(i[1],4),i[2].appendChild(A(ot("Grass_P1"))),t(i[2],2),i[3].appendChild(A(ot("Mount_N"),90)),t(i[3],3),i[4].appendChild(A(ot("Water_N"))),t(i[4],0),i[5].appendChild(A(ot("House_N"))),t(i[5],5),function(){Yn();for(let e=0;e<32;e++){Bn[e]=[];for(let n=0;n<32;n++)Bn[e][n]=1}}(),Vn()})),function(){let e=new o.vBJ({color:4907322}),n=new o.ZAu,t=new o.BKK(.6,8),i=new o.Kj0(t,e);i.position.set(8,0,0),n.add(i);for(let e=0;e<6;e++){let t=i.clone();t.rotation.z=e*Math.PI/3,t.position.set(8*Math.cos(t.rotation.z),8*Math.sin(t.rotation.z),0),n.add(t)}n.position.z+=6,Ri(n),(Pn=n).visible=!1}(),function(){let e=8*Math.sqrt(3)/2;var n=new o.ZXM;for(let t=0;t<32;t++)for(let i=0;i<32;i++)n.vertices.push(new o.Pa4(-48+e+t*e*2+i*e,8*i*1.5-4,.8)),n.vertices.push(new o.Pa4(-48+e+t*e*2+i*e,4+8*i*1.5,.8)),n.vertices.push(new o.Pa4(-48+e+t*e*2+i*e,4+8*i*1.5,.8)),n.vertices.push(new o.Pa4(t*e*2-48+i*e,8+8*i*1.5,.8)),n.vertices.push(new o.Pa4(t*e*2-48+i*e,8+8*i*1.5,.8)),n.vertices.push(new o.Pa4(-48-e+t*e*2+i*e,4+8*i*1.5,.8));var t=new o.nls({color:16777215});Dn=new o.ejS(n,t)}(),function(){v=new o.xsS,(x=new o.cPb(45,1,1,1e3)).position.z=200,x.position.y=-200,x.up=new o.Pa4(0,0,1),x.lookAt(new o.Pa4(0,0,0));var e=new o.Mig(9408399);v.add(e)}(),function(e){(be=document.querySelector("#closeCard")).spot=-1,be.addEventListener("click",(e=>{Ae()}));let n=document.querySelectorAll(".card");re=[],n.forEach((e=>{re.push(e)})),re.forEach(((e,n)=>{e.style.top=Math.random()*window.innerWidth+"px",e.style.left=Math.random()*window.innerHeight+"px",e.offset={x:0,y:0},e.appId=n,e.addEventListener("pointerdown",(n=>{!function(e,n){e.focused||(Ce=e,e.pos={x:parseInt(e.style.left),y:parseInt(e.style.top)},Le={x:e.pos.x,y:e.pos.y},e.offset={x:e.pos.x-n.clientX,y:e.pos.y-n.clientY},e.classList.add("cardMove"),e.moving=void 0)}(e,n)})),e.addEventListener("dragstart",(e=>{e.preventDefault()}))})),window.addEventListener("pointerup",Fe),window.addEventListener("resize",Te),window.addEventListener("pointermove",Ie),function(){ae=document.querySelector("#bar");let e=document.querySelector("#barHandle");e.addEventListener("pointerdown",(e=>{ke=!0})),e.addEventListener("dragstart",(e=>{e.preventDefault()})),xe=[],e.style.transform="translate(-50%,-200%)",ae.style.left="50%",ae.style.top=window.innerHeight-64+"px",Me(!0)}(),Te(),qe()}(),Pe(),function(){let e=document.querySelector("#chatCard");V=document.querySelector("#projection"),(O=document.createElement("div")).classList.add("chat-pane"),e.appendChild(O),(j=document.createElement("div")).classList.add("chat-bottom"),W=document.createElement("input");let n="0xffff55";n="#"+n.substring(2,n.length),W.style.border=n+" 6px solid",j.appendChild(W),ie(j,"chat");let t=document.createElement("div");t.className="chat-send-button",t.addEventListener("click",he),j.appendChild(t),e.appendChild(j),W.addEventListener("keyup",(function(e){13==e.which?W.value.length>0||"chat"==oe()?he():setTimeout(ge,20):27==e.which&&ge()})),document.createElement("div").classList.add("letterPane")}(),Xi=document.querySelector(".settingsPane"),Gi("Toggle Hex Grid Lines",Wn),Gi("Toggle Light Helper",mt),Gi("Toggle Physics Mesh Helper",qi),gt=document.querySelector("#makerBar"),vt.forEach((e=>{!function(e){let n=function(e){let n=document.createElement("div");return n.className="makerIcon",n}();n.setAttribute("data",e),n.addEventListener("click",(e=>{ft=e.target.getAttribute("data"),e.target.style.animation="",e.target.offsetWidth,e.target.style.animation="jello 0.4s"})),n.innerText=e,gt.appendChild(n)}(e)})),E("pot"),E("rock"),E("goblin","glb"),E("hedgehog","glb"),E("werewolf","glb"),E("vampire","glb"),E("zombie","glb"),E("die4",void 0),E("die6",void 0),E("die8",void 0),E("die10",void 0),E("die20",void 0),k("assets/models/man.gltf",((e,n)=>{var t;e=e.children[0],(g=e).castShadow=!0,g.receiveShadow=!0,e.scale.set(2,2,2),n&&n.forEach((e=>{e.name&&(b[e.name]=e)})),_(e,[1,.2541521191596985,.022173885256052017],[0,0,1]),new o.Pa4(0,0,1),(t=o.rDY.merge([o.Vj0.phong.uniforms,{shirt:{value:new o.Pa4(0,1,0)},wind:{value:new o.Pa4(0,0,0)}}])).ambientLightColor.value=null,(f=new o.jyz({uniforms:t,derivatives:!1,lights:!0,vertexColors:!0,vertexShader:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec3 shirt;\nuniform vec3 wind;\n\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #ifdef USE_COLOR\n        if(color==vec3(0,0,1))\n            vColor.xyz = shirt;\n        else\n            vColor.xyz = color.xyz;\n        \n    #endif\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n    #ifdef USE_TANGENT\n        vTangent = normalize( transformedTangent );\n        vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n    #endif\n#endif\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    \n        if(color==vec3(1,0,0)){\n            float val=max(0.0, 1.0976 - transformed.z);\n            transformed.xyz+=val*wind;\n            transformed.y*=1.0+sin((wind.z+transformed.z)*4.0)/2.0;\n\n        }\n    \n\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n}",fragmentShader:"\n    #define STANDARD\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <roughnessmap_fragment>\n    #include <metalnessmap_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n    #include <lights_physical_fragment>\n    #include <lights_fragment_begin>\n    #include <lights_fragment_maps>\n    #include <lights_fragment_end>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n    #include <dithering_fragment>\n}"})).needsUpdate=!0,f.skinning=!0,w.man=g,f.onBeforeCompile=e=>{e.uniforms.shirt=man.children[1].material.uniforms.shirt,e.vertexShader="uniform vec3 shirt;\n"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>","\n                #ifdef USE_COLOR\n                    if(color.xyz == vec3(0,0,1)){\n                        vColor.xyz = vec3(1,1,0);\n                    }else{\n                        vColor.xyz = color.xyz;\n                    }\n                #endif")}})),k("assets/models/gran.gltf",((e,n)=>{(e=e.children[0]).castShadow=!0,e.receiveShadow=!0,e.scale.set(2,2,2),_(e,[.42869052290916443,.262250691652298,.4677838087081909],[0,0,1]),new o.Pa4(0,0,1),w.gran=e})),function(){var e;(e=document.createElement("style")).innerHTML='\n.drawer-group{\n    position: absolute;\n    top: -204px;\n    width: 128px;\n    left: 50%;\n    transform: translate(-50%,-50%);\n}\n.drawer {\n    display:block;\n    width: 128px;\n    height: 128px;\n    position: relative;\n    border-radius: 8px;\n    border: gray solid 1px;\n    image-rendering: pixelated;\n    touch-action: none;\n    background-color: #5555;\n}\n\n.drawer-top{\nposition: relative;\npointer-events: none;\nwidth: 156px;\n}\n.drawer-top *{\n    pointer-events: initial;\n}\n\n.drawer-paint,\n.drawer-trash,\n.drawer-download {\n    width: 24px;\n    height: 24px;\n    border-radius: 12px;\n    display: inline-block;\n    border: gray solid 1px;\n    box-sizing: border-box;\n    animation: 0.2s;\n}\n\n\n.drawer-trash {\n    border: none;\n    background-position: center center;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v10zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>\');\n}\n\n.drawer-download {\n    border: none;\n    background-size: cover;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M11 5v11.17l-4.88-4.88c-.39-.39-1.03-.39-1.42 0-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0L13 16.17V5c0-.55-.45-1-1-1s-1 .45-1 1z"/></svg>\');\n}\n.drawer-opener{\n    width:48px;\n    height: 48px;\n    border-radius:24px !important;\n    background-color: white;\n    position: relative;\n    display: inline-block;\n    background-size: 32px;\n    background-position: center center;\n    background-repeat: no-repeat;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.9 13.98l2.1 2.53 3.1-3.99c.2-.26.6-.26.8.01l3.51 4.68c.25.33.01.8-.4.8H6.02c-.42 0-.65-.48-.39-.81L8.12 14c.19-.26.57-.27.78-.02z"/></svg>\');\n}\n.stretch-image{\n    width: 64px;\n    height 64px;\n}\n',document.body.appendChild(e),P=document.querySelector(".drawer-group"),(R=P.querySelector(".drawer")).setAttribute("width","32px"),R.setAttribute("height","32px"),R.addEventListener("pointerdown",J),R.addEventListener("pointermove",X),window.addEventListener("pointerup",G),(B=R.getContext("2d")).imageSmoothingEnabled=!1;let n=P.querySelector(".drawer-top"),t=te("drawer-paint");t.style.backgroundColor="black",t.addEventListener("pointerup",$);let i=te("drawer-paint");i.style.backgroundColor="red",i.addEventListener("pointerup",$);let o=te("drawer-paint");o.style.backgroundColor="#65BB00",o.addEventListener("pointerup",$);let r=te("drawer-paint");r.style.backgroundColor="white",r.addEventListener("pointerup",$);let a=te("drawer-download");a.addEventListener("pointerup",Z);let l=te("drawer-trash");l.addEventListener("pointerup",K),n.appendChild(t),n.appendChild(i),n.appendChild(o),n.appendChild(r),n.appendChild(a),n.appendChild(l),document.onpaste=function(e){var n=(e.clipboardData||e.originalEvent.clipboardData).items;let t;for(t in console.log(JSON.stringify(n)),n){var i=n[t];if("file"===i.kind){var o=i.getAsFile(),r=new FileReader;r.onload=function(e){var n=new Image;n.onload=function(){ne(n)},n.src=e.target.result},r.readAsDataURL(o)}}}}();let e=setInterval((function(){y<=0&&(function(){var e;(e=document.createElement("style")).innerHTML="\n    #equipment-bar{\n        position: absolute;\n        border-radius: 16px;\n        background-color: #fff5;\n        border-radius: 16px;\n        min-height: 128px;\n        max-height: 60%;\n        width: 512px;\n        bottom: 96px;\n        left: 50%;\n        transform: translate(-50%);\n        overflow-x: hidden;\n        overflow-y: auto;\n        touch-action: none;\n        pointer-events:auto;\n    }\n    .equipment-item{\n        user-select: none;\n        border-radius: 8px;\n        background-color: white;\n        display: inline-block;\n        min-height: 16px;\n        min-width: 16px;\n        max-width: 200px;\n        margin: 8px;\n        box-sizing: border-box;\n    }\n    .equipment-item-selected{\n        border: dashed white 3px;\n        opacity: 0.5;\n    }\n    .equipment-item h4{\n        display:block;\n        margin:6px;\n    }\n    .equipment-item p{\n        display: inline-block;\n        margin: 16px;\n    }\n    .equipment-icon{\n        min-width: 48px;\n        min-height: 48px;\n        border-radius: 8px;\n        background-color: gray;\n        display: inline-block;\n    }\n    #pseduo-dragger{\n        position: absolute;\n        pointer-events: none;\n    }",document.body.appendChild(e),dn=document.querySelector("#equipmentCard"),un=dn.querySelector("#equipment-bar"),pn=dn.querySelector("#pseduo-dragger"),window.addEventListener("pointermove",(e=>{hn&&Cn(e)})),window.addEventListener("pointerup",(e=>{}))}(),function(){var e;De=document.querySelector("#characterCard"),Ze=document.querySelector(".sheet"),(e=document.createElement("style")).innerHTML='\n    [contenteditable="true"]{\n        text-decoration: underline;\n    }\n    [contenteditable="true"]:active,\n[contenteditable="true"]:focus{\n  border:none;\n  outline:none;\n}\n\n[contenteditable="true"]::before{\n    color:#5555;\ncontent:"::";\n}\n[contenteditable="true"]::after{\n    color:#5555;\n    text-align: right;\ncontent:"::";\n}\n\n[type="checkbox"]{\n    margin:0 !important;\n}\n\ninput::-webkit-outer-spin-button,\ninput::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n}\n\n/* Firefox */\ninput[type=number] {\n    -moz-appearance: textfield;\n}\n\n\n.sheet {\n    display: flex;\n    position: absolute;\n    border-radius: 16px;\n    background-color: white;\n    box-shadow: 6px 6px 1px #0005;\n    margin: 0 32px;\n    flex-direction: row;\n    flex-wrap: wrap;\n    align-items: flex-start;\n    align-content: flex-start;\n    overflow-y: auto;\n    max-height: calc(100% - 200px);\n    font-family: openBold;\n}\n\n.sub-section{\n    display: flex;\n    flex: 1;\n    flex-direction: row;\n    flex-wrap: wrap;\n    align-items: flex-start;\n    align-content: flex-start;\n}\n\n.section {\n    font-size: 16px;\n    width: 300px;\n    border-radius: 16px;\n    background-color: #F5F0E5;\n    box-shadow: 6px 6px 1px #0005;\n    flex: 3 1 1;\n    margin: 16px;\n    min-height: 96px;\n}\n.section *{\n    border-radius: 16px;\n}\n.section-banner{\n    text-align: center;\n    position: relative;\n    font-size: 24px;\n    background-color: inherit;\n    box-shadow: inherit;\n    border-radius: 4px;\n    padding: 8px;\n    letter-spacing: 6px;\n    width: 100%;\n    left: 50%;\n    border: 6px outset gray;\n    border-style: none groove none groove;\n    transform: translate(-50%);\n}\n\n.section-item {\n    height: 32px;\n    box-shadow: 6px 6px 1px #0005;\n    padding: 16px;\n    position: relative;\n    background-color: #83D943;\n}\n\n.number {\n    color: inherit;\n    font: inherit;\n    width: auto;\n    outline: none;\n    border: none;\n    background-color: transparent;\n    padding: 0;\n    text-align: center;\n    max-width: 64px;\n    font-size: 32px;\n    text-decoration: underline;\n}\n.number:disabled{\n    text-decoration: none;\n}\n.number:before{\n    content:\'+\';\n}\n\n\n\n\n.section-item-label {\n    position: absolute;\n    left: 16px;\n    top: 16px;\n}\n\n.STR {\n    background-color: #FF1B71 !important;\n    color: #8B1944 !important;\n}\n\n.DEX {\n    background-color: #8BFF36 !important;\n    color: #697F1E !important;\n}\n\n.CON {\n    background-color: #E9EE6A !important;\n    color: #76602C !important;\n}\n\n.INT {\n    background-color: #730FB2 !important;\n    color: #FDC3FF !important;\n}\n\n.WIS {\n    background-color: #FFA81F !important;\n    color: #FFFEB6 !important;\n}\n\n.CHR {\n    background-color: #FFA3A3 !important;\n    color: #8800AF !important;\n}\n\n.section-item-saving-throw {\n    border: white solid 3px;\n    width: 64px;\n    height: 64px;\n    position: absolute;\n    right: 0;\n    top: 0;\n    box-sizing: border-box;\n    border-radius: 16px;\n    font-size: 24px;\n    text-align: center;\n    line-height: 24px;\n}\n\n.section-item-saving-throw::before {\n    line-height: 102px;\n    top: -10px;\n    color: white;\n    font-size: 16px;\n    content: \'S.T.\'\n}\n\n.section-group{\n    border-radius: 16px;\n    background-color: #5555;\n    margin: 16px;\n\n}\n .section-group *{\n    pointer-events: none;\n}\n\n\n.section-skills {}\n.section-stats {\n}\n.section-status *{\n    margin: 8px;\n}\n.section-character{\n\n}\n.section-traits{\n\n}\n.section-personality{\n\n}\n.section-other{\n\n}\n\n.skill-item {\n    border-radius: 16px;\n    height: 24px;\n    box-shadow: 6px 6px 1px #0005;\n    padding: 8px;\n    position: relative;\n    background-color: #8DA4EE;\n    margin: 16px;\n}\n.skill-item .number{\n    font-size: initial;\n}\n.skill-item-icon {\n    border-radius: 16px 8px 8px 16px;\n    width: 40px;\n    height: 40px;\n    position: absolute;\n    top: 0;\n    left: -1px;\n    background-color: white;\n    background-size: 40px;\n    background-image: url(\'./spell.png\');\n}\n\n.skill-item .number {\n    position: absolute;\n    right: 32px;\n    top: -10px;\n}\n\n.skill-item-label {\n    display: inline-block;\n    margin-left: 48px;\n    content: \'hello\'\n}\n\n/**********/\n.section-group-mini .skill-item{\n    width: 64px;\n    display: inline-block;\n    margin:4px;\n}\n.section-group-mini .skill-item-label{\n    display: none;\n}\n.section-group-mini .number{\n    right:0;\n}\n/*********/\n\n\n.feature{\n    max-height: 96px;\n    overflow-y: scroll;\n    background-color: #B6E0D1;\n   padding: 1px 16px 16px 16px;\n   margin: 8px;\n   color: gray;\n   position: relative;\n}\n.feature p{\n    margin: 0 16px 0 16px;\n    font-family: open;\n}\n\n.feature-name{\n    font-size: 22px;\n    display: inline-block;\n    font-style: italic;\n    color: black;\n    margin: 0 8px 0 8px;\n}\n.feature-middle{\n    font-size: 18px;\n    font-style: italic;\n    text-align: center;\n    color: gray;\n}\n\n\n.feature-tag{\n    border-radius: 16px;\n    background-color: lightgreen;\n    font-weight: bold;\n    display: inline-block;\n    padding: 0 16px 0 16px;\n    box-sizing: border-box;\n    border: solid white 2px;\n}\n.trait{\n    background-color: #8BBDEB\n}\n\n.spell{\n    background-color: #E3C5E3\n}\n\n.feature input{\n    position: absolute;\n    right: 12px;\n    top: 12px;\n\n}\n.feature input::after{\n    color: gray;\n    font-size: 10px;\n    content: \'spell?\';\n    position: relative;\n    left: -28px;\n    top: -6px;\n}\n\n.feature-add,.lil-add{\n        position: relative;\n        width:36px;\n        height:36px;\n        background-color: #FAFABC;\n        border-radius: 28px;\n        margin:18px 0 18px 0;\n        cursor: pointer;\n        pointer-events: auto;\n        left: 50%;\n        transform: translate(-50%);\n\n        background-image: url("data:image/svg+xml,<svg width=\'36\' height=\'36\' stroke=\'black\' stroke-width=\'6\' stroke-linecap=\'round\' viewBox=\'0 0 36 36\' xmlns=\'http://www.w3.org/2000/svg\'><path d=\'m9 18 h 18M18 9v18\'/></svg>");\n        \n    }\n    .lil-add{\n        width:24px;\n        height:24px;\n        background-size: cover;\n        left: auto;\n        transform: none;\n    }\n\n\n/************/\n\n.floater-number-input {\n    position: absolute;\n    width: 144px;\n    height: 48px;\n    /*border:black 3px solid;*/\n}\n\n.floater-arrow {\n    z-index: 99;\n    width: 48px;\n    height: 48px;\n    border-radius: 24px;\n    background-color: #5558;\n    position: absolute;\n    left: 0;\n    top: 0;\n    display: inline-block;\n    animation: 0.3s;\n    background-repeat: no-repeat;\n    background-size: 32px;\n    background-position: center center;\n\n\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M14.71 6.71c-.39-.39-1.02-.39-1.41 0L8.71 11.3c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L10.83 12l3.88-3.88c.39-.39.38-1.03 0-1.41z"/></svg>\');\n\n}\n\n.floater-number-input .floater-arrow:nth-child(1) {\n    left: 96px;\n    transform: rotate(180deg);\n}\n\n/*.floater-arrow::after{\n            content: \'\';\n            background-color: red;\n            width: 16px;\n            height: 16px;\n            display: block;\n            position: absolute;\n            left: 48px;\n            top: 50%;\n            border-radius: 8px;\n            transform: translate(0,-50%);\n        }\n\n        .floater-arrow::before{\n            width: 48px;\n            height: 2px;\n            border-radius: 8px;\n            content: \'\';\n            display: block;\n            background-color: green;\n            position: absolute;\n            left: 24px;\n            top: 50%;\n            transform: translate(0,-50%);\n        }*/\n\n@keyframes blinker {\n    0% {\n        background-color: #fff6;\n    }\n\n    50% {\n        background-color: #0004;\n    }\n\n    100% {}\n}\n\n.editable-number {\n    width: 48px;\n    height: 48px;\n    box-sizing: border-box;\n    border-radius: 24px;\n    border: #fff7 dotted 3px;\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 0;\n\n    overflow: visible;\n    transition: 0.1s transform;\n}\n\n.editable-number::before {\n    content: \'\';\n    width: 24px;\n    height: 24px;\n    display: block;\n    position: absolute;\n    left: 32px;\n    top: -8px;\n\n    background-repeat: no-repeat;\n    background-size: 24px;\n    background-position: center center;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>\');\n}\n\n\n.selected {\n\n    box-shadow: 12px 6px 0px white;\n}\n\n.selected::after {\n    content: \'\';\n    right: 0px;\n    top: 8px;\n    width: 24px;\n    height: 24px;\n    position: absolute;\n    display: block;\n    background-position: center center;\n    background-size: 24px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" fill="white" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>\');\n}\n\n.section-dashed-line {\n    height: 0;\n    margin: 16px;\n    border-bottom: 3px dashed black;\n    border-radius:0;\n}\n\n.centered {\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n}\n\n.status-hitpoints{\n    height: 64px;\n    background-color: #EE9A9A;\n    background-position: left center;\n    background-repeat: no-repeat;\n    background-size: 64px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" fill="white" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M13.35 20.13c-.76.69-1.93.69-2.69-.01l-.11-.1C5.3 15.27 1.87 12.16 2 8.28c.06-1.7.93-3.33 2.34-4.29 2.64-1.8 5.9-.96 7.66 1.1 1.76-2.06 5.02-2.91 7.66-1.1 1.41.96 2.28 2.59 2.34 4.29.14 3.88-3.3 6.99-8.55 11.76l-.1.09z"/></svg>\');\n}\n\n.status-initiative,.status-armor,.status-speed{\n    display: inline-block;\n    width:64px;\n    height: 64px;\n    background-position: center center;\n    background-repeat: no-repeat;\n}\n.status-initiative .number,.status-armor .number,.status-speed .number{\n    color: white;\n    font-size: 24px;\n    position: relative;\n}\n.status-initiative{\n    background-size: 82px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="rgb(170, 68, 0)" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 17.27l5.17 3.12c.38.23.85-.11.75-.54l-1.37-5.88 4.56-3.95c.33-.29.16-.84-.29-.88l-6.01-.51-2.35-5.54c-.17-.41-.75-.41-.92 0L9.19 8.63l-6.01.51c-.44.04-.62.59-.28.88l4.56 3.95-1.37 5.88c-.1.43.37.77.75.54L12 17.27z"/></svg>\');\n}\n.status-armor{\n    background-size: 64px;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24" fill="rgb(35, 79, 35)"><g><rect fill="none" height="24" width="24"/><path d="M12,1L3,5v6c0,5.55,3.84,10.74,9,12c5.16-1.26,9-6.45,9-12V5L12,1L12,1z"/></g></svg>\'); /*fill="#224E22"     rgb(35, 79, 35)*/\n}\n.status-speed{\n    background-size: 86px;\n    background-position: center center;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" fill="rgb(30, 70, 178)" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3.5 18.99l11 .01c.67 0 1.27-.33 1.63-.84L20.5 12l-4.37-6.16c-.36-.51-.96-.84-1.63-.84l-11 .01L8.34 12 3.5 18.99z"/></svg>\');\n}\n\n.status-dice{\n    background-color: #8CEB8C;\n    height: 64px;\n    background-size: 64px;\n    background-position: center center;\n    background-position: left center;\n    background-repeat: no-repeat;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" fill="white" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 3h-4.18H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-6 15h-2v-2h2v2zm0-5c0 .55-.45 1-1 1s-1-.45-1-1V9c0-.55.45-1 1-1s1 .45 1 1v4zm-1-8c-.55"/></svg>\');\n}\n.saving-row{\n\n    position: relative;\n    text-align: right;\n}\n\n/*************/\n.character-picture{\n    width:212px;\n    height: 256px;\n    background-color: #17D1FF;\n    display: inline-block;\n}\n.character-column{\n    width:64px;\n    display: inline-block;\n    position: absolute;\n\n}\n\n.character-proficiency{\n    display: inline-block;\n    width:64px;\n    height: 64px;\n    position: relative;\n    left: 0;\n    top: 0;\n    background-color: #ECD4EC;\n}\n.character-inspiration{\n    display: inline-block;\n    width:64px;\n    height: 64px;\n    position: relative;\n    right: 0;\n    top: 0;\n    background-color: #5555;\n}\n.character-inspiration img{\n    width: 100%;\n    height: 100%;\n}\n.character-class{\n    display: block;\n    margin: 6px;\n    position: relative;\n    text-align: center;\n    font-size: 18px;\n    color: gray;\n}\n/***********************/\n\n.sheet-nav{\n    position: relative;\n    height: 96px;\n    overflow-x: auto;\n    overflow-y: hidden;\n    width: calc(100% - 88px);\n    transform: translate(-50%);\n    left: 50%;\n    white-space: nowrap;\n}\n.sheet-user{\n    position: relative;\n    display: inline-block;\n    border-radius: 28px;\n    background-color: green;\n    height: 56px;\n    width: 56px;\n    top: 0;\n    margin: 8px 8px 0 8px;\n}\n.sheet-user span{\n    border-radius: 16px;\n    position: absolute;\n    bottom: -10px;\n    left: 50%;\n    transform: translate(-50%);\n    background-color: #fff5;\n    pointer-events: none;\n}\n\n.sheet-selected::before{\n    position: absolute;\n    display: block;\n    background-color: white;\n    top: -10px;\n    height: 112px;\n    width: 64px;\n    border-radius: 16px;\n    content: \'\';\n    z-index: -1;\n    left: 50%;\n    transform: translate(-50%);\n}\n\n#sheet-edit-button{\n     position: fixed;\n        width:56px;\n        height:56px;\n        background-color: #FAFABC;\n        border-radius: 28px;\n        cursor: pointer;\n        pointer-events: auto;\n        right: 48px;\n        bottom: 108px;\n        background-size: 48px;\n        background-position: center center;\n        box-shadow: 6px 6px 1px #0005;\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>\');\n}\n#sheet-edit-button.toggled{\n    background-color: #16FF16;\n\n    background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M9 16.17L5.53 12.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0L9 16.17z"/></svg>\');\n}',document.body.appendChild(e);let n=De.querySelector(".section-stats");We=n,Ue=De.querySelector(".section-other"),Ye=De.querySelector(".section-traits"),je=De.querySelector(".section-personality"),Oe=De.querySelector(".section-status"),Ve=De.querySelector(".section-character");let t=tn("STR","Strength"),i=tn("DEX","Dexterity"),o=tn("CON","Constitution"),r=tn("INT","Intelligence"),a=tn("WIS","Wisdom"),l=tn("CHR","Charisma"),s=kn("section-group section-group-mini"),c=kn("section-group section-group-mini"),d=kn("section-group section-group-mini"),p=kn("section-group section-group-mini"),u=kn("section-group section-group-mini"),h=kn("section-group section-group-mini");s.appendChild(t),c.appendChild(i),d.appendChild(o),p.appendChild(r),u.appendChild(a),h.appendChild(l),n.appendChild(s),n.appendChild(c),n.appendChild(d),n.appendChild(p),n.appendChild(u),n.appendChild(h),Re.forEach(((e,n)=>{let t=function(e,n,t,i){let o=kn("skill-item");o.classList.add(n),o.type=n;let r=kn("skill-item-icon");r.style.backgroundImage=" url('./assets/"+i+"')";let a=kn("skill-item-label");a.innerText=t;let l=document.createElement("input");return l.className="number",l.value=0,l.type="number",l.min=-5,l.max=10,o.appendChild(r),o.appendChild(a),o.appendChild(l),o.skillId=e,o}(n,e[0],e[1],e[2]);switch(e[0]){case"STR":s.appendChild(t);break;case"DEX":c.appendChild(t);break;case"CON":d.appendChild(t);break;case"INT":p.appendChild(t);break;case"WIS":u.appendChild(t)}})),s.addEventListener("click",_n),c.addEventListener("click",_n),d.addEventListener("click",_n),p.addEventListener("click",_n),u.addEventListener("click",_n),h.addEventListener("click",_n),window.addEventListener("keyup",(e=>{27==e.keyCode&&(Qe?rn():an(),Qe=!Qe)})),function(){De.querySelector(".section-status");let e=kn("status-armor"),n=kn("status-initiative"),t=kn("status-speed"),i=En(0,10),o=En(0,10),r=En(0,10);i.innerText=10,r.innerText=10,o.innerText=10,e.appendChild(o),t.appendChild(i),n.appendChild(r);let a=De.querySelector(".status-row");a.appendChild(e),a.appendChild(n),a.appendChild(t);let l=Oe.querySelector(".status-hitpoints"),s=En(0,30),c=En(0,30);l.appendChild(s),l.appendChild(c)}(),Xe=Ue.querySelector(".feature-add"),Je=Ye.querySelector(".feature-add"),Xe.addEventListener("click",(e=>{let n=function(){let e=kn("feature"),n=document.createElement("p");return n.setAttribute("contenteditable",!0),e.appendChild(n),e}();Ue.insertBefore(n,Xe)})),Je.addEventListener("click",(e=>{let n=on();Ye.insertBefore(n,Je)}));let m=Ve.querySelector(".character-proficiency"),g=kn("centered");g.appendChild(En(2,6)),m.appendChild(g),De.querySelector("#sheet-edit-button").addEventListener("click",(e=>{Qe?(rn(),e.target.classList.add("toggled")):(an()&&H("Saved Character!","success",!1,1500),e.target.classList.remove("toggled")),Qe=!Qe}));let f=Ve.querySelector(".character-inspiration");(Ge=ie(f,"character",(function(e){let n=Ve.querySelector(".character-inspiration").querySelector("img");e?ne(n):n.src=ee()}))).style.position="absolute",Ge.style.right="-16px",Ge.style.bottom="-16px",Ve.querySelector(".character-picture").src=T("man"),an(!0)}(),clearInterval(e))}),1e3)}catch(e){H(e,"error")}}()}},0,[[111,666,977]]]);