(self.webpackChunkbuup=self.webpackChunkbuup||[]).push([[179],{5:(e,n,t)=>{"use strict";t.d(n,{a:()=>Ft});var i={};t.r(i),t.d(i,{_O:()=>In,S1:()=>sn,Z2:()=>Fn,Qc:()=>Bn,A$:()=>pn,V8:()=>bn,KT:()=>En,LP:()=>mn,_:()=>fn,W1:()=>dn,D9:()=>zn});var o={};t.r(o),t.d(o,{mS:()=>kt,n6:()=>zt,UX:()=>St,bK:()=>Tt,GI:()=>Mt,pk:()=>ft,S1:()=>xt,u7:()=>_t,b5:()=>Nt,hM:()=>dt,gw:()=>Lt,SI:()=>bt,ob:()=>Pt,j3:()=>wt});var a,r,l=t(642);function s(e){"string"!=typeof e&&(e=e.toString(16)),e.startsWith("#")?e=e.substring(1):e.startsWith("0x")&&(e=e.substring(2));let n=0,t=0,i=0;return 3==e.length?(n="0x"+e[0]+e[0],t="0x"+e[1]+e[1],i="0x"+e[2]+e[2]):6==e.length&&(n="0x"+e[0]+e[1],t="0x"+e[2]+e[3],i="0x"+e[4]+e[5]),[parseInt(n),parseInt(t),parseInt(i)]}function c(e){var n=e.toString(16);return 1==n.length?"0"+n:n}function d(e,n,t){return function(e,n,t){return"#"+c(e)+c(n)+c(t)}(e=Math.floor(256*e),n=Math.floor(256*n),t=Math.floor(256*t))}function u(e){let n=.299*e[0]+.587*e[1]+.114*e[2];return console.log(n),n>186}function p(e,n,t){n?e.scale.set(n,n,n):e.scale.set(110,110,110),t?e.position.set(0,0,t):e.position.set(0,0,-30),a.add(e);let i=document.createElement("img");return i.className="hexPortrait",i.setAttribute("src",St(a,r)),a.remove(e),i}var m=t(321);let f,h,g;function v(e,n,t){let i=document.createElement("div");i.className="uiSysTop";let o=document.createElement("div"),a=" ";if("object"==typeof n&&null!==n)n.type&&(a+=n.type),n.color&&(i.style.backgroundColor=n.color);else switch(n){case"warn":a+="uiIconWarning",i.style.backgroundColor="#EFEF79";break;case"error":a+="uiIconError",i.style.backgroundColor="#D25E5E";break;case"net":a+="uiIconNet",i.style.backgroundColor="#FFC65E";break;case"person":a+="uiIconPerson",i.style.backgroundColor="#D257FF";break;case"time":a+="uiIconTime",i.style.backgroundColor="#5094D9";break;case"success":a+="uiIconSuccess",i.style.backgroundColor="#95F17F"}o.className="uiIcon"+a;let r=document.createElement("span");function l(){i.style.animation=t?"0.5s uiSysMini forwards":"0.5s uiSysFold forwards",setTimeout((function(){t?(i.style.position="absolute",i.style.left="-64px",i.addEventListener("click",(function(e){i.style.animation="0.5s uiSysMax forwards",setTimeout((function(){i.style.animation="0.5s uiSysMini forwards"}),3500)}))):i.remove()}),500)}if(r.innerText=e,r.addEventListener("click",(function(e){!function(e){g.value=e.innerText,g.style.display="block",g.select(),document.execCommand("copy"),g.blur(),g.style.display="none"}(r),function(e,n,t){let i=document.createElement("div");i.className="uiCursorMessage",i.style.left=e+"px",i.style.top=n+"px",i.innerText="Copied",f.appendChild(i),setTimeout((function(){i.style.animation="1s uiFade forwards",setTimeout((function(){i.remove()}),1e3)}),1500)}(e.clientX,e.clientY)})),i.appendChild(o),i.appendChild(r),!t){let e=document.createElement("div");e.className="uiCloseButton",i.appendChild(e),e.addEventListener("click",(function(e){l()}))}return setTimeout((function(){l()}),3500),h.appendChild(i),i}var y,x,w,_,b,E,S;function k(){return x}var z,L,C,T,M,A=!1,P=1,N=!1,I=0,H=void 0,R={x:0,y:0};function F(e){let n=_[e];n&&(n.classList.add("cardMax"),n.focused=!0,n.style.zIndex=0,Object.values(n.children).forEach((e=>{"card-notifier"==e.className?e.remove():e.style.display="initial"})),"landscapeCard"==n.id?mn(!0):mn(!1),"chatCard"==n.id&&(Fn(),M.focus()),"npcCard"==n.id?fn(!0):fn(!1),-1==n.spot?(C.style.top="32px",C.style.left="32px"):(C.style.top=n.style.top,C.style.left=n.style.left),C.style.opacity="1",C.style.pointerEvents="auto",S=n)}function B(){S&&(S.classList.remove("cardMax"),S.style.zIndex=2,S.focused=void 0,pn(),mn(!1),fn(!1),Object.values(S.children).forEach((e=>{"card-notifier"==e.className?e.style.display="initial":e.style.display="none"})),C.style.opacity="0",C.style.pointerEvents="none"),N&&(N=!1,V())}function q(){clearTimeout(L),L=setTimeout((function(){V(),bt()}),250)}function D(e){let n=0,t=[],i=0==P||2==P;e?(n=_.length,t=_):_.forEach((e=>{-1!=e.spot&&(t.push(e),n++)})),i?(b.style.height=64*(n>0?n:1)+"px",b.style.width="82px"):(b.style.width=64*(n>0?n:1)+"px",b.style.height="82px");let o=b.getBoundingClientRect();E=o;let a,r=o.width,l=o.height;a=i?l/n:r/n,e||(i?t.sort((function(e,n){return parseInt(e.style.top)-parseInt(n.style.top)})):t.sort((function(e,n){return parseInt(e.style.left)-parseInt(n.style.left)})));for(let u=0;u<n;u++)z[u]=i?{x:o.left+r/2,y:32+o.top+u*a}:{x:32+o.left+u*a,y:o.top+l/2},H&&H==t[u]&&(R=z[u]),e&&(_[u].spot=u,z[u].app=t[u]),s=t[u],c=z[u].x,d=z[u].y,void 0||(s.pos={x:c,y:d}),s.style.left=c+"px",s.style.top=d+"px";var s,c,d;let u=barHandle.getBoundingClientRect();if(i){let e=u.left+u.width/2;O({x:e,y:u.top},{x:e,y:u.bottom})}else{let e=u.top+u.height/2;O({x:u.left,y:e},{x:u.right,y:e})}}function W(){requestAnimationFrame(W)}function O(e,n){e.x,e.y,n.x,n.y}function j(e){if(function(e){if(A){I++;let n=e.clientX,t=e.clientY,i=window.innerWidth/2,o=window.innerHeight/2,a=n-i,r=t-o,l=i-Math.abs(a)<10,s=o-Math.abs(r)<10,c=Math.atan2(r,a)/Math.PI,d=Math.abs(c);d<.25?(2!=P&&(P=2,V()),l!=N&&(N=l,V())):d<.75?(c<0?3!=P&&(P=3,V()):1!=P&&(P=1,V()),s!=N&&(N=s,V())):(0!=P&&(P=0,V()),l!=N&&(N=l,V()))}}(e),H){if(I++,H.pos={x:e.clientX+H.offset.x,y:e.clientY+H.offset.y},e.clientY>E.top&&e.clientY<E.bottom&&e.clientX>E.left&&e.clientX<E.right){let e=R,n={x:e.x-H.pos.x,y:e.y-H.pos.y};H.pos={x:e.x-n.x/3,y:e.y-n.y/3},H.moving&&(H.moving=void 0,H.spot=0,D())}else H.moving||(H.moving=!0,H.spot=-1,D());H.style.left=H.pos.x+"px",H.style.top=H.pos.y+"px"}}function V(){2==P?(b.style.left=window.innerWidth-(N?-32:48)+"px",b.style.top="50%",D(),barHandle.style.transform="translate(-200%,-50%)",barHandle.style.width="32px",barHandle.style.height="80%",b.style.borderWidth="0px 0px 0px 6px",$(!1)):3==P?(barHandle.style.transform="translate(-50%,100%)",b.style.left="50%",b.style.top=(N?-32:48)+"px",D(),barHandle.style.height="32px",barHandle.style.width="80%",b.style.borderWidth="0px 0px 6px 0px",$(!1)):1==P?(barHandle.style.transform="translate(-50%,-200%)",b.style.left="50%",b.style.top=window.innerHeight-(N?-32:48)+"px",D(),barHandle.style.height="32px",barHandle.style.width="80%",b.style.borderWidth="6px 0px 0px 0px",$(!0)):(barHandle.style.transform="translate(100%,-50%)",b.style.left=(N?-32:48)+"px",b.style.top="50%",D(),barHandle.style.width="32px",barHandle.style.height="80%",b.style.borderWidth="0px 6px 0px 0px",$(!1))}function Y(e){A&&(A=!1,console.log(I),I<10&&B()),H?(H.classList.remove("cardMove"),I<20?(S&&S==H&&(H.classList.remove("cardMax"),H.focused=void 0,S=void 0,H.style.zIndex=2),B(),F(H.appId)):(D(),console.log("fix bar also"))):(D(),console.log("fix bar")),H=void 0,I=0}var U,G=-1,J=null,X=-1;function K(e,n){let t=function(e){return y[e]}(e);t||(t={username:"Unknown",id:-1,color:"black"}),function(e,n,t){let i=document.createElement("p"),o=n.color;i.style.backgroundColor=o;let a=u(s(o));i.style.color=a?"#000000":"#FFFFFF",i.style.textShadow="1px 1px 2px "+(a?"#FFFFFF":"#000000"),i.innerHTML=e;{let e=document.createElement("div");if(e.classList.add("chat-row"),n.id==k().id&&e.classList.add("chat-right"),i.classList.add("chat-bubble"),X>=0&&X==n.id)G==n.id?(J.classList.remove("chat-bubble-footer"),J.classList.add("chat-bubble-body")):J.classList.add("chat-bubble-header"),i.classList.add("chat-bubble-footer");else{let e=document.createElement("p");e.classList.add("chat-nametag"),e.innerHTML=n.username;let t=document.createElement("div");n.id==k().id&&(t.style.textAlign="right"),t.appendChild(e),T.appendChild(t)}G=X,J=i,X=n.id,e.appendChild(i),T.appendChild(e),T.scrollTop=T.scrollHeight}}(n,t),function(e,n){let t=_[2];if(!t.focused){let e=t.querySelector(".card-notifier");e?e.innerText=parseInt(e.innerText)+1:(e=document.createElement("div"),e.className="card-notifier",t.appendChild(e),e.innerText=1),t.style.animation="",t.offsetWidth,t.style.animation="attention 0.2s"}}()}function Z(){M.blur(),B(),Bn(!1)}function Q(e){let n=document.createElement("div");n.className="chat-divider";let t=document.createElement("p");t.innerText=e,n.appendChild(t),T.appendChild(n)}function $(e){e?(T.style.height="calc(100vh - 100px)",document.querySelector(".chat-bottom").style.bottom="100px"):(T.style.height="calc(100vh - 64px)",document.querySelector(".chat-bottom").style.bottom="0px")}var ee,ne=!1;function te(e,n,t,i,o,a,r){U.emit("physMake",e,n,t,i,o,a,r)}function ie(e){e||(e="test"),U.emit("message",e)}function oe(e,n){U.emit("sendPhys",{id:e.id,position:e.position,velocity:e.velocity,quaternion:e.quaternion,angularVelocity:e.angularVelocity},n)}var ae=[],re=[],le=[];var se,ce,de,ue=2;function pe(e,n,t){le[e][n]=t,me()}function me(){ke=6,he();for(let n=0;n<le.length;n++)for(let t=0;t<le.length;t++){let i=le[n][t],o=Math.floor(ze(1,4)),a=Math.floor(ze(1,6));if(1!=i){let o,r,l,s,c,d;o=n>0?le[n-1][t]:0,r=n<le.length-1?le[n+1][t]:0,t<le.length-1?(l=n>0?le[n-1][t+1]:0,s=le[n][t+1]):(l=0,s=0),t>0?(c=le[n][t-1],d=n<le.length-1?le[n+1][t-1]:0):(c=0,d=0),o=o==i,r=r==i,s=s==i,d=d==i,c=c==i,l=l==i;let u=-1,p=0,m=[],f=5;[l,s,r,d,c,o].forEach(((e,n)=>{e?(m.push(n),-1==u&&(u=n),p=n):f=n}));let h="N",g="";if(6==m.length)fe(i,"H"+g,n,t,Math.floor(a));else if(m.length>0){let o=[];var e=m[0];for(let n=1;n<m.length;n++)o.push(m[n]-e-1),e=m[n];let a=-1==u?0:u;switch(m.length){case 1:h="E",a+=0;break;case 2:h="P",0==o[0]?(g="3",a+=0):1==o[0]?(g="2",a+=0):2==o[0]?(g="1",a+=0):3==o[0]?(g="2",a+=4):(g="3",a+=5);break;case 3:h="T",0==o[0]?0==o[1]?(g=1,a+=0):3==o[1]?(g=1,a+=5):1==o[1]?(g=3,a+=3):2==o[1]&&(g=2,a+=4):1==o[0]?0==o[1]?g=2:1==o[1]?g=4:2==o[1]&&(g=3,a+=2):2==o[0]?0==o[1]?(g=3,a+=0):1==o[1]&&(g=2,a+=3):(g=1,a+=4),a%=6;break;case 4:h="Q",0==o[0]?0==o[1]?0==o[2]?(g=1,a+=0):1==o[2]?(g=3,a+=2):2==o[2]&&(g=1,a+=5):1==o[1]?0==o[2]?(g=2,a+=4):1==o[2]&&(g=3,a+=1):(g=1,a+=4):1==o[0]?0==o[1]?0==o[2]?(g=3,a+=4):g=2:g=3:(g=1,a+=3),a%=6;break;case 5:h="F",a=f+1}fe(i,h+g,n,t,a)}else fe(i,"N",n,t,0)}else 1==i&&fe(i,"O"+o,n,t,Math.floor(a))}}function fe(e,n,t,i,o){let a=8*Math.sqrt(3)/2,r="Grass_";switch(e){case 1:r="Grass_";break;case 0:r="Water_";break;case 3:r="Mount_";break;case 4:r="Tree_";break;case 5:r="House_"}let l=ae[r+n];if(l){let e=l.clone();e.position.set(t*a*2-48+i*a,8*i*1.5,-1.6),o&&(o=6-o,e.rotation.z=o*Math.PI/3),re.push(e),kt(e)}else console.log("invalid model "+r+n)}function he(){re.forEach((e=>{Lt(e)})),re=[]}function ge(e,n){let t=8*Math.sqrt(3)/2,i=Math.floor((8+n)/12),o=Math.floor((e+48+8-i*t)/(2*t));return se.position.set(o*t*2-48+i*t,8*i*1.5,.8),[o,i]}let ve={x:0,y:0},ye=0;var xe,we,_e,be,Ee,Se,ke=6;function ze(e,n){return(n=n||0)+(ke=(9301*ke+49297)%233280)/233280*((e=e||1)-n)}function Le(e){return ae[e].clone()}function Ce(e,n){le=n,me()}var Te=2048;Math.PI;let Me,Ae=1,Pe=-.001;function Ne(e){let n;switch(e){case 4:n=600,we.shadow.camera.far=1200,we.shadow.mapSize.width=Te,we.shadow.mapSize.height=Te,Me=100,we.position.z=600;break;case 3:n=300,we.shadow.camera.far=600,we.shadow.mapSize.width=Te,we.shadow.mapSize.height=Te,Me=100,we.position.z=300;break;case 2:n=120,we.shadow.camera.far=240,we.shadow.mapSize.width=Te,we.shadow.mapSize.height=Te,Me=40,we.position.z=120;break;case 1:n=75,we.shadow.camera.far=150,we.shadow.mapSize.width=Te,we.shadow.mapSize.height=Te,Me=25,we.position.z=75;break;default:n=30,we.shadow.camera.far=60,we.shadow.mapSize.width=Te,we.shadow.mapSize.height=Te,Me=10,we.position.z=30}we.shadow.camera.left=-n,we.shadow.camera.right=n,we.shadow.camera.top=n,we.shadow.camera.bottom=-n,we.shadow.map&&(we.shadow.map.dispose(),we.shadow.map=null),xe&&setTimeout((function(){xe.update()}),100)}function Ie(e){e?xe?xe.visible=!0:kt(xe=new l.Rki(we.shadow.camera)):xe&&(xe.visible=!1)}var He,Re,Fe,Be,qe=t(429),De={},We={};function Oe(e,n){_t(e,((e,t)=>{n(e,t)}))}function je(e){Oe("assets/models/"+e+".gltf",(n=>{n.scale.set(2,2,2),n.castShadow=!0,n.receiveShadow=!0,function(e,n){let t=e.replace(/[0-9]/g,"");if(t!=e)if(We[t]){if(!Array.isArray(We[t])){let e=We[t];We[t]=[e]}We[t].push(n)}else We[t]=n;We[e]=n}(e,n)}))}function Ve(e,n,t,i){if(!n)return;let o,a=t&&i,r=n.attributes.color.array,l=[];for(let e=0;e<r.length;e++)if(o=e%4,o>=3)if(a)r[e-3]==t[0]&&r[e-2]==t[1]&&r[e-1]==t[2]&&(r[e-3]=i[0],r[e-2]=i[1],r[e-1]=i[2]);else{let n=d(r[e-3],r[e-2],r[e-1]);l[n]=r[e-3]+","+r[e-2]+","+r[e-1]}a||Object.keys(l).forEach((t=>{console.log("%s %s %c %s %c %s",e.name,n.name,"background: "+t+"; color: #000",t,"background: white;",l[t])}))}var Ye=["man","pot","rock"];function Ue(){return Be}var Ge,Je=t(335),Xe=!1,Ke=!1,Ze=void 0,Qe=!1,$e=!1,en=0,nn=0,tn=0,on=0,an=0,rn=!1,ln=[];function sn(){let e=document.querySelector(".canvasHolder");e.addEventListener("mousemove",hn),e.addEventListener("mousedown",gn),e.addEventListener("mouseup",vn),e.addEventListener("touchstart",yn),e.addEventListener("touchend",xn),e.addEventListener("touchmove",_n),window.addEventListener("contextmenu",Nn),window.addEventListener("keyup",Rn)}var cn=!1;function dn(e,n,t,i){!function(e,n){(Ge=new Je.z(n,e)).callbackCounts=e=>{1==e?Ze=setTimeout((function(){Qe=!0}),100):Ze&&clearTimeout(Ze)},Ge.mouseButtons={LEFT:void 0,MIDDLE:l.RsA.ROTATE,RIGHT:l.RsA.PAN},Ge.maxPolarAngle=1.3,Ge.isControl(),pn(),Ge.addEventListener("change",(function(e){var n,t=Ge.target.distanceTo(Ge.object.position);t<30?(0!=cn&&Ne(0),cn=0):t<100?(1!=cn&&Ne(1),cn=1):t<180?(2!=cn&&Ne(2),cn=2):(3!=cn&&Ne(3),cn=3),n=Ge.target,Ee.set(n.x,n.y,n.z),we.position.x=n.x,be.position.x=n.x})),Ge.addEventListener("end",(function(e){Ze&&clearTimeout(Ze),Qe=!1}))}(n,t)}function un(){console.log("p2"),Ge.touches={ONE:69,TWO:l.QmN.DOLLY_PAN}}function pn(){console.log("p1"),Ge.touches={ONE:l.QmN.PAN,TWO:l.QmN.DOLLY_ROTATE}}function mn(e){(function(e){se.visible=e})(Xe=e),e&&un()}function fn(e){Ke=e,e&&un()}function hn(e){Hn(e.clientX,e.clientY)}function gn(e){return 1===e.which&&($e=!0,!0)}function vn(e){if(2===e.which)return!1;$e=!1,wn()}function yn(e){return $e=!0,en=e.touches[0].clientX,nn=e.touches[0].clientY,!0}function xn(e){$e&&(Tn||Ge.isControl()),$e=!1,Pn&&(document.querySelector(".bubbleSelector").style.visibility="hidden",Pn=!1),wn()}function wn(){Xe&&(ye=0,ve.x=0,ve.y=0),function(){if(Tn){Tn=void 0,document.querySelectorAll(".bubble").forEach((e=>{e.style.visibility="hidden"}));let e=document.querySelector(".overtext");e&&(e.style.visibility="hidden"),An>=0&&Mn[An](tn,on,0),Bn(!1)}}()}function _n(e){Hn(e.touches[0].clientX,e.touches[0].clientY)}function bn(){return en}function En(){return nn}var Sn=0,kn=0;function zn(e){let n={x:e.x-tn,y:e.y-on,z:e.z-an};if(ln.push(n),ln.length>6&&ln.shift(),tn=e.x,on=e.y,an=e.z,Xe)$e||ge(tn,on),(Qe||$e)&&function(e,n){let[t,i]=ge(e,n),o=le.length;(t!=ve.x||i!=ve.y)&&t>-1&&i>-1&&t<o&&i<o&&(0==ye&&le[t][i]==ue?pe(t,i,1):pe(t,i,ue),ye++,ve.x=t,ve.y=i,ce&&(clearTimeout(ce),ce=null),ce=setTimeout((function(){var e;e=le,U.emit("terrain",k().id,0,e)}),2e3))}(tn,on);else if(Ke){if(Qe||$e){let e=Ue();e&&(Qe=!1,$e=!1,Cn(),te({x:1.5,y:1.5,z:3},2,{x:tn,y:on,z:an+.1},Zn(kn),1,k().color,e))}}else Qe||$e?(Cn(),1==(Sn=function(e,n){if(null==Xn){let n,t=6;if(Un.forEach((i=>{if(null!=i.physId){let o=i.position.distanceTo(e);o<t&&(n=i.physId,t=o)}})),null!=n)return Xn=Yn[n],1;Xn=-1}else if(-1!=Xn){let t=Xn;return t.quaternion.setFromAxisAngle(new On.Vec3(0,0,1),n),t.position.copy(e),t.position.z+=6,t.sleep(),++Kn>10&&(Kn=0,oe(t,!0),console.log("send phys")),1}return 0}(e,kn))&&(Ge.reset(),un())):Sn>-1&&(function(e,n){if(Xn&&-1!=Xn){let t=Xn;t&&(t.wakeUp(),t.position.copy(e),t.velocity.copy(n),t.position.z+=6,Kn=0,oe(t,!1),console.log("send phys NOW"))}Xn=void 0}(e,Ln()),Sn=!1,Sn=-1,pn())}function Ln(){let e={x:0,y:0,z:0};return ln.forEach((n=>{e.x+=n.x,e.y+=n.y,e.z+=n.z})),e}function Cn(){let e=Ln();Math.sqrt(e.x*e.x+e.y*e.y)>.2&&(kn=Math.PI/2+Math.atan2(e.y,e.x))}var Tn,Mn=[],An=-1,Pn=!1;function Nn(e){return e.preventDefault(),!1}function In(){return Ge.object.rotation.z}function Hn(e,n){Tn?function(e,n){let t=e-Tn.x,i=n-Tn.y,o=Math.sqrt(t*t+i*i),a=function(e,n){let t=Math.atan2(e,-n);return t<0&&(t=2*Math.PI+t),t}(t,i),r=document.querySelectorAll(".bubble"),l=2*Math.PI/r.length,s=a/l+l/2,c=Math.floor(s);c>=r.length&&(c=0),o>100&&(c=-1);let d="";r.forEach(((e,n)=>{n==c?(e.style.border="solid blue 6px",d=e.getAttribute("value")):e.style.border=""})),Math.PI;let u=document.querySelector(".overtext");c>-1?(u.style.visibility="visible",u.style.left=e+"px",u.style.top=n+"px",u.innerHTML=d,u.style.transform=t>25?"translate(28px,-50%)":t<-25?"translate(calc(-28px - 100%),-50%)":"translate(-50%,calc(-28px - 100%))"):u.style.visibility="hidden",An=c}(e,n):(en=e,nn=n)}function Rn(e){if(Fn())return!1;switch(console.log(e.which),e.which){case 13:F(2);break;case 27:B();break;case 49:Ne(0);break;case 50:Ne(1);break;case 51:Ne(2);break;case 52:Ne(3);break;case 53:Ne(4);break;case 84:te({x:2,y:2,z:3},2,{x:tn,y:on,z:30},Zn(Math.PI/2),0,k().color,"rock");break;case 89:te({x:1.5,y:1.5,z:3},2,{x:tn,y:on,z:30},Zn(Math.PI/2),1,k().color,"man");break;case 192:window.pickTarget=o.pick(),window.pickTarget&&console.log("picked a "+window.pickTarget.type)}}function Fn(){return rn}function Bn(e){rn=e;let n=document.querySelectorAll(".menuHidable");n.length&&n.forEach((n=>{n.style.visibility=e?"hidden":"visible"}))}var qn,Dn,Wn,On=t(279),jn=0;var Vn=[],Yn=[],Un=[];function Gn(e,n,t,i,o,a,r,c){let d,u,p=new On.Body({mass:t});if(d=a?new On.Cylinder(n.x,n.y,n.z,6):new On.Box(new On.Vec3(n.x,n.y,n.z)),p.addShape(d),p.position.set(i.x,i.y,i.z),o&&p.quaternion.copy(o),p.id=e,Vn.push(e),Yn[e]=p,qn.push(p),Dn.addBody(p),c){let e=function(e,n){let t=We[e];if(t){if(Array.isArray(t))t=t[Math.floor(Math.random()*t.length)];else if("man"==e&&n){t=qe.b.clone(t);let e=s(n).map((e=>e/256));return t.userData.shirt={value:new l.Pa4(e[0],e[1],e[2])},t.userData.wind={value:new l.Pa4(0,1,0)},t.children.forEach((e=>{e&&"SkinnedMesh"==e.type&&(e.castShadow=!0,e.receiveShadow=!0,"Woman"!=e.name&&"Man"!=e.name||(e.material=Re.clone(),e.material.uniforms.shirt=t.userData.shirt),e.name)})),t}return t.clone()}return ft.clone()}(c,r);u=Nt(),e.position.z=-n.z/2,e.rotation.x=Math.PI/2,u.add(e)}else u=a?Mt(n.x,n.y,n.z,i.x,i.y,i.z,r):Tt(2*n.x,2*n.y,2*n.z,i.x,i.y,i.z,r);kt(u),Un[e]=u,u.physId=e}function Jn(e){e.forEach((e=>{let n=Yn[e[0]];n&&(n.position.copy(e[1]),n.quaternion.copy(e[2]),n.velocity.copy(e[3]),n.angularVelocity.copy(e[4]),n.sleepState!=e[5]&&(2==e[5]?n.sleep():2==n.sleepState&&n.wakeUp()))}))}var Xn,Kn=0;function Zn(e){let n=new On.Quaternion(0,0,0,0);return n.setFromAxisAngle(new On.Vec3(0,0,1),e),n}var Qn,$n,et,nt,tt,it,ot,at,rt,lt,st,ct,dt,ut,pt,mt,ft,ht=t(145),gt=t(38),vt=(t(857),t(596)),yt=t(26);function xt(){var e;(Qn=new l.cPb(45,window.innerWidth/window.innerHeight,1,5e3)).position.z=200,Qn.position.y=-200,Qn.up=new l.Pa4(0,0,1),Qn.lookAt(new l.Pa4(0,0,0)),et=new l.xsS,At=et,lt=document.querySelector(".canvasHolder"),($n=new l.CP7({antialias:!0,alpha:!0})).shadowMap.enabled=!0,$n.shadowMap.type=l.ntZ,$n.toneMapping=l.LY2,$n.outputEncoding=l.knz,$n.setClearColor(16744242,1),lt.appendChild($n.domElement),at=new ht.E,e=l.rDY.merge([l.Vj0.standard.uniforms]),new l.jyz({uniforms:e,derivatives:!1,lights:!0,vertexColors:!0,vertexShader:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec3 shirt;\nuniform vec3 wind;\n\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #ifdef USE_COLOR\n        if(color==vec3(0,0,1))\n            vColor.xyz = shirt;\n        else\n            vColor.xyz = color.xyz;\n        \n    #endif\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n    #ifdef USE_TANGENT\n        vTangent = normalize( transformedTangent );\n        vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n    #endif\n#endif\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    \n        if(color==vec3(1,0,0)){\n            float val=max(0.0, 1.0976 - transformed.z);\n            transformed.xyz+=val*wind;\n            transformed.y*=1.0+sin((wind.z+transformed.z)*4.0)/2.0;\n\n        }\n    \n\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n}",fragmentShader:"\n    #define STANDARD\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <roughnessmap_fragment>\n    #include <metalnessmap_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n    #include <lights_physical_fragment>\n    #include <lights_fragment_begin>\n    #include <lights_fragment_maps>\n    #include <lights_fragment_end>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n    gl_FragColor = vec4( outgoingLight,1.-(((0.2125 * outgoingLight.r) + (0.7154 * outgoingLight.g) + (0.0721 * outgoingLight.b)) ) );\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n    #include <dithering_fragment>\n}",roughness:0,metalness:1}),At=et,tt=Qn,bt(),st=new gt.x($n);let n=new vt.G(et,Qn,300,200);n.kernelRadius=6,n.minDistance=15e-5,n.maxDistance=.001,st.addPass(n),window.ssao=n,new l.vBJ({color:7722446}),new l.Wid({color:2156703,metalness:0,roughness:1}),new l.Wid({color:2156703,metalness:0,roughness:1}),new l.Wid({color:5534117,metalness:0,roughness:1});let t=new l.Wid({color:15398690,metalness:0,roughness:1});ct=new l.Wid({color:13576926,metalness:0,roughness:1}),new l.Wid({color:11930379,metalness:0,roughness:1}),new l.Wid({color:15398690,metalness:0,roughness:1}),nt=new l.ZAu,dt=new l.ZAu;let i=new l.vBJ({color:16777215,side:l.Wl3}),o=new l.vBJ({color:3282968,side:l.Wl3}),a=Ct(1,1,2,0,0,0,t),r=Ct(1,.2,1,0,.5,.5,i),s=Ct(.3,.2,.3,0,.6,.5,o);dt.add(a),dt.add(r),dt.add(s),nt.add(dt);let c=Ct(.5,.5,1.5,.75,0,20,new l.vBJ({color:14035807}));nt.add(c),et.add(nt),function(){let e=new l.zf8(3,8);pt=new l.vBJ({color:4907322}),new l.vBJ({color:15461888}),(ut=new l.Kj0(e,pt)).position.z=.05,et.add(ut)}(),new l.Pa4(1,0,0),Ee=new l.Pa4(0,0,0),zt(Se=new l.Mig(9408399)),(we=new l.Ox3(14702423,.5)).position.set(0,250,0),we.castShadow=!0,zt(we),(be=new l.Tme).position.set(20,0,20),zt(be),we.target=be,we.shadow.mapSize.width=Te,we.shadow.mapSize.height=Te,we.shadow.camera.near=1,Ne(0),we.shadow.radius=2.2,we.shadow.bias=-5e-4,(_e=we.clone()).shadow.mapSize.width=256,_e.shadow.mapSize.height=256,_e.shadow.radius=0,_e.visible=!1,zt(_e),window.sunLight=we,Ie(!0),dn(0,lt,Qn);let d=new l.vBJ({color:16711680}),u=new l.vBJ({color:16746496}),p=new l.vBJ({color:16776960}),m=new l.vBJ({color:65280}),f=new l.vBJ({color:255}),h=new l.vBJ({color:8913151}),g=new l.nvb(1,1,1);return ft=new l.Kj0(g,[d,u,p,m,f,h]),setTimeout((function(){Et()}),1),lt}function wt(e){e&&!mt&&(mt=new yt.O(et,Dn))}function _t(e,n,t,i){at.load("./"+e,(e=>{let o;if(e.scene.rotation.x=Math.PI/2,e.scene.traverse((function(e){e instanceof l.Kj0&&(o=e,t||(e.material=i?new l.Wid({color:i,metalness:0,roughness:1}):new l.Wid({vertexColors:l.jSK,metalness:0,roughness:1}),e.material.needsUpdate=!0))})),e.scene.children[0],o){var a=e.animations;if(a&&a.length){rt=new l.Xcj(o);for(var r=0;r<a.length;r++){var s=a[r];let e=rt.clipAction(s);e.timeScale=.002,e.play()}}}n(e.scene)}),(e=>{console.log(e.loaded/e.total*100+"% loaded")}),(e=>{console.error("An error happened",e)}))}function bt(){window.screen.width>window.innerWidth?(it=window.innerWidth,ot=window.innerHeight):(it=window.screen.width,ot=window.screen.height),Qn.aspect=it/ot,Qn.updateProjectionMatrix(),$n.setPixelRatio(.5),$n.setSize(it,ot)}function Et(e){!function(){Dn.step(.03333333333333333);for(var e=0;e!==qn.length;e++){if(null!=qn[e].id){let n=Un[qn[e].id];n.position.copy(qn[e].position),n.quaternion.copy(qn[e].quaternion)}qn[e].position.z<-100&&(qn[e].position.set(80*Math.random()-40,80*Math.random()-40,100),qn[e].velocity.set(0,0,0),qn[e].collisionResponse=!1,qn[e].sleep())}let n=In(),t=Wn.velocity.length();Ft.left?(t<2&&(Wn.velocity.x-=2*Math.cos(n),Wn.velocity.y-=2*Math.sin(n)),jn=n+Math.PI/2,Wn.quaternion.setFromAxisAngle(new On.Vec3(0,0,1),jn)):Ft.right?(t<2&&(Wn.velocity.x+=2*Math.cos(n),Wn.velocity.y+=2*Math.sin(n)),jn=n-Math.PI/2,Wn.quaternion.setFromAxisAngle(new On.Vec3(0,0,1),jn)):Ft.up?(t<2&&(Wn.velocity.x-=2*Math.sin(n),Wn.velocity.y+=2*Math.cos(n)),jn=n,Wn.quaternion.setFromAxisAngle(new On.Vec3(0,0,1),jn)):Ft.down&&(t<2&&(Wn.velocity.x+=2*Math.sin(n),Wn.velocity.y-=2*Math.cos(n)),jn=n+Math.PI,Wn.quaternion.setFromAxisAngle(new On.Vec3(0,0,1),jn)),dt.position.copy(Wn.position),dt.quaternion.copy(Wn.quaternion)}(),nt.rotation.z>Math.PI/16||(nt.rotation.z,Math.PI),function(){var e=new l.Pa4;e.set(bn()/window.innerWidth*2-1,-En()/window.innerHeight*2+1,.5),e.unproject(Qn);var n=e.sub(Qn.position).normalize(),t=-Qn.position.z/n.z,i=Qn.position.clone().add(n.multiplyScalar(t));ut.position.x=i.x,ut.position.y=i.y,ut.position.z=2,zn(ut.position)}(),function(){Ae+=Pe,Ae<0?(Ae=0,Pe=-Pe):Ae>1&&(Ae=1,Pe=-Pe),Ae&&(we.color.setHex(16777215),Se.color.setHex(6316128),Pt(11594237,1));let e=Me*Ae;be.position.y=Ee.y-e,we.position.y=Ee.y+e}(),mt&&mt.update(),$n.render(At,tt),requestAnimationFrame(Et)}function St(e,n){$n.setSize(256,256),$n.setClearColor(16777215,0),e&&n?$n.render(e,n):$n.render(getScene(),Qn);let t=$n.domElement.toDataURL();return $n.setSize(it,ot),t}function kt(e){nt.add(e)}function zt(e){et.add(e)}function Lt(e){nt.remove(e)}function Ct(e,n,t,i,o,a,r){let s=new l.nvb(e,n,t);r||(r=ct);let c=new l.Kj0(s,r);return c.castShadow=!0,c.position.x=i||0,c.position.y=o||0,c.position.z=a||0,c}function Tt(e,n,t,i,o,a,r){return Ct(e,n,t,i,o,a,r=r?new l.vBJ({color:r}):ct)}function Mt(e,n,t,i,o,a,r){let s=new l.fHI(e,n,t,6);r=r?new l.vBJ({color:r}):ct,s.rotateX(Math.PI/2),s.rotateZ(Math.PI/2);let c=new l.Kj0(s,r);return c.castShadow=!0,c.position.x=i||0,c.position.y=o||0,c.position.z=a||0,c}var At=0;function Pt(e,n){$n.setClearColor(e,n)}function Nt(){return new l.ZAu}let It;function Ht(e,n,t,i){let o,a=document.createElement("div"),r=document.createElement("div");if(r.classList.add("switch"),t&&(o=settingsObject[t]),i){o!=i[0]&&(o!=i[i.length-1]?r.classList.add("switchHalf"):r.classList.add("switchOn")),r.setAttribute("value",o);let e=0;for(let n=0;n<i.length;n++)i[n]==o&&(e=n);r.setAttribute("index",e),r.addEventListener("click",(function(e){e.stopPropagation();let t=r.getAttribute("index");t++,t>=i.length&&(t=0),0==t?r.classList.remove("switchOn"):t==i.length-1?(r.classList.remove("switchHalf"),r.classList.add("switchOn")):r.classList.add("switchHalf");let o=i[t];r.setAttribute("value",o),r.setAttribute("index",t),n(o)}))}else o&&r.classList.add("switchOn"),r.addEventListener("click",(function(e){e.stopPropagation(),r.classList.contains("switchOn")?(r.classList.remove("switchOn"),n(!1)):(r.classList.add("switchOn"),n(!0))}));a.appendChild(r);let l=document.createElement("span");l.innerHTML=e,a.appendChild(l),It.appendChild(a),n(o)}var Rt,Ft;Rt=document.querySelector("#main"),Ft={},function(e){var n;(n=document.createElement("style")).innerHTML='\n\t\t.uiSysTop{\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tposition: relative;\n\t\tmax-width: 600px;\n\t\theight: 64px;\n\t\tborder-radius: 32px;\n\t\ttransform: translate(-50%);\n\t\tbox-shadow: 3px 3px 3px #0005;\n\t\tleft: 50%;\n\t\tbackground: #E0F9D5;\n\t\tmargin: 12px;\n\t\tanimation: uiSysUnfold 1s;\n\t\toverflow: hidden;\n\t\tline-height: 16px;\n\t}\n\t.uiSysTop div{\n\n\t\tmargin: 16px;\n\t\tmargin-left: 0px;\n\t\tflex: 0 0 64px;\n\t}\n\t.uiSysTop span{\n\t\tmargin-right: 48px;\n\t\tmargin-top: 8px;\n\t\tline-height: normal;\n\t\tvertical-align: middle;\n\t\tflex: 1;\n\n\t}\n\t@keyframes uiSysUnfold{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t100%{\n\t\t\ttop: 0px;\n\t\t}\n\t}\n\t@keyframes uiSysFold{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t\ttop: -64px;\n\t\t\topacity: 0.2;\n\t\t\theight: 0;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t\ttop:0px;\n\t\t\topacity: 1;\n\t\t}\n\t\t0%{\n\t\t\ttop: 0px;\n\n\t\t}\n\t}\n\t@keyframes uiSysMini{\n\t\t100%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\n\t\t}\n\t\t0%{\n\t\t\t\n\t\t}\n\t}\n\t@keyframes uiSysMax{\n\t\t0%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t50%{\n\t\t\tmax-width: 64px;\n\t\t}\n\t\t100%{\n\t\t\tleft: 50%;\n\t\t}\n\t}\n\n\t.uiHolderSysTop{\n\t\twidth: 600px;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%);\n\t\t/*border: 3px #0999 dotted;*/\n\t\ttransition: height 1s;\n\t}\n\t.uiIcon{\n\t\tfloat: left;\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:32px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z"/></svg>\');\n\t}\n\t.uiIconWarning{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>\') !important;\n\t}\n\t.uiIconError{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>\') !important;\n\t}\n\t.uiIconNet{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"/></svg>\') !important;\n\t}\n\t.uiIconPerson{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>\') !important;\n\t\t\n\t}\n\t.uiIconTime{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/></svg>\') !important;\n\t}\n\n\t.uiIconSuccess{\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>\') !important;\n\t}\n\t\n\t.uiCloseButton{\n\t\tposition: absolute;\n\t\tright: 0;\n\t\twidth: 24px;\n\t\theight: 24px;\n\t\tbackground-repeat: no-repeat;\n\t    background-size:16px;\n\t    background-position: center center;\n\t\tbackground-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\');\n\t\t\n\t}\n\n\t.uiCursorMessage{\n\t\tmin-width: 64px;\n\t\theight: 64px;\n\t\tborder: 5px solid white;\n\t\tbackground-color: #FBAB7E;\n\t\tbackground-image: linear-gradient(270deg, #FBAB7E 0%, #F7CE68 100%);\n\n\t\tcolor: white;\n\t\tfont-size: 24px;\n\t\tfont-weight: bold;\n\t\tfont-stretch: ultra-condensed;\n\t\ttransform: translate(-50%,-50%);\n\t\tanimation: uiWobble 0.3s;\n\t\tborder-radius: 32px;\n\t\tbox-sizing: border-box;\n\t\tposition: absolute;\n\t\tline-height: 48px;\n\t\tpadding: 0 8px 0 8px;\n\t\tfont-family: sans-serif;\n\t}\n\n\t@keyframes uiWobble{\n\t\t0%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.6,0.4);\n\t\t}\n\t\t33%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.9,1.15);\n\t\t}\n\t\t66%{\n\t\t\ttransform: translate(-50%,-50%) scale(0.8,0.9);\n\t\t}\n\t\t100%{\n\n\t\t}\n\t}\n\n\t@keyframes uiFade{\n\t\t0%{\n\t\t\topacity: 1;\n\t\t\ttransform: translate(-50%,-50%);\n\t\t}\n\t\t100%{\n\t\t\topacity: 0;\n\t\t\ttransform: translate(-50%,0%)\n\t\t}\n\t}\n\n\t.confetti{\n\t\tpointer-events: none;\n\t\tleft:200px;\n\t\ttop:200px;\n\t\twidth:50px;\n\t\theight:50px;\n\t\tposition: absolute;\n\t\tstroke-width:40px;\n\t\t/*background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 100 100" style="fill:none;stroke:lightgray;stroke-linecap:round;"><path d="M45 65L75 75M45 50L75 50M45 35L75 25" /></svg>\');\n\t\tbackground-size: cover;\n\t\tbackground-position: center;\n\t  \tbackground-repeat: no-repeat;*/\n\t}\n\t.confetti svg{\n\t\tposition: relative;\n\t\tanimation: dooter 0.5s forwards;\n\t\ttransform: translate(-50%,-50%);\n\t\twidth: 50px;\n\t\theight: 50px;\n\t}\n\t@keyframes dooter{\n\t\tfrom{\n\t\t\ttransform: translate(0%,0%) scale(0.1,0.1);\n\t\t\tstroke-width:30;\n\t\t}\n\t\tto{\n\t\t\ttransform: translate(100%,0%) scale(3,3);\n\t\t\tstroke-width:0;\n\t\t\tfilter:hue-rotate(270deg);\n\t\t}\n\t}\n\n\t',document.body.appendChild(n),e?f=e:(f=document.querySelector("#main"),f||(f=document.body)),f?(h=document.createElement("div"),h.className="uiHolderSysTop",f.appendChild(h),g=document.createElement("input"),g.type="text",g.style.position="fixed",g.taxindex="-1",g.style.display="none",g.style.pointerEvents="none",f.appendChild(g)):console.error("UI.js:: uh oh! no system dom element found")}(Rt),window.onError=function(e,n,t,i,o){v(e,"error")},function(){qn=[],(Dn=new On.World).quatNormalizeSkip=0,Dn.quatNormalizeFast=!1,Dn.allowSleep=!0,Dn.gravity.set(0,0,-10),Dn.broadphase=new On.NaiveBroadphase;let e=new On.Box(new On.Vec3(1,1,2));for(let n=0;n<1;n++){let n=new On.Body({mass:4});n.addShape(e),n.position.set(0,0,60),Dn.addBody(n),Wn=n,window.playerBody=Wn}new On.Material({name:"gooProperty",friction:10,restitution:-1}).name="gooProperty",new On.Material({name:"wallProperty",friction:.1,restitution:1}).name="wallProperty",function(){let e=new On.Plane,n=new On.Body({mass:0});n.addShape(e),Dn.addBody(n)}()}(),xt(),_t("./assets/models/Hex.glb",(e=>{console.log("got children "+e.children.length);let n=new l.Wid({vertexColors:l.jSK,metalness:0,roughness:1});for(let t=0;t<e.children.length;t++){let i=e.children[t];i.position.set(0,0,60),i.scale.set(8,8,8),i.material=n,i.receiveShadow=!0,(i.name.startsWith("Mount")||i.name.startsWith("Tree")||i.name.startsWith("House"))&&(i.castShadow=!0),ae[i.name]=i;let o=[];if(i.geometry){let e=i.geometry.attributes.color.array.length/4;for(let n=0;n<e;n++){let e=4*n,t=d(i.geometry.attributes.color.array[0+e],i.geometry.attributes.color.array[1+e],i.geometry.attributes.color.array[2+e]);o[t]=t}}}function t(e,n){e.addEventListener("click",(e=>{console.log("clicking hex");let t=e.target;t.classList.contains("hex")||(t=t.parentElement),t.classList.remove("jelloAnim"),t.offsetWidth,t.classList.add("jelloAnim"),function(e){ue=e,console.log("set hex "+ue)}(n)}))}let i=document.querySelectorAll(".hex");i[0].appendChild(p(Le("Grass_O1"))),t(i[0],1),i[1].appendChild(p(Le("Tree_N"),75,-75)),t(i[1],4),i[2].appendChild(p(Le("Grass_P1"))),t(i[2],2),i[3].appendChild(p(Le("Mount_N"),90)),t(i[3],3),i[4].appendChild(p(Le("Water_N"))),t(i[4],0),i[5].appendChild(p(Le("House_N"))),t(i[5],5),function(){he();for(let e=0;e<32;e++){le[e]=[];for(let n=0;n<32;n++)le[e][n]=1}}(),me()})),function(){let e=new l.vBJ({color:4907322}),n=new l.ZAu,t=new l.BKK(.6,8),i=new l.Kj0(t,e);i.position.set(8,0,0),n.add(i);for(let e=0;e<6;e++){let t=i.clone();t.rotation.z=e*Math.PI/3,t.position.set(8*Math.cos(t.rotation.z),8*Math.sin(t.rotation.z),0),n.add(t)}n.position.z+=6,kt(n),(se=n).visible=!1}(),function(){let e=8*Math.sqrt(3)/2;var n=new l.ZXM;for(let t=0;t<32;t++)for(let i=0;i<32;i++)n.vertices.push(new l.Pa4(-48+e+t*e*2+i*e,8*i*1.5-4,.8)),n.vertices.push(new l.Pa4(-48+e+t*e*2+i*e,4+8*i*1.5,.8)),n.vertices.push(new l.Pa4(-48+e+t*e*2+i*e,4+8*i*1.5,.8)),n.vertices.push(new l.Pa4(t*e*2-48+i*e,8+8*i*1.5,.8)),n.vertices.push(new l.Pa4(t*e*2-48+i*e,8+8*i*1.5,.8)),n.vertices.push(new l.Pa4(-48-e+t*e*2+i*e,4+8*i*1.5,.8));var t=new l.nls({color:16777215});de=new l.ejS(n,t)}(),function(){a=new l.xsS,(r=new l.cPb(45,1,1,1e3)).position.z=200,r.position.y=-200,r.up=new l.Pa4(0,0,1),r.lookAt(new l.Pa4(0,0,0));var e=new l.Mig(9408399);a.add(e)}(),function(e){(C=document.querySelector("#closeCard")).addEventListener("click",(e=>{B()}));let n=document.querySelectorAll(".card");_=[],n.forEach((e=>{_.push(e)})),_.forEach(((e,n)=>{e.style.top=Math.random()*window.innerWidth+"px",e.style.left=Math.random()*window.innerHeight+"px",e.offset={x:0,y:0},e.appId=n,e.addEventListener("pointerdown",(n=>{!function(e,n){e.focused||(H=e,e.pos={x:parseInt(e.style.left),y:parseInt(e.style.top)},R={x:e.pos.x,y:e.pos.y},e.offset={x:e.pos.x-n.clientX,y:e.pos.y-n.clientY},e.classList.add("cardMove"),e.moving=void 0)}(e,n)})),e.addEventListener("dragstart",(e=>{e.preventDefault()}))})),window.addEventListener("pointerup",Y),window.addEventListener("resize",q),window.addEventListener("pointermove",j),function(){b=document.querySelector("#bar");let e=document.querySelector("#barHandle");e.addEventListener("pointerdown",(e=>{A=!0})),e.addEventListener("dragstart",(e=>{e.preventDefault()})),z=[],e.style.transform="translate(-50%,-200%)",b.style.left="50%",b.style.top=window.innerHeight-64+"px",D(!0)}(),q(),W()}(),function(){var e;(e=document.createElement("style")).innerHTML="\n        .list-item{\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            max-width: calc(100% - 128px);\n            transform: translate(-50%,0);// rotate3d(1,0,0,0deg);\n            margin: 32px 0 16px 0;\n            position: relative;\n            padding: 16px;\n            left: 50%;\n            font-weight: bold;\n            font-size: 2em;\n            text-shadow: 1px 1px 2px black;\n            text-align: center;\n            font-family: 'openBold', serif;\n            transition: 0.2s transform;\n\n        }\n        .list-item span{\n            margin: 32px 0 32px 0;\n        }\n        .list-item:hover{\n            transform: translate(-50%,0) scale(1.05,1.05);// rotate3d(1,0,0,0deg);\n        }\n        .list{\n            width: 100%;\n            height: 100%;\n            position: absolute;\n            overflow-y: scroll;\n        }\n        .list *{\n            user-select: none;\n        }\n        .list-portrait{\n            left: 8px;\n            top: 8px;\n            position: absolute;\n            display: inline-block;\n            width: 64px;\n            height: 64px;\n            border-radius: 32px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n            overflow: hidden;\n            box-sizing: border-box;\n            border: white solid 6px;\n            transform: translate(-50%,-50%);\n            transition: left 0.4s;\n        }\n        .bigger-item .list-portrait{\n            left: 50% !important;\n            top: 0px !important;\n        }\n        .login-popin{\n            position: fixed;\n            border-radius: 16px;\n            background-color: white;\n            box-shadow: 6px 16px 1px #0005;\n        }\n        #login-junk{\n            max-width: 500px;\n            height: 300px;\n            transform: translate(-50%,0);\n            position: relative;\n            left: 50%;\n        }\n        .num{\n            margin-left: 0 !important;\n            border-radius: 28px;\n            font-size: 36px;\n            background-color: #0005;\n            width: 56px;\n            height: 56px;\n            display: inline-block;\n            overflow: hidden;\n            cursor: pointer;\n        }\n        .num-row{\n            width: 168px;\n            height: 168px;\n            position: absolute;\n            left: 50%;\n            transform: translate(-50%,0);\n        }\n        input{\n            text-align: center;\n            font-size: 16px;\n            outline: none;\n            border: none;\n            border-bottom: black 6px solid;\n            margin: 16px;\n            background-color: transparent;\n            color: inherit;\n        }\n        ",document.body.appendChild(e);let n=document.querySelector("#login-junk");n.style.display="none";let t=document.createElement("div");t.className="list",w=n.querySelector("input"),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&w.setAttribute("readonly","readonly"),function(e){let n=document.createElement("div");n.className="num-row";for(let e=1;e<=10;e++){let t=document.createElement("div");t.innerText=10==e?0:e,t.className="num",n.appendChild(t),t.addEventListener("click",(e=>{e.stopPropagation(),w.value.length<4&&(w.value+=e.target.innerText)}))}let t=document.createElement("div");t.className="num",t.innerText="C",t.addEventListener("click",(e=>{e.stopPropagation(),w.value=""})),n.appendChild(t);let i=document.createElement("div");i.className="num",i.innerText="Go",i.style.backgroundColor="#fff5",i.addEventListener("click",(e=>{e.stopPropagation();let n=e.target.parentElement.parentElement.parentElement.querySelector("span");var t,i;n&&(console.log("login with ",n.innerText,":",w.value),t=n.innerText,i=w.value,fetch("/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:i})}).then((function(e){return e.ok?e.json():void v(e.status+":"+e.statusText,"warn")})).then((function(e){e&&(v(e.message,"success"),function(e){if(!(x=y[e]))throw new Error("player doesn't exist")}(e.id),window.m=ie,console.log("trying auth..."),ee=v("attempting communications...","net",!0),(U=m("/dand-dev")).on("connect",(function(){document.querySelector("#login-menu").style.display="none",console.log("connected"),U.emit("physInit"),ee.remove(),ee=void 0})),U.on("event",(function(e){})),U.on("disconnect",(function(e){console.log("disconnected ",e),e.includes("disconnect")?document.querySelector("#login-menu").style.display="block":ee=v("lost connection, attempting reconnection...","net",!0)})),U.on("message",(function(e,n){K(e,n)})),U.on("join",(function(e){Q(e+" has joined!")})),U.on("terrain",(function(e,n,t){Ce(0,t)})),U.on("sendPhys",(function(e,n){!function(e,n){let t=Yn[e.id];t&&(t.position.copy(e.position),t.quaternion.copy(e.quaternion),n?t.sleep():(t.velocity.copy(e.velocity),t.angularVelocity.copy(e.angularVelocity),t.wakeUp()))}(e,n)})),U.on("physUpdate",(function(e){ne?(Jn(e),console.log("phys synced")):console.log("!!!phys IGNORED")})),U.on("physInit",(function(e,n){Un.forEach((e=>{Lt(e)})),Un=[],qn.forEach((e=>{Dn.remove(e)})),qn=[],Vn=[],Yn=[],e.forEach(((e,n)=>{Gn(e[0],e[1],e[2],{x:0,y:0,z:0},{x:0,y:0,z:0,w:0},e[3],e[4],e[5])})),Jn(n),ne=!0})),U.on("physMake",(function(e,n,t,i,o,a,r,l){Gn(e,n,t,i,o,a,r,l),console.log("made")})),fetch("/lastChats",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&(e.array.forEach((e=>{K(e[0],e[1])})),Q("Last 10 messages"))})).catch((e=>{v(e,"error"),console.error("ERROR ",e)})),fetch("/grid",{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():void 0})).then((function(e){e&&e.grid.length>0&&Ce(0,e.grid)})).catch((e=>{v(e,"error"),console.error("ERROR ",e)})),sn())})).catch((e=>{v(e,"error"),console.error("ERROR ",e)})))})),n.appendChild(i),e.appendChild(n)}(n);let i=document.querySelector("#login-menu");i.appendChild(t),i.appendChild(n),fetch("/getUsers",{method:"post"}).then((function(e){return e.json()})).then((function(e){e&&(function(e){y=[],e.forEach((e=>{y[e.id]=e}))}(e.users),e.users.forEach((e=>{let n=document.createElement("div");n.className="list-item";let i=e.color;n.style.backgroundColor=i;let o=u(s(i));n.style.color=o?"#000000":"#FFFFFF",n.style.textShadow="1px 1px 2px "+(o?"#FFFFFF":"#000000"),n.addEventListener("click",(e=>{let t=document.querySelector("#login-junk");t.style.display="",t.parentElement.classList.remove("bigger-item"),n.appendChild(t),n.classList.add("bigger-item"),e.stopPropagation(),w.focus()}));let a=document.createElement("div");a.className="list-portrait",n.appendChild(a);let r=document.createElement("span");r.innerText=e.username,n.appendChild(r),t.appendChild(n)})))})).catch((e=>{console.error("ERROR"+e)}))}(),function(){let e=document.querySelector("#chatCard");(T=document.createElement("div")).classList.add("chat-pane"),e.appendChild(T);let n=document.createElement("div");n.classList.add("chat-bottom"),M=document.createElement("input");let t="0xffff55";t="#"+t.substring(2,t.length),M.style.border=t+" 6px solid",n.appendChild(M),e.appendChild(n),M.addEventListener("keyup",(function(e){var n;13==e.which?M.value.length>0?(n=M.value,U.emit("message",n),M.value=""):setTimeout(Z,20):27==e.which&&Z()})),document.createElement("div").classList.add("letterPane")}(),It=document.querySelector(".settingsPane"),Ht("Toggle Hex Grid Lines",(function(e){e?kt(de):Lt(de)})),Ht("Toggle Light Helper",Ie),Ht("Toggle Physics Mesh Helper",wt),Fe=document.querySelector("#makerBar"),Ye.forEach((e=>{!function(e){let n=function(e){let n=document.createElement("div");return n.className="makerIcon",n}();n.setAttribute("data",e),n.addEventListener("click",(e=>{Be=e.target.getAttribute("data")})),n.innerText=e,Fe.appendChild(n)}(e)})),je("pot"),je("rock"),Oe("assets/models/man.gltf",((e,n)=>{var t;e=e.children[0],(He=e).castShadow=!0,He.receiveShadow=!0,e.scale.set(2,2,2),n&&n.forEach((e=>{e.name&&(De[e.name]=e)})),function(e,n,t){if(e.geometry)Ve(e,e.geometry,n,t);else if(e.children&&e.children.length>0)for(let i=0;i<e.children.length;i++)e.children[i].geometry&&Ve(e,e.children[i].geometry,n,t)}(e,[1,.2541521191596985,.022173885256052017],[0,0,1]),new l.Pa4(0,0,1),(t=l.rDY.merge([l.Vj0.phong.uniforms,{shirt:{value:new l.Pa4(0,1,0)},wind:{value:new l.Pa4(0,0,0)}}])).ambientLightColor.value=null,(Re=new l.jyz({uniforms:t,derivatives:!1,lights:!0,vertexColors:!0,vertexShader:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform vec3 shirt;\nuniform vec3 wind;\n\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #ifdef USE_COLOR\n        if(color==vec3(0,0,1))\n            vColor.xyz = shirt;\n        else\n            vColor.xyz = color.xyz;\n        \n    #endif\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n    #ifdef USE_TANGENT\n        vTangent = normalize( transformedTangent );\n        vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n    #endif\n#endif\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    \n        if(color==vec3(1,0,0)){\n            float val=max(0.0, 1.0976 - transformed.z);\n            transformed.xyz+=val*wind;\n            transformed.y*=1.0+sin((wind.z+transformed.z)*4.0)/2.0;\n\n        }\n    \n\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <shadowmap_vertex>\n    #include <fog_vertex>\n}",fragmentShader:"\n    #define STANDARD\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n    varying vec3 vNormal;\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <roughnessmap_fragment>\n    #include <metalnessmap_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n    #include <lights_physical_fragment>\n    #include <lights_fragment_begin>\n    #include <lights_fragment_maps>\n    #include <lights_fragment_end>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n    #include <dithering_fragment>\n}"})).needsUpdate=!0,Re.skinning=!0,We.man=He,Re.onBeforeCompile=e=>{e.uniforms.shirt=man.children[1].material.uniforms.shirt,e.vertexShader="uniform vec3 shirt;\n"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <color_vertex>","\n                #ifdef USE_COLOR\n                    if(color.xyz == vec3(0,0,1)){\n                        vColor.xyz = vec3(1,1,0);\n                    }else{\n                        vColor.xyz = color.xyz;\n                    }\n                #endif")}}))}},0,[[5,666,977]]]);